{
  "name": "DigitalOceanFirewall",
  "kind": "DigitalOceanFirewall",
  "cloudProvider": "digitalocean",
  "apiVersion": "digital-ocean.openmcf.org/v1",
  "description": "digital-ocean-firewall",
  "protoPackage": "org.openmcf.provider.digitalocean.digitaloceanfirewall.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/digitalocean/digitaloceanfirewall/v1/api.proto",
    "spec": "org/openmcf/provider/digitalocean/digitaloceanfirewall/v1/spec.proto"
  },
  "spec": {
    "name": "DigitalOceanFirewallSpec",
    "fields": [
      {
        "name": "Name",
        "jsonName": "name",
        "protoField": "name",
        "type": {
          "kind": "string"
        },
        "description": "Name of the firewall for identification (must be unique per account/project).",
        "required": false,
        "validation": {
          "minLength": 1,
          "maxLength": 255
        }
      },
      {
        "name": "InboundRules",
        "jsonName": "inboundRules",
        "protoField": "inbound_rules",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "DigitalOceanFirewallInboundRule"
          }
        },
        "description": "Inbound rules: traffic allowed *to* Droplets on specific ports from specified sources.",
        "required": false
      },
      {
        "name": "OutboundRules",
        "jsonName": "outboundRules",
        "protoField": "outbound_rules",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "DigitalOceanFirewallOutboundRule"
          }
        },
        "description": "Outbound rules: traffic allowed *from* Droplets on specific ports to specified destinations.",
        "required": false
      },
      {
        "name": "DropletIds",
        "jsonName": "dropletIds",
        "protoField": "droplet_ids",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "int64"
          }
        },
        "description": "The Droplet IDs to which this firewall is applied (max 10).\n These Droplets will have the firewall's rules enforced.",
        "required": false
      },
      {
        "name": "Tags",
        "jsonName": "tags",
        "protoField": "tags",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "The names of Droplet tags to which this firewall is applied (max 5).\n Any Droplet with these tags will be protected by this firewall.",
        "required": false
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "DigitalOceanFirewallInboundRule",
      "description": "Definition of an inbound (ingress) firewall rule.",
      "protoType": "org.openmcf.provider.digitalocean.digitaloceanfirewall.v1.DigitalOceanFirewallInboundRule",
      "fields": [
        {
          "name": "Protocol",
          "jsonName": "protocol",
          "protoField": "protocol",
          "type": {
            "kind": "string"
          },
          "description": "\"tcp\", \"udp\", or \"icmp\". Required.",
          "required": false,
          "validation": {
            "minLength": 1
          }
        },
        {
          "name": "PortRange",
          "jsonName": "portRange",
          "protoField": "port_range",
          "type": {
            "kind": "string"
          },
          "description": "Ports to allow (e.g., \"80\", \"8000-9000\", or \"1-65535\"; empty or \"1-65535\" means all ports for tcp/udp).",
          "required": false
        },
        {
          "name": "SourceAddresses",
          "jsonName": "sourceAddresses",
          "protoField": "source_addresses",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "IPv4 or IPv6 addresses or CIDR ranges (e.g., \"192.0.2.0/24\", \"0.0.0.0/0\").",
          "required": false
        },
        {
          "name": "SourceDropletIds",
          "jsonName": "sourceDropletIds",
          "protoField": "source_droplet_ids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "int64"
            }
          },
          "description": "IDs of Droplets from which traffic is allowed.",
          "required": false
        },
        {
          "name": "SourceTags",
          "jsonName": "sourceTags",
          "protoField": "source_tags",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "Names of Droplet tags; any Droplet with these tags is allowed.",
          "required": false
        },
        {
          "name": "SourceKubernetesIds",
          "jsonName": "sourceKubernetesIds",
          "protoField": "source_kubernetes_ids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "IDs of Kubernetes clusters from which traffic is allowed.",
          "required": false
        },
        {
          "name": "SourceLoadBalancerUids",
          "jsonName": "sourceLoadBalancerUids",
          "protoField": "source_load_balancer_uids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "IDs of Load Balancers from which traffic is allowed.",
          "required": false
        }
      ]
    },
    {
      "name": "DigitalOceanFirewallOutboundRule",
      "description": "Definition of an outbound (egress) firewall rule.",
      "protoType": "org.openmcf.provider.digitalocean.digitaloceanfirewall.v1.DigitalOceanFirewallOutboundRule",
      "fields": [
        {
          "name": "Protocol",
          "jsonName": "protocol",
          "protoField": "protocol",
          "type": {
            "kind": "string"
          },
          "description": "\"tcp\", \"udp\", or \"icmp\". Required.",
          "required": false,
          "validation": {
            "minLength": 1
          }
        },
        {
          "name": "PortRange",
          "jsonName": "portRange",
          "protoField": "port_range",
          "type": {
            "kind": "string"
          },
          "description": "Ports to allow (format as in inbound rules; required for tcp/udp).",
          "required": false
        },
        {
          "name": "DestinationAddresses",
          "jsonName": "destinationAddresses",
          "protoField": "destination_addresses",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "IPv4/IPv6 addresses or CIDRs to which traffic is allowed.",
          "required": false
        },
        {
          "name": "DestinationDropletIds",
          "jsonName": "destinationDropletIds",
          "protoField": "destination_droplet_ids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "int64"
            }
          },
          "description": "IDs of Droplets to which traffic is allowed.",
          "required": false
        },
        {
          "name": "DestinationTags",
          "jsonName": "destinationTags",
          "protoField": "destination_tags",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "Names of Droplet tags whose members are allowed destinations.",
          "required": false
        },
        {
          "name": "DestinationKubernetesIds",
          "jsonName": "destinationKubernetesIds",
          "protoField": "destination_kubernetes_ids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "IDs of Kubernetes clusters to which traffic is allowed.",
          "required": false
        },
        {
          "name": "DestinationLoadBalancerUids",
          "jsonName": "destinationLoadBalancerUids",
          "protoField": "destination_load_balancer_uids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "IDs of Load Balancers which are allowed as destinations.",
          "required": false
        }
      ]
    }
  ]
}
