{
  "name": "OciContainerEngineCluster",
  "kind": "OciContainerEngineCluster",
  "cloudProvider": "oci",
  "apiVersion": "oci.openmcf.org/v1",
  "description": "OciContainerEngineCluster is the top-level resource representing an Oracle\n Cloud Infrastructure Container Engine for Kubernetes (OKE) cluster.",
  "protoPackage": "org.openmcf.provider.oci.ocicontainerenginecluster.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/oci/ocicontainerenginecluster/v1/api.proto",
    "spec": "org/openmcf/provider/oci/ocicontainerenginecluster/v1/spec.proto"
  },
  "spec": {
    "name": "OciContainerEngineClusterSpec",
    "fields": [
      {
        "name": "CompartmentId",
        "jsonName": "compartmentId",
        "protoField": "compartment_id",
        "type": {
          "kind": "string"
        },
        "description": "OCID of the compartment where the cluster will be created.\n Changing this after creation forces cluster recreation.",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "OciCompartment",
        "referenceFieldPath": "status.outputs.compartmentId"
      },
      {
        "name": "VcnId",
        "jsonName": "vcnId",
        "protoField": "vcn_id",
        "type": {
          "kind": "string"
        },
        "description": "OCID of the VCN where the cluster will be deployed.\n Changing this after creation forces cluster recreation.",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "OciVcn",
        "referenceFieldPath": "status.outputs.vcnId"
      },
      {
        "name": "Name",
        "jsonName": "name",
        "protoField": "name",
        "type": {
          "kind": "string"
        },
        "description": "Human-readable name for the cluster shown in the OCI Console.\n Falls back to metadata.name if not provided.",
        "required": false
      },
      {
        "name": "KubernetesVersion",
        "jsonName": "kubernetesVersion",
        "protoField": "kubernetes_version",
        "type": {
          "kind": "string"
        },
        "description": "Kubernetes version to install on the cluster control plane.\n Example: \"v1.28.2\". Use `oci ce cluster-options list` to see available versions.",
        "required": false,
        "validation": {
          "minLength": 1
        }
      },
      {
        "name": "Type",
        "jsonName": "type",
        "protoField": "type",
        "type": {
          "kind": "enum",
          "enumType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.ClusterType",
          "enumValues": [
            "basic_cluster",
            "enhanced_cluster"
          ]
        },
        "description": "Cluster type. Enhanced clusters provide virtual node pools, workload\n identity, and cluster add-on lifecycle management.",
        "required": false
      },
      {
        "name": "CniType",
        "jsonName": "cniType",
        "protoField": "cni_type",
        "type": {
          "kind": "enum",
          "enumType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.CniType",
          "enumValues": [
            "flannel_overlay",
            "oci_vcn_ip_native"
          ]
        },
        "description": "Container Network Interface (CNI) plugin for pod networking.\n oci_vcn_ip_native assigns VCN IP addresses directly to pods (recommended\n for production; enables network policies and security groups on pods).\n flannel_overlay uses an overlay network (simpler, legacy).\n Changing this after creation forces cluster recreation.",
        "required": false
      },
      {
        "name": "EndpointConfig",
        "jsonName": "endpointConfig",
        "protoField": "endpoint_config",
        "type": {
          "kind": "message",
          "messageType": "EndpointConfig"
        },
        "description": "Network configuration for the Kubernetes API server endpoint.\n Controls whether the API server is reachable via a public or private IP,\n which subnet hosts the endpoint, and which NSGs protect it.",
        "required": false
      },
      {
        "name": "Options",
        "jsonName": "options",
        "protoField": "options",
        "type": {
          "kind": "message",
          "messageType": "ClusterOptions"
        },
        "description": "Optional cluster configuration for networking, service load balancers,\n persistent volumes, and OIDC authentication.",
        "required": false
      },
      {
        "name": "KmsKeyId",
        "jsonName": "kmsKeyId",
        "protoField": "kms_key_id",
        "type": {
          "kind": "string"
        },
        "description": "OCID of the KMS key to encrypt Kubernetes secrets at rest.\n Requires kubernetes_version \u003e= v1.13.0.\n Changing this after creation forces cluster recreation.\n default_kind will be updated when OciKmsKey (R25) is implemented.",
        "required": false
      },
      {
        "name": "ImagePolicyConfig",
        "jsonName": "imagePolicyConfig",
        "protoField": "image_policy_config",
        "type": {
          "kind": "message",
          "messageType": "ImagePolicyConfig"
        },
        "description": "Image verification policy for the cluster. When enabled, all container\n images deployed to the cluster must be signed with one of the specified\n KMS keys.",
        "required": false
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "ClusterOptions",
      "description": "ClusterOptions groups optional networking, OIDC, and resource tagging\n configuration. All fields have sane defaults when omitted.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.ClusterOptions",
      "fields": [
        {
          "name": "KubernetesNetworkConfig",
          "jsonName": "kubernetesNetworkConfig",
          "protoField": "kubernetes_network_config",
          "type": {
            "kind": "message",
            "messageType": "KubernetesNetworkConfig"
          },
          "description": "Kubernetes pod and service CIDR configuration.\n Changing this after creation forces cluster recreation.",
          "required": false
        },
        {
          "name": "ServiceLbSubnetIds",
          "jsonName": "serviceLbSubnetIds",
          "protoField": "service_lb_subnet_ids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "OCIDs of subnets where Kubernetes Service load balancers will be placed.\n Typically one or two public subnets in different availability domains.\n Changing this after creation forces cluster recreation.",
          "required": false,
          "referenceKind": "OciSubnet",
          "referenceFieldPath": "status.outputs.subnetId"
        },
        {
          "name": "IpFamilies",
          "jsonName": "ipFamilies",
          "protoField": "ip_families",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "enum",
              "enumType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.IpFamily",
              "enumValues": [
                "ipv4",
                "ipv6"
              ]
            }
          },
          "description": "IP address family for the cluster. Use [ipv4] for IPv4-only (default)\n or [ipv4, ipv6] for dual-stack.\n Changing this after creation forces cluster recreation.",
          "required": false
        },
        {
          "name": "ServiceLbConfig",
          "jsonName": "serviceLbConfig",
          "protoField": "service_lb_config",
          "type": {
            "kind": "message",
            "messageType": "ServiceLbConfig"
          },
          "description": "Default configuration applied to load balancers created by Kubernetes\n Service resources of type LoadBalancer.",
          "required": false
        },
        {
          "name": "PersistentVolumeConfig",
          "jsonName": "persistentVolumeConfig",
          "protoField": "persistent_volume_config",
          "type": {
            "kind": "message",
            "messageType": "PersistentVolumeConfig"
          },
          "description": "Default configuration applied to block volumes created by Kubernetes\n PersistentVolumeClaim resources.",
          "required": false
        },
        {
          "name": "OpenIdConnectTokenAuthenticationConfig",
          "jsonName": "openIdConnectTokenAuthenticationConfig",
          "protoField": "open_id_connect_token_authentication_config",
          "type": {
            "kind": "message",
            "messageType": "OpenIdConnectTokenAuthenticationConfig"
          },
          "description": "OpenID Connect token authentication for the Kubernetes API server.\n Enables external identity provider integration for kubectl and API access.",
          "required": false
        },
        {
          "name": "IsOpenIdConnectDiscoveryEnabled",
          "jsonName": "isOpenIdConnectDiscoveryEnabled",
          "protoField": "is_open_id_connect_discovery_enabled",
          "type": {
            "kind": "bool"
          },
          "description": "When true, enables the cluster-specific OIDC Discovery endpoint,\n allowing external systems to discover the cluster's public signing keys.",
          "required": false
        }
      ]
    },
    {
      "name": "EndpointConfig",
      "description": "EndpointConfig controls network access to the Kubernetes API server.\n For production clusters, use a private endpoint (is_public_ip_enabled=false)\n in a dedicated subnet with restrictive NSGs.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.EndpointConfig",
      "fields": [
        {
          "name": "SubnetId",
          "jsonName": "subnetId",
          "protoField": "subnet_id",
          "type": {
            "kind": "string"
          },
          "description": "OCID of the regional subnet hosting the cluster API server endpoint.\n Changing this after creation forces cluster recreation.",
          "required": true,
          "validation": {
            "required": true
          },
          "referenceKind": "OciSubnet",
          "referenceFieldPath": "status.outputs.subnetId"
        },
        {
          "name": "IsPublicIpEnabled",
          "jsonName": "isPublicIpEnabled",
          "protoField": "is_public_ip_enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether to assign a public IP to the API server endpoint.\n Set to false for private clusters. Must be false when the subnet is\n private (no public IP assignment possible).",
          "required": false,
          "oneofGroup": "_is_public_ip_enabled"
        },
        {
          "name": "NsgIds",
          "jsonName": "nsgIds",
          "protoField": "nsg_ids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "OCIDs of network security groups applied to the API server endpoint.",
          "required": false,
          "referenceKind": "OciSecurityGroup",
          "referenceFieldPath": "status.outputs.networkSecurityGroupId"
        }
      ]
    },
    {
      "name": "ImagePolicyConfig",
      "description": "ImagePolicyConfig enables container image signature verification.\n When enabled with KMS keys, all images deployed to the cluster must\n be signed with at least one of the specified keys.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.ImagePolicyConfig",
      "fields": [
        {
          "name": "IsPolicyEnabled",
          "jsonName": "isPolicyEnabled",
          "protoField": "is_policy_enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether the image verification policy is enabled.",
          "required": false
        },
        {
          "name": "KeyDetails",
          "jsonName": "keyDetails",
          "protoField": "key_details",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "message",
              "messageType": "ImagePolicyKeyDetail"
            }
          },
          "description": "KMS keys used for image signature verification.",
          "required": false
        }
      ]
    },
    {
      "name": "ImagePolicyKeyDetail",
      "description": "ImagePolicyKeyDetail identifies a KMS key for image signature verification.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.ImagePolicyKeyDetail",
      "fields": [
        {
          "name": "KmsKeyId",
          "jsonName": "kmsKeyId",
          "protoField": "kms_key_id",
          "type": {
            "kind": "string"
          },
          "description": "OCID of the KMS key used to verify image signatures.\n default_kind will be updated when OciKmsKey (R25) is implemented.",
          "required": false
        }
      ]
    },
    {
      "name": "KubernetesNetworkConfig",
      "description": "KubernetesNetworkConfig defines the CIDR ranges for Kubernetes pods and\n services. These must not overlap with the VCN CIDR or each other.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.KubernetesNetworkConfig",
      "fields": [
        {
          "name": "PodsCidr",
          "jsonName": "podsCidr",
          "protoField": "pods_cidr",
          "type": {
            "kind": "string"
          },
          "description": "CIDR block for Kubernetes pods.\n Default when omitted: 10.244.0.0/16 (IPv4), fd00:eeee:eeee:0000::/96 (IPv6).",
          "required": false
        },
        {
          "name": "ServicesCidr",
          "jsonName": "servicesCidr",
          "protoField": "services_cidr",
          "type": {
            "kind": "string"
          },
          "description": "CIDR block for Kubernetes services (ClusterIP range).\n Default when omitted: 10.96.0.0/16 (IPv4), fd00:eeee:eeee:0001::/108 (IPv6).",
          "required": false
        }
      ]
    },
    {
      "name": "OpenIdConnectTokenAuthenticationConfig",
      "description": "OpenIdConnectTokenAuthenticationConfig configures OIDC token authentication\n for the Kubernetes API server. This allows users to authenticate using tokens\n from an external OIDC-compliant identity provider.\n\n Two configuration modes are supported:\n   1. Inline: set individual fields (issuer_url, client_id, etc.)\n   2. Configuration file: set configuration_file with a base64-encoded\n      Kubernetes OIDC Auth Config file\n These modes are mutually exclusive. When configuration_file is set,\n the inline fields (issuer_url through username_prefix) must not be set.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.OpenIdConnectTokenAuthenticationConfig",
      "fields": [
        {
          "name": "IsOpenIdConnectAuthEnabled",
          "jsonName": "isOpenIdConnectAuthEnabled",
          "protoField": "is_open_id_connect_auth_enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether OIDC token authentication is enabled.",
          "required": false
        },
        {
          "name": "ConfigurationFile",
          "jsonName": "configurationFile",
          "protoField": "configuration_file",
          "type": {
            "kind": "string"
          },
          "description": "Base64-encoded Kubernetes OIDC Auth Config file.\n Mutually exclusive with the inline fields below.",
          "required": false
        },
        {
          "name": "IssuerUrl",
          "jsonName": "issuerUrl",
          "protoField": "issuer_url",
          "type": {
            "kind": "string"
          },
          "description": "URL of the OIDC identity provider. Must use https://.\n The API server uses this to discover signing keys.",
          "required": false
        },
        {
          "name": "ClientId",
          "jsonName": "clientId",
          "protoField": "client_id",
          "type": {
            "kind": "string"
          },
          "description": "Client ID that all tokens must be issued for.",
          "required": false
        },
        {
          "name": "CaCertificate",
          "jsonName": "caCertificate",
          "protoField": "ca_certificate",
          "type": {
            "kind": "string"
          },
          "description": "Base64-encoded public RSA or ECDSA certificate of the identity provider.",
          "required": false
        },
        {
          "name": "UsernameClaim",
          "jsonName": "usernameClaim",
          "protoField": "username_claim",
          "type": {
            "kind": "string"
          },
          "description": "JWT claim to use as the Kubernetes username. Default: \"sub\".",
          "required": false
        },
        {
          "name": "UsernamePrefix",
          "jsonName": "usernamePrefix",
          "protoField": "username_prefix",
          "type": {
            "kind": "string"
          },
          "description": "Prefix prepended to username claims to prevent collisions with\n existing names (e.g. \"oidc:\").",
          "required": false
        },
        {
          "name": "GroupsClaim",
          "jsonName": "groupsClaim",
          "protoField": "groups_claim",
          "type": {
            "kind": "string"
          },
          "description": "JWT claim to use as the user's group. Must be an array of strings\n in the token.",
          "required": false
        },
        {
          "name": "GroupsPrefix",
          "jsonName": "groupsPrefix",
          "protoField": "groups_prefix",
          "type": {
            "kind": "string"
          },
          "description": "Prefix prepended to group claims.",
          "required": false
        },
        {
          "name": "SigningAlgorithms",
          "jsonName": "signingAlgorithms",
          "protoField": "signing_algorithms",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "Accepted signing algorithms for tokens. Default: [\"RS256\"].",
          "required": false
        },
        {
          "name": "RequiredClaims",
          "jsonName": "requiredClaims",
          "protoField": "required_claims",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "message",
              "messageType": "RequiredClaim"
            }
          },
          "description": "Key-value pairs of required claims in the ID token. If any required\n claim is missing or has a different value, authentication is rejected.",
          "required": false
        }
      ]
    },
    {
      "name": "PersistentVolumeConfig",
      "description": "PersistentVolumeConfig applies default tags to block volumes created\n by Kubernetes PersistentVolumeClaim resources.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.PersistentVolumeConfig",
      "fields": [
        {
          "name": "FreeformTags",
          "jsonName": "freeformTags",
          "protoField": "freeform_tags",
          "type": {
            "kind": "map",
            "keyType": {
              "kind": "string"
            },
            "valueType": {
              "kind": "string"
            }
          },
          "description": "Freeform tags applied to persistent volumes.",
          "required": false
        },
        {
          "name": "DefinedTags",
          "jsonName": "definedTags",
          "protoField": "defined_tags",
          "type": {
            "kind": "map",
            "keyType": {
              "kind": "string"
            },
            "valueType": {
              "kind": "string"
            }
          },
          "description": "Defined tags applied to persistent volumes.\n Keys use the format \"namespace.key\" (e.g. \"Operations.CostCenter\").",
          "required": false
        }
      ]
    },
    {
      "name": "RequiredClaim",
      "description": "RequiredClaim is a key-value pair that must be present in the OIDC\n ID token for authentication to succeed.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.RequiredClaim",
      "fields": [
        {
          "name": "Key",
          "jsonName": "key",
          "protoField": "key",
          "type": {
            "kind": "string"
          },
          "required": false
        },
        {
          "name": "Value",
          "jsonName": "value",
          "protoField": "value",
          "type": {
            "kind": "string"
          },
          "required": false
        }
      ]
    },
    {
      "name": "ServiceLbConfig",
      "description": "ServiceLbConfig applies default tags and NSGs to load balancers\n created by Kubernetes Service resources.",
      "protoType": "org.openmcf.provider.oci.ocicontainerenginecluster.v1.OciContainerEngineClusterSpec.ServiceLbConfig",
      "fields": [
        {
          "name": "BackendNsgIds",
          "jsonName": "backendNsgIds",
          "protoField": "backend_nsg_ids",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "OCIDs of NSGs applied to load balancer backends.",
          "required": false,
          "referenceKind": "OciSecurityGroup",
          "referenceFieldPath": "status.outputs.networkSecurityGroupId"
        },
        {
          "name": "FreeformTags",
          "jsonName": "freeformTags",
          "protoField": "freeform_tags",
          "type": {
            "kind": "map",
            "keyType": {
              "kind": "string"
            },
            "valueType": {
              "kind": "string"
            }
          },
          "description": "Freeform tags applied to service load balancers.",
          "required": false
        },
        {
          "name": "DefinedTags",
          "jsonName": "definedTags",
          "protoField": "defined_tags",
          "type": {
            "kind": "map",
            "keyType": {
              "kind": "string"
            },
            "valueType": {
              "kind": "string"
            }
          },
          "description": "Defined tags applied to service load balancers.\n Keys use the format \"namespace.key\" (e.g. \"Operations.CostCenter\").",
          "required": false
        }
      ]
    }
  ]
}
