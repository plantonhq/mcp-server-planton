{
  "name": "AzurePostgresqlFlexibleServer",
  "kind": "AzurePostgresqlFlexibleServer",
  "cloudProvider": "azure",
  "apiVersion": "azure.openmcf.org/v1",
  "description": "AzurePostgresqlFlexibleServer is the top-level API resource for an Azure\n Database for PostgreSQL Flexible Server.\n Azure Database for PostgreSQL Flexible Server is a fully managed relational\n database service with granular control over compute, storage, high availability,\n and networking. Supports PostgreSQL 12 through 17.",
  "protoPackage": "org.openmcf.provider.azure.azurepostgresqlflexibleserver.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/azure/azurepostgresqlflexibleserver/v1/api.proto",
    "spec": "org/openmcf/provider/azure/azurepostgresqlflexibleserver/v1/spec.proto"
  },
  "spec": {
    "name": "AzurePostgresqlFlexibleServerSpec",
    "fields": [
      {
        "name": "Region",
        "jsonName": "region",
        "protoField": "region",
        "type": {
          "kind": "string"
        },
        "description": "The Azure region where the PostgreSQL Flexible Server will be created.\n Must match the region of the VNet/subnet if VNet integration is used.\n Examples: \"eastus\", \"westus2\", \"westeurope\", \"southeastasia\".",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1
        }
      },
      {
        "name": "ResourceGroup",
        "jsonName": "resourceGroup",
        "protoField": "resource_group",
        "type": {
          "kind": "string"
        },
        "description": "The Azure Resource Group where the PostgreSQL Flexible Server will be created.\n Can be a literal string or a reference to an AzureResourceGroup output.",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "AzureResourceGroup",
        "referenceFieldPath": "status.outputs.resource_group_name"
      },
      {
        "name": "Name",
        "jsonName": "name",
        "protoField": "name",
        "type": {
          "kind": "string"
        },
        "description": "The name of the PostgreSQL Flexible Server.\n Must be globally unique across Azure. Used as the server hostname:\n `{name}.postgres.database.azure.com`\n Allowed characters: lowercase letters, numbers, and hyphens.\n Must start with a letter. Length: 3 to 63 characters.\n\n **ForceNew**: Changing this destroys and recreates the server.",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 3,
          "maxLength": 63
        }
      },
      {
        "name": "AdministratorLogin",
        "jsonName": "administratorLogin",
        "protoField": "administrator_login",
        "type": {
          "kind": "string"
        },
        "description": "The administrator login name for the server.\n Cannot be \"azure_superuser\", \"admin\", \"administrator\", \"root\", \"guest\", or \"public\".\n Must start with a letter.\n\n **ForceNew**: Changing this destroys and recreates the server.",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1
        }
      },
      {
        "name": "AdministratorPassword",
        "jsonName": "administratorPassword",
        "protoField": "administrator_password",
        "type": {
          "kind": "string"
        },
        "description": "The administrator password for the server.\n Can be a literal value or a reference to another resource's output\n (e.g., a generated random password or a Key Vault secret value).\n\n Password requirements: 8-128 characters, must contain characters from\n at least three of: uppercase, lowercase, digits, special characters.\n\n This is a polymorphic StringValueOrRef with no default_kind because\n the password source varies (literal, chart variable, external secret).",
        "required": true,
        "validation": {
          "required": true
        }
      },
      {
        "name": "Version",
        "jsonName": "version",
        "protoField": "version",
        "type": {
          "kind": "string"
        },
        "description": "The PostgreSQL major version.\n Uses Azure's exact version strings for provider authenticity.\n\n Valid values: \"12\", \"13\", \"14\", \"15\", \"16\", \"17\"\n Default: \"16\" (current GA production standard)\n\n - \"12\": EOL Nov 2024, use only for legacy migration\n - \"13\": EOL Nov 2025, use only for existing workloads\n - \"14\": Active, approaching end of standard support\n - \"15\": Active, production ready\n - \"16\": Active, recommended for new deployments (default)\n - \"17\": Active, latest GA with new features (citus/cluster support)",
        "required": false,
        "default": "16",
        "oneofGroup": "_version"
      },
      {
        "name": "SkuName",
        "jsonName": "skuName",
        "protoField": "sku_name",
        "type": {
          "kind": "string"
        },
        "description": "The SKU name defining the compute tier and size.\n Format: {TIER}_Standard_{SIZE}\n\n Burstable (dev/test):\n   \"B_Standard_B1ms\" (1 vCPU, 2 GiB), \"B_Standard_B2s\" (2 vCPU, 4 GiB),\n   \"B_Standard_B4ms\" (4 vCPU, 8 GiB)\n\n General Purpose (production):\n   \"GP_Standard_D2s_v3\" (2 vCPU, 8 GiB), \"GP_Standard_D4s_v3\" (4 vCPU, 16 GiB),\n   \"GP_Standard_D8s_v3\" (8 vCPU, 32 GiB), \"GP_Standard_D16s_v3\" (16 vCPU, 64 GiB),\n   \"GP_Standard_D2ds_v4\" through \"GP_Standard_D64ds_v4\"\n\n Memory Optimized (analytics, caching):\n   \"MO_Standard_E2s_v3\" (2 vCPU, 16 GiB) through \"MO_Standard_E64s_v3\"",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1
        }
      },
      {
        "name": "StorageMb",
        "jsonName": "storageMb",
        "protoField": "storage_mb",
        "type": {
          "kind": "int32"
        },
        "description": "The storage size in megabytes.\n Must be one of the Azure-allowed values:\n   32768 (32 GB), 65536 (64 GB), 131072 (128 GB), 262144 (256 GB),\n   524288 (512 GB), 1048576 (1 TB), 2097152 (2 TB), 4194304 (4 TB),\n   8388608 (8 TB), 16777216 (16 TB), 33553408 (32 TB)\n\n **Cannot be downgraded** -- decreasing storage_mb forces server recreation.\n Azure validates exact values; the minimum is enforced here.",
        "required": true,
        "validation": {
          "required": true,
          "min": 32768
        }
      },
      {
        "name": "AutoGrowEnabled",
        "jsonName": "autoGrowEnabled",
        "protoField": "auto_grow_enabled",
        "type": {
          "kind": "bool"
        },
        "description": "Enable storage auto-grow.\n When enabled, Azure automatically increases storage when free storage\n falls below a threshold. Prevents out-of-storage failures for databases\n that grow unpredictably.\n\n Default: false (storage stays at the provisioned size)",
        "required": false,
        "default": "false",
        "oneofGroup": "_auto_grow_enabled"
      },
      {
        "name": "DelegatedSubnetId",
        "jsonName": "delegatedSubnetId",
        "protoField": "delegated_subnet_id",
        "type": {
          "kind": "string"
        },
        "description": "The ID of a subnet delegated to Microsoft.DBforPostgreSQL/flexibleServers.\n When set, the server is deployed with **private VNet access** and\n public network access is automatically disabled.\n\n The subnet must have the delegation `Microsoft.DBforPostgreSQL/flexibleServers`.\n Use the AzureSubnet component with a delegation block to create a properly\n configured subnet.\n\n **ForceNew**: Changing this destroys and recreates the server.",
        "required": false,
        "referenceKind": "AzureSubnet",
        "referenceFieldPath": "status.outputs.subnet_id"
      },
      {
        "name": "PrivateDnsZoneId",
        "jsonName": "privateDnsZoneId",
        "protoField": "private_dns_zone_id",
        "type": {
          "kind": "string"
        },
        "description": "The ID of a private DNS zone for server name resolution within the VNet.\n Typically \"privatelink.postgres.database.azure.com\" for private access.\n\n When `delegated_subnet_id` is set, providing a private DNS zone enables\n VNet-connected clients to resolve the server's FQDN to its private IP.",
        "required": false,
        "referenceKind": "AzurePrivateDnsZone",
        "referenceFieldPath": "status.outputs.zone_id"
      },
      {
        "name": "Zone",
        "jsonName": "zone",
        "protoField": "zone",
        "type": {
          "kind": "string"
        },
        "description": "The availability zone for the primary server.\n Valid values: \"1\", \"2\", \"3\". If omitted, Azure selects automatically.\n\n When using ZoneRedundant high availability, the standby is placed in\n a different zone from the primary. Set this to control primary placement.",
        "required": false
      },
      {
        "name": "HighAvailability",
        "jsonName": "highAvailability",
        "protoField": "high_availability",
        "type": {
          "kind": "message",
          "messageType": "AzurePostgresqlHighAvailability"
        },
        "description": "High availability configuration.\n If this message is present, high availability is enabled.\n If omitted, the server runs as a single instance (no HA).\n\n Burstable SKUs (B_Standard_*) do NOT support high availability.\n General Purpose and Memory Optimized SKUs support both modes.",
        "required": false
      },
      {
        "name": "BackupRetentionDays",
        "jsonName": "backupRetentionDays",
        "protoField": "backup_retention_days",
        "type": {
          "kind": "int32"
        },
        "description": "The number of days to retain backups.\n Azure performs automatic daily backups. This controls how far back\n you can restore using point-in-time restore.\n Default: 7 days. Range: 7 to 35 days.",
        "required": false,
        "validation": {
          "min": 7,
          "max": 35
        },
        "default": "7",
        "oneofGroup": "_backup_retention_days"
      },
      {
        "name": "GeoRedundantBackupEnabled",
        "jsonName": "geoRedundantBackupEnabled",
        "protoField": "geo_redundant_backup_enabled",
        "type": {
          "kind": "bool"
        },
        "description": "Enable geo-redundant backup storage.\n When enabled, backup data is replicated to a paired Azure region,\n enabling cross-region restore for disaster recovery.\n\n **ForceNew**: Changing this destroys and recreates the server.\n Only available in regions that support geo-redundant storage.\n Default: false",
        "required": false,
        "default": "false",
        "oneofGroup": "_geo_redundant_backup_enabled"
      },
      {
        "name": "Databases",
        "jsonName": "databases",
        "protoField": "databases",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "AzurePostgresqlDatabase"
          }
        },
        "description": "Databases to create on the server.\n Each database is created as a separate `azurerm_postgresql_flexible_server_database`\n resource with its own lifecycle.\n\n If omitted, only the default \"postgres\" database exists (created by Azure\n automatically). Most applications create at least one application database.",
        "required": false
      },
      {
        "name": "FirewallRules",
        "jsonName": "firewallRules",
        "protoField": "firewall_rules",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "AzurePostgresqlFirewallRule"
          }
        },
        "description": "Firewall rules for public access mode.\n Only effective when `delegated_subnet_id` is NOT set (public access mode).\n Each rule allows connections from a range of IP addresses.\n\n To allow all Azure services: start_ip_address = \"0.0.0.0\", end_ip_address = \"0.0.0.0\"\n To allow a single IP: set both start and end to the same address.",
        "required": false
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "AzurePostgresqlDatabase",
      "description": "AzurePostgresqlDatabase defines a database to create on the PostgreSQL\n Flexible Server. Each database is a separate Azure resource with its own\n lifecycle, enabling independent management.",
      "protoType": "org.openmcf.provider.azure.azurepostgresqlflexibleserver.v1.AzurePostgresqlDatabase",
      "fields": [
        {
          "name": "Name",
          "jsonName": "name",
          "protoField": "name",
          "type": {
            "kind": "string"
          },
          "description": "The name of the database.\n Must be unique within the server.\n Allowed characters: letters, numbers, underscores, hyphens.",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 1
          }
        },
        {
          "name": "Charset",
          "jsonName": "charset",
          "protoField": "charset",
          "type": {
            "kind": "string"
          },
          "description": "The character set for the database.\n Default: \"UTF8\" (recommended for most applications).\n Common values: \"UTF8\", \"SQL_ASCII\", \"LATIN1\".",
          "required": false,
          "default": "UTF8",
          "oneofGroup": "_charset"
        },
        {
          "name": "Collation",
          "jsonName": "collation",
          "protoField": "collation",
          "type": {
            "kind": "string"
          },
          "description": "The collation for the database.\n Default: \"en_US.utf8\" (recommended for most applications).\n Determines sort order and string comparison behavior.",
          "required": false,
          "default": "en_US.utf8",
          "oneofGroup": "_collation"
        }
      ]
    },
    {
      "name": "AzurePostgresqlFirewallRule",
      "description": "AzurePostgresqlFirewallRule defines a firewall rule for public access mode.\n Each rule allows connections from a contiguous range of IPv4 addresses.",
      "protoType": "org.openmcf.provider.azure.azurepostgresqlflexibleserver.v1.AzurePostgresqlFirewallRule",
      "fields": [
        {
          "name": "Name",
          "jsonName": "name",
          "protoField": "name",
          "type": {
            "kind": "string"
          },
          "description": "The name of the firewall rule.\n Must be unique within the server.\n Examples: \"allow-office\", \"allow-azure-services\", \"allow-dev-machine\".",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 1
          }
        },
        {
          "name": "StartIpAddress",
          "jsonName": "startIpAddress",
          "protoField": "start_ip_address",
          "type": {
            "kind": "string"
          },
          "description": "The start of the IP address range (inclusive).\n Must be a valid IPv4 address.\n Use \"0.0.0.0\" with end \"0.0.0.0\" to allow all Azure services.",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 7
          }
        },
        {
          "name": "EndIpAddress",
          "jsonName": "endIpAddress",
          "protoField": "end_ip_address",
          "type": {
            "kind": "string"
          },
          "description": "The end of the IP address range (inclusive).\n Must be a valid IPv4 address and \u003e= start_ip_address.\n Set equal to start_ip_address for a single IP rule.",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 7
          }
        }
      ]
    },
    {
      "name": "AzurePostgresqlHighAvailability",
      "description": "AzurePostgresqlHighAvailability defines the high availability configuration\n for the PostgreSQL Flexible Server.\n\n When this message is present on the spec, HA is enabled. Omitting it means\n the server runs as a single instance.",
      "protoType": "org.openmcf.provider.azure.azurepostgresqlflexibleserver.v1.AzurePostgresqlHighAvailability",
      "fields": [
        {
          "name": "Mode",
          "jsonName": "mode",
          "protoField": "mode",
          "type": {
            "kind": "string"
          },
          "description": "The high availability mode.\n Uses Azure's exact API values for provider authenticity.\n\n Valid values:\n - \"ZoneRedundant\" -- Standby in a different availability zone (recommended for production)\n - \"SameZone\" -- Standby in the same zone as primary (lower latency failover)\n\n ZoneRedundant provides protection against zone-level failures.\n SameZone provides faster failover but no zone-level protection.",
          "required": true,
          "validation": {
            "required": true
          }
        },
        {
          "name": "StandbyAvailabilityZone",
          "jsonName": "standbyAvailabilityZone",
          "protoField": "standby_availability_zone",
          "type": {
            "kind": "string"
          },
          "description": "The availability zone for the standby server.\n Valid values: \"1\", \"2\", \"3\". If omitted, Azure selects automatically.\n\n Must be different from the primary server's `zone` when using ZoneRedundant mode.\n Can only be set during initial creation; updates are not supported.",
          "required": false
        }
      ]
    }
  ]
}
