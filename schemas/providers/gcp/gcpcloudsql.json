{
  "name": "GcpCloudSql",
  "kind": "GcpCloudSql",
  "cloudProvider": "gcp",
  "apiVersion": "gcp.openmcf.org/v1",
  "description": "gcp-cloud-sql",
  "protoPackage": "org.openmcf.provider.gcp.gcpcloudsql.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/gcp/gcpcloudsql/v1/api.proto",
    "spec": "org/openmcf/provider/gcp/gcpcloudsql/v1/spec.proto"
  },
  "spec": {
    "name": "GcpCloudSqlSpec",
    "fields": [
      {
        "name": "ProjectId",
        "jsonName": "projectId",
        "protoField": "project_id",
        "type": {
          "kind": "string"
        },
        "description": "GCP project ID where the Cloud SQL instance will be created.\n Can be a literal value or a reference to a GcpProject resource.",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "GcpProject",
        "referenceFieldPath": "status.outputs.project_id"
      },
      {
        "name": "Region",
        "jsonName": "region",
        "protoField": "region",
        "type": {
          "kind": "string"
        },
        "description": "Region where the instance is deployed, for example \"us-central1\".",
        "required": true,
        "validation": {
          "required": true,
          "pattern": "^[a-z]+-[a-z]+[0-9]$"
        }
      },
      {
        "name": "DatabaseEngine",
        "jsonName": "databaseEngine",
        "protoField": "database_engine",
        "type": {
          "kind": "enum",
          "enumType": "org.openmcf.provider.gcp.gcpcloudsql.v1.GcpCloudSqlDatabaseEngine",
          "enumValues": [
            "MYSQL",
            "POSTGRESQL"
          ]
        },
        "description": "Database engine type (MYSQL or POSTGRESQL).",
        "required": true,
        "validation": {
          "required": true
        }
      },
      {
        "name": "DatabaseVersion",
        "jsonName": "databaseVersion",
        "protoField": "database_version",
        "type": {
          "kind": "string"
        },
        "description": "Database version string, engine-specific (e.g., \"MYSQL_8_0\" or \"POSTGRES_15\").",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1
        }
      },
      {
        "name": "Tier",
        "jsonName": "tier",
        "protoField": "tier",
        "type": {
          "kind": "string"
        },
        "description": "Machine tier/type for the instance, for example \"db-n1-standard-1\".",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1
        }
      },
      {
        "name": "StorageGb",
        "jsonName": "storageGb",
        "protoField": "storage_gb",
        "type": {
          "kind": "int32"
        },
        "description": "Storage size in gigabytes for the database instance.",
        "required": true,
        "validation": {
          "required": true,
          "min": 10,
          "max": 65536
        },
        "recommendedDefault": "10"
      },
      {
        "name": "DiskAutoresize",
        "jsonName": "diskAutoresize",
        "protoField": "disk_autoresize",
        "type": {
          "kind": "bool"
        },
        "description": "Whether storage should automatically resize when approaching capacity.\n Enabled by default to prevent out-of-space issues.",
        "required": false,
        "recommendedDefault": "true"
      },
      {
        "name": "Edition",
        "jsonName": "edition",
        "protoField": "edition",
        "type": {
          "kind": "enum",
          "enumType": "org.openmcf.provider.gcp.gcpcloudsql.v1.GcpCloudSqlEdition",
          "enumValues": [
            "ENTERPRISE",
            "ENTERPRISE_PLUS"
          ]
        },
        "description": "Cloud SQL edition: ENTERPRISE (standard) or ENTERPRISE_PLUS (premium with 99.99% SLA).\n Defaults to ENTERPRISE if not specified.",
        "required": false,
        "recommendedDefault": "ENTERPRISE"
      },
      {
        "name": "DeletionProtection",
        "jsonName": "deletionProtection",
        "protoField": "deletion_protection",
        "type": {
          "kind": "bool"
        },
        "description": "Whether to enable deletion protection. When enabled, prevents accidental deletion of the instance.\n Highly recommended for production instances.",
        "required": false,
        "recommendedDefault": "false"
      },
      {
        "name": "QueryInsightsEnabled",
        "jsonName": "queryInsightsEnabled",
        "protoField": "query_insights_enabled",
        "type": {
          "kind": "bool"
        },
        "description": "Whether to enable Query Insights for performance monitoring and query analysis.",
        "required": false
      },
      {
        "name": "MaintenanceWindow",
        "jsonName": "maintenanceWindow",
        "protoField": "maintenance_window",
        "type": {
          "kind": "message",
          "messageType": "GcpCloudSqlMaintenanceWindow"
        },
        "description": "Maintenance window configuration for scheduling updates during off-peak hours.",
        "required": false
      },
      {
        "name": "Network",
        "jsonName": "network",
        "protoField": "network",
        "type": {
          "kind": "message",
          "messageType": "GcpCloudSqlNetwork"
        },
        "description": "Network configuration for the Cloud SQL instance.",
        "required": false
      },
      {
        "name": "HighAvailability",
        "jsonName": "highAvailability",
        "protoField": "high_availability",
        "type": {
          "kind": "message",
          "messageType": "GcpCloudSqlHighAvailability"
        },
        "description": "High availability configuration.",
        "required": false
      },
      {
        "name": "Backup",
        "jsonName": "backup",
        "protoField": "backup",
        "type": {
          "kind": "message",
          "messageType": "GcpCloudSqlBackup"
        },
        "description": "Backup configuration settings.",
        "required": false
      },
      {
        "name": "DatabaseFlags",
        "jsonName": "databaseFlags",
        "protoField": "database_flags",
        "type": {
          "kind": "map",
          "keyType": {
            "kind": "string"
          },
          "valueType": {
            "kind": "string"
          }
        },
        "description": "Database-specific configuration flags as key-value pairs.",
        "required": false
      },
      {
        "name": "RootPassword",
        "jsonName": "rootPassword",
        "protoField": "root_password",
        "type": {
          "kind": "string"
        },
        "description": "Initial root password for the database instance.",
        "required": false,
        "validation": {
          "minLength": 8
        }
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "GcpCloudSqlBackup",
      "description": "GcpCloudSqlBackup defines backup configuration for the Cloud SQL instance.",
      "protoType": "org.openmcf.provider.gcp.gcpcloudsql.v1.GcpCloudSqlBackup",
      "fields": [
        {
          "name": "Enabled",
          "jsonName": "enabled",
          "protoField": "enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether automated backups are enabled.",
          "required": false
        },
        {
          "name": "StartTime",
          "jsonName": "startTime",
          "protoField": "start_time",
          "type": {
            "kind": "string"
          },
          "description": "Start time for daily backup window in HH:MM format (UTC).",
          "required": false,
          "validation": {
            "pattern": "^([0-1][0-9]|2[0-3]):[0-5][0-9]$"
          }
        },
        {
          "name": "RetentionDays",
          "jsonName": "retentionDays",
          "protoField": "retention_days",
          "type": {
            "kind": "int32"
          },
          "description": "Number of days to retain automated backups.",
          "required": false,
          "validation": {
            "min": 1,
            "max": 365
          },
          "recommendedDefault": "7"
        },
        {
          "name": "PointInTimeRecoveryEnabled",
          "jsonName": "pointInTimeRecoveryEnabled",
          "protoField": "point_in_time_recovery_enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether to enable Point-in-Time Recovery (PITR).\n Allows restoring to any specific second within the retention window.\n Requires automated backups to be enabled and uses transaction logs.\n Essential for protecting against human error (accidental deletes, bad migrations).",
          "required": false
        }
      ]
    },
    {
      "name": "GcpCloudSqlHighAvailability",
      "description": "GcpCloudSqlHighAvailability defines high availability configuration.",
      "protoType": "org.openmcf.provider.gcp.gcpcloudsql.v1.GcpCloudSqlHighAvailability",
      "fields": [
        {
          "name": "Enabled",
          "jsonName": "enabled",
          "protoField": "enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether to enable high availability (regional failover).",
          "required": false
        },
        {
          "name": "Zone",
          "jsonName": "zone",
          "protoField": "zone",
          "type": {
            "kind": "string"
          },
          "description": "Secondary zone for high availability failover.",
          "required": false
        }
      ]
    },
    {
      "name": "GcpCloudSqlMaintenanceWindow",
      "description": "GcpCloudSqlMaintenanceWindow defines when Cloud SQL can perform maintenance updates.",
      "protoType": "org.openmcf.provider.gcp.gcpcloudsql.v1.GcpCloudSqlMaintenanceWindow",
      "fields": [
        {
          "name": "Day",
          "jsonName": "day",
          "protoField": "day",
          "type": {
            "kind": "int32"
          },
          "description": "Day of the week for maintenance (1=Monday, 7=Sunday).",
          "required": false,
          "validation": {
            "min": 1,
            "max": 7
          }
        },
        {
          "name": "Hour",
          "jsonName": "hour",
          "protoField": "hour",
          "type": {
            "kind": "int32"
          },
          "description": "Hour of the day for maintenance start (0-23, UTC).",
          "required": false,
          "validation": {
            "max": 23
          }
        },
        {
          "name": "UpdateTrack",
          "jsonName": "updateTrack",
          "protoField": "update_track",
          "type": {
            "kind": "string"
          },
          "description": "Update track: \"canary\" for early updates, \"stable\" for production (default).",
          "required": false,
          "validation": {
            "enum": [
              "canary",
              "stable",
              ""
            ]
          }
        }
      ]
    },
    {
      "name": "GcpCloudSqlNetwork",
      "description": "GcpCloudSqlNetwork defines network configuration for the Cloud SQL instance.",
      "protoType": "org.openmcf.provider.gcp.gcpcloudsql.v1.GcpCloudSqlNetwork",
      "fields": [
        {
          "name": "VpcId",
          "jsonName": "vpcId",
          "protoField": "vpc_id",
          "type": {
            "kind": "string"
          },
          "description": "VPC network ID for private IP connectivity.\n Can be a literal value or a reference to a GcpVpc resource.",
          "required": false,
          "referenceKind": "GcpVpc",
          "referenceFieldPath": "status.outputs.network_id"
        },
        {
          "name": "PrivateIpEnabled",
          "jsonName": "privateIpEnabled",
          "protoField": "private_ip_enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether to enable private IP for the instance.\n Recommended for secure in-VPC access.",
          "required": false
        },
        {
          "name": "Ipv4Enabled",
          "jsonName": "ipv4Enabled",
          "protoField": "ipv4_enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether to enable public IP (IPv4) for the instance.\n Can be combined with private IP for \"Smart Hybrid\" pattern.\n When enabled with empty authorized_networks, access is via Cloud SQL Proxy only (IAM-based).",
          "required": false
        },
        {
          "name": "AuthorizedNetworks",
          "jsonName": "authorizedNetworks",
          "protoField": "authorized_networks",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "List of authorized networks (CIDR blocks) allowed to connect via public IP.\n Leave empty for maximum security (Cloud SQL Proxy with IAM authentication only).",
          "required": false,
          "validation": {
            "unique": true
          }
        }
      ]
    }
  ]
}
