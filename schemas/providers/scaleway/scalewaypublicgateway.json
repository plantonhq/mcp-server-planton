{
  "name": "ScalewayPublicGateway",
  "kind": "ScalewayPublicGateway",
  "cloudProvider": "scaleway",
  "apiVersion": "scaleway.openmcf.org/v1",
  "description": "scaleway-public-gateway",
  "protoPackage": "org.openmcf.provider.scaleway.scalewaypublicgateway.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/scaleway/scalewaypublicgateway/v1/api.proto",
    "spec": "org/openmcf/provider/scaleway/scalewaypublicgateway/v1/spec.proto"
  },
  "spec": {
    "name": "ScalewayPublicGatewaySpec",
    "fields": [
      {
        "name": "PrivateNetworkId",
        "jsonName": "privateNetworkId",
        "protoField": "private_network_id",
        "type": {
          "kind": "string"
        },
        "description": "The Private Network to attach this gateway to.\n\n The gateway provides NAT, SSH bastion, and port forwarding for resources\n in this network. Can be a literal Private Network UUID or a reference to\n a ScalewayPrivateNetwork resource's output.\n\n In infra charts, this is typically wired via valueFrom:\n\n   privateNetworkId:\n     valueFrom:\n       kind: ScalewayPrivateNetwork\n       name: app-network\n       fieldPath: status.outputs.private_network_id",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "ScalewayPrivateNetwork",
        "referenceFieldPath": "status.outputs.private_network_id"
      },
      {
        "name": "Zone",
        "jsonName": "zone",
        "protoField": "zone",
        "type": {
          "kind": "string"
        },
        "description": "The Scaleway zone where the gateway will be created.\n Examples: \"fr-par-1\", \"nl-ams-1\", \"pl-waw-1\"\n\n Public Gateways are zonal resources (unlike VPCs and Private Networks\n which are regional). The zone must be within the same region as the\n target Private Network. For example, if the Private Network is in\n region \"fr-par\", the gateway zone must be \"fr-par-1\", \"fr-par-2\", etc.\n\n This field is required and cannot be changed after creation.",
        "required": true,
        "validation": {
          "required": true
        }
      },
      {
        "name": "Type",
        "jsonName": "type",
        "protoField": "type",
        "type": {
          "kind": "string"
        },
        "description": "Gateway type determines bandwidth and performance tier.\n\n Available types:\n   - \"VPC-GW-S\"  -- Standard gateway. Sufficient for most workloads.\n   - \"VPC-GW-XL\" -- High-bandwidth gateway (up to 10 Gbps). Available\n                     only in Paris region zones (fr-par-1, fr-par-2, etc.).\n\n Choose \"VPC-GW-S\" unless you have specific high-throughput requirements.",
        "required": true,
        "validation": {
          "required": true
        },
        "recommendedDefault": "VPC-GW-S"
      },
      {
        "name": "EnableMasquerade",
        "jsonName": "enableMasquerade",
        "protoField": "enable_masquerade",
        "type": {
          "kind": "bool"
        },
        "description": "Whether to enable NAT masquerade on the Private Network attachment.\n\n When enabled, resources in the attached Private Network can reach the\n internet through the gateway's public IP. This is the primary use case\n for a Public Gateway and is almost always enabled.\n\n Disable only if using the gateway solely as an SSH bastion without NAT\n functionality, or if outbound internet access is handled by other means.\n\n Default: true",
        "required": false,
        "recommendedDefault": "true"
      },
      {
        "name": "Bastion",
        "jsonName": "bastion",
        "protoField": "bastion",
        "type": {
          "kind": "message",
          "messageType": "ScalewayPublicGatewayBastion"
        },
        "description": "SSH bastion configuration.\n\n When enabled, the gateway acts as a jump host for SSH connections to\n resources in the Private Network. Users SSH to the gateway's public IP,\n and the gateway proxies the connection to the target private IP.\n\n Optional. If omitted, the SSH bastion is disabled.",
        "required": false
      },
      {
        "name": "EnableSmtp",
        "jsonName": "enableSmtp",
        "protoField": "enable_smtp",
        "type": {
          "kind": "bool"
        },
        "description": "Whether to enable outbound SMTP through the gateway.\n\n By default, outbound SMTP (port 25) is blocked to prevent spam abuse.\n Enable only if resources in the Private Network need to send email\n directly (e.g., an email relay or notification service).\n\n Default: false",
        "required": false
      },
      {
        "name": "ReverseDns",
        "jsonName": "reverseDns",
        "protoField": "reverse_dns",
        "type": {
          "kind": "string"
        },
        "description": "Reverse DNS hostname for the gateway's public IP.\n Example: \"gateway.example.com\"\n\n A matching DNS A record pointing to the public IP must already exist\n before setting this field. Useful for email servers (SPF/DKIM compliance),\n compliance requirements, and professional appearance in network logs.\n\n Optional. If omitted, reverse DNS is not configured.",
        "required": false
      },
      {
        "name": "PatRules",
        "jsonName": "patRules",
        "protoField": "pat_rules",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "ScalewayPublicGatewayPatRule"
          }
        },
        "description": "Port forwarding (PAT) rules.\n\n Each rule maps a public port on the gateway's IP to a private IP and\n port inside the attached Private Network. This enables inbound access\n to specific services without giving them public IPs.\n\n Example: Forward public port 8080 to a web server at 10.0.1.5:80.\n\n Optional. If omitted, no port forwarding rules are created.",
        "required": false
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "ScalewayPublicGatewayBastion",
      "description": "ScalewayPublicGatewayBastion configures the SSH bastion feature.\n\n The bastion provides a secure, auditable entry point for SSH connections\n to resources in the Private Network. Instead of assigning public IPs to\n individual instances, users SSH to the gateway and the gateway proxies\n the connection.",
      "protoType": "org.openmcf.provider.scaleway.scalewaypublicgateway.v1.ScalewayPublicGatewayBastion",
      "fields": [
        {
          "name": "Enabled",
          "jsonName": "enabled",
          "protoField": "enabled",
          "type": {
            "kind": "bool"
          },
          "description": "Whether to enable SSH bastion.\n\n When true, the gateway listens for SSH connections and proxies them\n to resources in the attached Private Network.",
          "required": false
        },
        {
          "name": "Port",
          "jsonName": "port",
          "protoField": "port",
          "type": {
            "kind": "int32"
          },
          "description": "Port for the SSH bastion to listen on.\n\n Default: 22. Change only if port 22 is blocked by corporate firewalls\n or if you need a non-standard port for security-through-obscurity.",
          "required": false,
          "recommendedDefault": "22"
        },
        {
          "name": "AllowedIpRanges",
          "jsonName": "allowedIpRanges",
          "protoField": "allowed_ip_ranges",
          "type": {
            "kind": "array",
            "elementType": {
              "kind": "string"
            }
          },
          "description": "CIDR ranges allowed to connect to the bastion.\n Examples: [\"203.0.113.0/24\", \"198.51.100.10/32\"]\n\n Restricts SSH bastion access to specific source IP ranges. If empty,\n all IP ranges are allowed -- not recommended for production.\n\n Best practice: Restrict to your office IP range, VPN exit IPs, or\n CI/CD runner IPs.",
          "required": false
        }
      ]
    },
    {
      "name": "ScalewayPublicGatewayPatRule",
      "description": "ScalewayPublicGatewayPatRule defines a port forwarding rule.\n\n PAT (Port Address Translation) maps a public port on the gateway's IP\n to a private IP and port inside the attached Private Network. This\n enables inbound traffic to reach specific services without assigning\n public IPs to individual resources.",
      "protoType": "org.openmcf.provider.scaleway.scalewaypublicgateway.v1.ScalewayPublicGatewayPatRule",
      "fields": [
        {
          "name": "PrivateIp",
          "jsonName": "privateIp",
          "protoField": "private_ip",
          "type": {
            "kind": "string"
          },
          "description": "Private IP address to forward traffic to.\n\n Must be an IP address within the attached Private Network's subnet.\n Example: \"10.0.1.5\"",
          "required": true,
          "validation": {
            "required": true
          }
        },
        {
          "name": "PrivatePort",
          "jsonName": "privatePort",
          "protoField": "private_port",
          "type": {
            "kind": "int32"
          },
          "description": "Private port to forward traffic to.\n Example: 80 (for a web server), 5432 (for PostgreSQL)",
          "required": true,
          "validation": {
            "required": true
          }
        },
        {
          "name": "PublicPort",
          "jsonName": "publicPort",
          "protoField": "public_port",
          "type": {
            "kind": "int32"
          },
          "description": "Public port to listen on the gateway's public IP.\n\n External traffic hitting this port on the gateway's public IP will\n be forwarded to private_ip:private_port.\n Example: 8080",
          "required": true,
          "validation": {
            "required": true
          }
        },
        {
          "name": "Protocol",
          "jsonName": "protocol",
          "protoField": "protocol",
          "type": {
            "kind": "string"
          },
          "description": "Protocol for the rule: \"tcp\", \"udp\", or \"both\".\n\n Default: \"both\" (forwards both TCP and UDP traffic).\n Use \"tcp\" for web servers, SSH, databases. Use \"udp\" for DNS, game\n servers, media streaming. Use \"both\" when unsure.",
          "required": false,
          "recommendedDefault": "both"
        }
      ]
    }
  ]
}
