{
  "name": "AzureMysqlFlexibleServer",
  "kind": "AzureMysqlFlexibleServer",
  "cloudProvider": "azure",
  "apiVersion": "azure.openmcf.org/v1",
  "description": "AzureMysqlFlexibleServer is the top-level API resource for an Azure\n Database for MySQL Flexible Server.\n Azure Database for MySQL Flexible Server is a fully managed relational\n database service with granular control over compute, storage, high availability,\n and networking. Supports MySQL 5.7, 8.0.21, and 8.4.",
  "protoPackage": "org.openmcf.provider.azure.azuremysqlflexibleserver.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/azure/azuremysqlflexibleserver/v1/api.proto",
    "spec": "org/openmcf/provider/azure/azuremysqlflexibleserver/v1/spec.proto"
  },
  "spec": {
    "name": "AzureMysqlFlexibleServerSpec",
    "fields": [
      {
        "name": "Region",
        "jsonName": "region",
        "protoField": "region",
        "type": {
          "kind": "string"
        },
        "description": "The Azure region where the MySQL Flexible Server will be created.\n Must match the region of the VNet/subnet if VNet integration is used.\n Examples: \"eastus\", \"westus2\", \"westeurope\", \"southeastasia\".",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1
        }
      },
      {
        "name": "ResourceGroup",
        "jsonName": "resourceGroup",
        "protoField": "resource_group",
        "type": {
          "kind": "string"
        },
        "description": "The Azure Resource Group where the MySQL Flexible Server will be created.\n Can be a literal string or a reference to an AzureResourceGroup output.",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "AzureResourceGroup",
        "referenceFieldPath": "status.outputs.resource_group_name"
      },
      {
        "name": "Name",
        "jsonName": "name",
        "protoField": "name",
        "type": {
          "kind": "string"
        },
        "description": "The name of the MySQL Flexible Server.\n Must be globally unique across Azure. Used as the server hostname:\n `{name}.mysql.database.azure.com`\n Allowed characters: lowercase letters, numbers, and hyphens.\n Must start with a letter or number. Length: 3 to 63 characters.\n\n **ForceNew**: Changing this destroys and recreates the server.",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 3,
          "maxLength": 63
        }
      },
      {
        "name": "AdministratorLogin",
        "jsonName": "administratorLogin",
        "protoField": "administrator_login",
        "type": {
          "kind": "string"
        },
        "description": "The administrator login name for the server.\n Cannot be \"azure_superuser\", \"admin\", \"administrator\", \"root\", \"guest\", or \"public\".\n Must start with a letter or underscore. Length: 1 to 32 characters.\n\n **ForceNew**: Changing this destroys and recreates the server.",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1,
          "maxLength": 32
        }
      },
      {
        "name": "AdministratorPassword",
        "jsonName": "administratorPassword",
        "protoField": "administrator_password",
        "type": {
          "kind": "string"
        },
        "description": "The administrator password for the server.\n Can be a literal value or a reference to another resource's output\n (e.g., a generated random password or a Key Vault secret value).\n\n Password requirements: 8-128 characters, must contain characters from\n at least three of: uppercase, lowercase, digits, special characters.\n\n This is a polymorphic StringValueOrRef with no default_kind because\n the password source varies (literal, chart variable, external secret).",
        "required": true,
        "validation": {
          "required": true
        }
      },
      {
        "name": "Version",
        "jsonName": "version",
        "protoField": "version",
        "type": {
          "kind": "string"
        },
        "description": "The MySQL major version.\n Uses Azure's exact version strings for provider authenticity.\n\n Valid values: \"5.7\", \"8.0.21\", \"8.4\"\n Default: \"8.0.21\" (current GA production standard)\n\n - \"5.7\": Approaching EOL, use only for legacy migration\n - \"8.0.21\": Active, recommended for most production workloads (default)\n - \"8.4\": Latest GA, performance improvements, new features",
        "required": false,
        "default": "8.0.21",
        "oneofGroup": "_version"
      },
      {
        "name": "SkuName",
        "jsonName": "skuName",
        "protoField": "sku_name",
        "type": {
          "kind": "string"
        },
        "description": "The SKU name defining the compute tier and size.\n Format: {TIER}_Standard_{SIZE}\n\n Burstable (dev/test):\n   \"B_Standard_B1ms\" (1 vCPU, 2 GiB), \"B_Standard_B2ms\" (2 vCPU, 4 GiB),\n   \"B_Standard_B4ms\" (4 vCPU, 8 GiB), \"B_Standard_B8ms\" (8 vCPU, 16 GiB)\n\n General Purpose (production):\n   \"GP_Standard_D2ds_v4\" (2 vCPU, 8 GiB), \"GP_Standard_D4ds_v4\" (4 vCPU, 16 GiB),\n   \"GP_Standard_D8ds_v4\" (8 vCPU, 32 GiB), \"GP_Standard_D16ds_v4\" (16 vCPU, 64 GiB),\n   \"GP_Standard_D2ads_v5\" through \"GP_Standard_D64ads_v5\"\n\n Memory Optimized (analytics, caching):\n   \"MO_Standard_E2ds_v4\" (2 vCPU, 16 GiB) through \"MO_Standard_E96ads_v5\"",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 1
        }
      },
      {
        "name": "StorageSizeGb",
        "jsonName": "storageSizeGb",
        "protoField": "storage_size_gb",
        "type": {
          "kind": "int32"
        },
        "description": "The storage size in gigabytes.\n Range: 20 GB to 16384 GB (16 TB).\n\n **Cannot be downgraded** -- decreasing storage_size_gb forces server recreation.\n Azure validates exact values; the minimum is enforced here.",
        "required": true,
        "validation": {
          "required": true,
          "min": 20
        }
      },
      {
        "name": "AutoGrowEnabled",
        "jsonName": "autoGrowEnabled",
        "protoField": "auto_grow_enabled",
        "type": {
          "kind": "bool"
        },
        "description": "Enable storage auto-grow.\n When enabled, Azure automatically increases storage when free storage\n falls below a threshold. Prevents out-of-storage failures for databases\n that grow unpredictably.\n\n Default: true (MySQL provider default; note this differs from PostgreSQL\n where auto-grow defaults to false)",
        "required": false,
        "default": "true",
        "oneofGroup": "_auto_grow_enabled"
      },
      {
        "name": "DelegatedSubnetId",
        "jsonName": "delegatedSubnetId",
        "protoField": "delegated_subnet_id",
        "type": {
          "kind": "string"
        },
        "description": "The ID of a subnet delegated to Microsoft.DBforMySQL/flexibleServers.\n When set, the server is deployed with **private VNet access** and\n public network access is automatically disabled.\n\n The subnet must have the delegation `Microsoft.DBforMySQL/flexibleServers`.\n Use the AzureSubnet component with a delegation block to create a properly\n configured subnet.\n\n **ForceNew**: Changing this destroys and recreates the server.",
        "required": false,
        "referenceKind": "AzureSubnet",
        "referenceFieldPath": "status.outputs.subnet_id"
      },
      {
        "name": "PrivateDnsZoneId",
        "jsonName": "privateDnsZoneId",
        "protoField": "private_dns_zone_id",
        "type": {
          "kind": "string"
        },
        "description": "The ID of a private DNS zone for server name resolution within the VNet.\n Typically \"privatelink.mysql.database.azure.com\" for private access.\n\n When `delegated_subnet_id` is set, providing a private DNS zone enables\n VNet-connected clients to resolve the server's FQDN to its private IP.\n\n **ForceNew**: Changing this destroys and recreates the server.",
        "required": false,
        "referenceKind": "AzurePrivateDnsZone",
        "referenceFieldPath": "status.outputs.zone_id"
      },
      {
        "name": "Zone",
        "jsonName": "zone",
        "protoField": "zone",
        "type": {
          "kind": "string"
        },
        "description": "The availability zone for the primary server.\n Valid values: \"1\", \"2\", \"3\". If omitted, Azure selects automatically.\n\n When using ZoneRedundant high availability, the standby is placed in\n a different zone from the primary. Set this to control primary placement.",
        "required": false
      },
      {
        "name": "HighAvailability",
        "jsonName": "highAvailability",
        "protoField": "high_availability",
        "type": {
          "kind": "message",
          "messageType": "AzureMysqlHighAvailability"
        },
        "description": "High availability configuration.\n If this message is present, high availability is enabled.\n If omitted, the server runs as a single instance (no HA).\n\n Burstable SKUs (B_Standard_*) do NOT support high availability.\n General Purpose and Memory Optimized SKUs support both modes.",
        "required": false
      },
      {
        "name": "BackupRetentionDays",
        "jsonName": "backupRetentionDays",
        "protoField": "backup_retention_days",
        "type": {
          "kind": "int32"
        },
        "description": "The number of days to retain backups.\n Azure performs automatic daily backups. This controls how far back\n you can restore using point-in-time restore.\n Default: 7 days. Range: 1 to 35 days.",
        "required": false,
        "validation": {
          "min": 1,
          "max": 35
        },
        "default": "7",
        "oneofGroup": "_backup_retention_days"
      },
      {
        "name": "GeoRedundantBackupEnabled",
        "jsonName": "geoRedundantBackupEnabled",
        "protoField": "geo_redundant_backup_enabled",
        "type": {
          "kind": "bool"
        },
        "description": "Enable geo-redundant backup storage.\n When enabled, backup data is replicated to a paired Azure region,\n enabling cross-region restore for disaster recovery.\n\n **ForceNew**: Changing this destroys and recreates the server.\n Only available in regions that support geo-redundant storage.\n Default: false",
        "required": false,
        "default": "false",
        "oneofGroup": "_geo_redundant_backup_enabled"
      },
      {
        "name": "Databases",
        "jsonName": "databases",
        "protoField": "databases",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "AzureMysqlDatabase"
          }
        },
        "description": "Databases to create on the server.\n Each database is created as a separate `azurerm_mysql_flexible_database`\n resource with its own lifecycle.\n\n If omitted, only the default system databases exist (created by Azure\n automatically). Most applications create at least one application database.",
        "required": false
      },
      {
        "name": "FirewallRules",
        "jsonName": "firewallRules",
        "protoField": "firewall_rules",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "AzureMysqlFirewallRule"
          }
        },
        "description": "Firewall rules for public access mode.\n Only effective when `delegated_subnet_id` is NOT set (public access mode).\n Each rule allows connections from a range of IP addresses.\n\n To allow all Azure services: start_ip_address = \"0.0.0.0\", end_ip_address = \"0.0.0.0\"\n To allow a single IP: set both start and end to the same address.",
        "required": false
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "AzureMysqlDatabase",
      "description": "AzureMysqlDatabase defines a database to create on the MySQL Flexible Server.\n Each database is a separate Azure resource with its own lifecycle, enabling\n independent management.",
      "protoType": "org.openmcf.provider.azure.azuremysqlflexibleserver.v1.AzureMysqlDatabase",
      "fields": [
        {
          "name": "Name",
          "jsonName": "name",
          "protoField": "name",
          "type": {
            "kind": "string"
          },
          "description": "The name of the database.\n Must be unique within the server.\n Must be a valid MySQL identifier.",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 1
          }
        },
        {
          "name": "Charset",
          "jsonName": "charset",
          "protoField": "charset",
          "type": {
            "kind": "string"
          },
          "description": "The character set for the database.\n Default: \"utf8mb4\" (recommended for most applications, supports full Unicode\n including emojis and supplementary characters).\n Common values: \"utf8mb4\", \"utf8\", \"latin1\".\n\n Note: The charset comparison is case-insensitive in Azure.",
          "required": false,
          "default": "utf8mb4",
          "oneofGroup": "_charset"
        },
        {
          "name": "Collation",
          "jsonName": "collation",
          "protoField": "collation",
          "type": {
            "kind": "string"
          },
          "description": "The collation for the database.\n Default: \"utf8mb4_0900_ai_ci\" (MySQL 8.0+ default, accent-insensitive,\n case-insensitive).\n For MySQL 5.7: use \"utf8mb4_unicode_ci\" instead.\n\n Determines sort order and string comparison behavior.",
          "required": false,
          "default": "utf8mb4_0900_ai_ci",
          "oneofGroup": "_collation"
        }
      ]
    },
    {
      "name": "AzureMysqlFirewallRule",
      "description": "AzureMysqlFirewallRule defines a firewall rule for public access mode.\n Each rule allows connections from a contiguous range of IPv4 addresses.",
      "protoType": "org.openmcf.provider.azure.azuremysqlflexibleserver.v1.AzureMysqlFirewallRule",
      "fields": [
        {
          "name": "Name",
          "jsonName": "name",
          "protoField": "name",
          "type": {
            "kind": "string"
          },
          "description": "The name of the firewall rule.\n Must be unique within the server.\n Examples: \"allow-office\", \"allow-azure-services\", \"allow-dev-machine\".",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 1
          }
        },
        {
          "name": "StartIpAddress",
          "jsonName": "startIpAddress",
          "protoField": "start_ip_address",
          "type": {
            "kind": "string"
          },
          "description": "The start of the IP address range (inclusive).\n Must be a valid IPv4 address.\n Use \"0.0.0.0\" with end \"0.0.0.0\" to allow all Azure services.",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 7
          }
        },
        {
          "name": "EndIpAddress",
          "jsonName": "endIpAddress",
          "protoField": "end_ip_address",
          "type": {
            "kind": "string"
          },
          "description": "The end of the IP address range (inclusive).\n Must be a valid IPv4 address and \u003e= start_ip_address.\n Set equal to start_ip_address for a single IP rule.",
          "required": true,
          "validation": {
            "required": true,
            "minLength": 7
          }
        }
      ]
    },
    {
      "name": "AzureMysqlHighAvailability",
      "description": "AzureMysqlHighAvailability defines the high availability configuration\n for the MySQL Flexible Server.\n\n When this message is present on the spec, HA is enabled. Omitting it means\n the server runs as a single instance.",
      "protoType": "org.openmcf.provider.azure.azuremysqlflexibleserver.v1.AzureMysqlHighAvailability",
      "fields": [
        {
          "name": "Mode",
          "jsonName": "mode",
          "protoField": "mode",
          "type": {
            "kind": "string"
          },
          "description": "The high availability mode.\n Uses Azure's exact API values for provider authenticity.\n\n Valid values:\n - \"ZoneRedundant\" -- Standby in a different availability zone (recommended for production)\n - \"SameZone\" -- Standby in the same zone as primary (lower latency failover)\n\n ZoneRedundant provides protection against zone-level failures.\n SameZone provides faster failover but no zone-level protection.",
          "required": true,
          "validation": {
            "required": true
          }
        },
        {
          "name": "StandbyAvailabilityZone",
          "jsonName": "standbyAvailabilityZone",
          "protoField": "standby_availability_zone",
          "type": {
            "kind": "string"
          },
          "description": "The availability zone for the standby server.\n Valid values: \"1\", \"2\", \"3\". If omitted, Azure selects automatically.\n\n Must be different from the primary server's `zone` when using ZoneRedundant mode.\n Can only be set during initial creation; updates are not supported.",
          "required": false
        }
      ]
    }
  ]
}
