{
  "name": "AwsRdsCluster",
  "kind": "AwsRdsCluster",
  "cloudProvider": "aws",
  "apiVersion": "aws.openmcf.org/v1",
  "description": "aws-rds-cluster",
  "protoPackage": "org.openmcf.provider.aws.awsrdscluster.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/aws/awsrdscluster/v1/api.proto",
    "spec": "org/openmcf/provider/aws/awsrdscluster/v1/spec.proto"
  },
  "spec": {
    "name": "AwsRdsClusterSpec",
    "fields": [
      {
        "name": "Region",
        "jsonName": "region",
        "protoField": "region",
        "type": {
          "kind": "string"
        },
        "description": "The AWS region where the resource will be created.\n Example: \"us-west-2\", \"eu-west-1\"",
        "required": false,
        "validation": {
          "minLength": 1
        }
      },
      {
        "name": "SubnetIds",
        "jsonName": "subnetIds",
        "protoField": "subnet_ids",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "subnet_ids is the list of subnet IDs used by the DB subnet group for the cluster.\n Provide at least two subnets in distinct Availability Zones for high availability.",
        "required": false,
        "referenceKind": "AwsVpc",
        "referenceFieldPath": "status.outputs.private_subnets.[*].id"
      },
      {
        "name": "DbSubnetGroupName",
        "jsonName": "dbSubnetGroupName",
        "protoField": "db_subnet_group_name",
        "type": {
          "kind": "string"
        },
        "description": "Optional name of an existing DB subnet group to use instead of providing subnet_ids.",
        "required": false
      },
      {
        "name": "SecurityGroupIds",
        "jsonName": "securityGroupIds",
        "protoField": "security_group_ids",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "vpc_security_group_ids are additional security groups attached to the cluster.",
        "required": false,
        "referenceKind": "AwsSecurityGroup",
        "referenceFieldPath": "status.outputs.security_group_id"
      },
      {
        "name": "AllowedCidrBlocks",
        "jsonName": "allowedCidrBlocks",
        "protoField": "allowed_cidr_blocks",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "allowed_cidr_blocks are IPv4 CIDRs to allow ingress to the cluster SG (if created/managed here).\n Example: \"10.0.0.0/16\", \"0.0.0.0/0\"",
        "required": false,
        "validation": {
          "unique": true
        }
      },
      {
        "name": "AssociateSecurityGroupIds",
        "jsonName": "associateSecurityGroupIds",
        "protoField": "associate_security_group_ids",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "associate_security_group_ids lists existing SGs to associate (alongside any created/managed SG).",
        "required": false,
        "referenceKind": "AwsSecurityGroup",
        "referenceFieldPath": "status.outputs.security_group_id"
      },
      {
        "name": "DatabaseName",
        "jsonName": "databaseName",
        "protoField": "database_name",
        "type": {
          "kind": "string"
        },
        "description": "database_name is the name of the initial database to create in the cluster.",
        "required": false
      },
      {
        "name": "ManageMasterUserPassword",
        "jsonName": "manageMasterUserPassword",
        "protoField": "manage_master_user_password",
        "type": {
          "kind": "bool"
        },
        "description": "manage_master_user_password, when true, lets RDS manage the master user password in AWS Secrets Manager.",
        "required": false,
        "recommendedDefault": "true"
      },
      {
        "name": "MasterUserSecretKmsKeyId",
        "jsonName": "masterUserSecretKmsKeyId",
        "protoField": "master_user_secret_kms_key_id",
        "type": {
          "kind": "string"
        },
        "description": "master_user_secret_kms_key_id is the KMS key identifier (ARN/alias) for encrypting the managed secret.",
        "required": false,
        "referenceKind": "AwsKmsKey",
        "referenceFieldPath": "status.outputs.key_arn"
      },
      {
        "name": "Username",
        "jsonName": "username",
        "protoField": "username",
        "type": {
          "kind": "string"
        },
        "description": "username is the master database user name.",
        "required": false,
        "default": "master",
        "oneofGroup": "_username"
      },
      {
        "name": "Password",
        "jsonName": "password",
        "protoField": "password",
        "type": {
          "kind": "string"
        },
        "description": "password is the master user password. Cannot be set when manage_master_user_password is true.",
        "required": false
      },
      {
        "name": "Port",
        "jsonName": "port",
        "protoField": "port",
        "type": {
          "kind": "int32"
        },
        "description": "port on which the cluster accepts connections.",
        "required": false,
        "validation": {
          "max": 65535
        }
      },
      {
        "name": "Engine",
        "jsonName": "engine",
        "protoField": "engine",
        "type": {
          "kind": "string"
        },
        "description": "engine for the cluster. Examples: \"aurora-mysql\", \"aurora-postgresql\".",
        "required": true,
        "validation": {
          "required": true
        }
      },
      {
        "name": "EngineVersion",
        "jsonName": "engineVersion",
        "protoField": "engine_version",
        "type": {
          "kind": "string"
        },
        "description": "engine_version to deploy. Example: \"8.0.mysql_aurora.3.05.2\" or \"14.6\" for Aurora PostgreSQL.",
        "required": true,
        "validation": {
          "required": true
        }
      },
      {
        "name": "StorageEncrypted",
        "jsonName": "storageEncrypted",
        "protoField": "storage_encrypted",
        "type": {
          "kind": "bool"
        },
        "description": "storage_encrypted indicates whether to enable storage encryption for the cluster.",
        "required": false
      },
      {
        "name": "KmsKeyId",
        "jsonName": "kmsKeyId",
        "protoField": "kms_key_id",
        "type": {
          "kind": "string"
        },
        "description": "kms_key_id KMS key ARN to use for storage encryption when storage_encrypted is true.",
        "required": false,
        "referenceKind": "AwsKmsKey",
        "referenceFieldPath": "status.outputs.key_arn"
      },
      {
        "name": "EnabledCloudwatchLogsExports",
        "jsonName": "enabledCloudwatchLogsExports",
        "protoField": "enabled_cloudwatch_logs_exports",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "enabled_cloudwatch_logs_exports lists database logs to export to CloudWatch Logs.\n Aurora MySQL: [audit, error, general, slowquery]\n Aurora PostgreSQL: [postgresql, upgrade]",
        "required": false,
        "validation": {
          "unique": true
        }
      },
      {
        "name": "DeletionProtection",
        "jsonName": "deletionProtection",
        "protoField": "deletion_protection",
        "type": {
          "kind": "bool"
        },
        "description": "deletion_protection prevents accidental deletion.",
        "required": false
      },
      {
        "name": "PreferredMaintenanceWindow",
        "jsonName": "preferredMaintenanceWindow",
        "protoField": "preferred_maintenance_window",
        "type": {
          "kind": "string"
        },
        "description": "preferred_maintenance_window in UTC, format 'ddd:hh24:mi-ddd:hh24:mi'.",
        "required": false,
        "validation": {
          "pattern": "^(mon|tue|wed|thu|fri|sat|sun):([01][0-9]|2[0-3]):[0-5][0-9]-(mon|tue|wed|thu|fri|sat|sun):([01][0-9]|2[0-3]):[0-5][0-9]$"
        }
      },
      {
        "name": "BackupRetentionPeriod",
        "jsonName": "backupRetentionPeriod",
        "protoField": "backup_retention_period",
        "type": {
          "kind": "int32"
        },
        "description": "backup_retention_period in days (\u003e 0 to enable automated backups).",
        "required": false,
        "validation": {
          "max": 35
        }
      },
      {
        "name": "PreferredBackupWindow",
        "jsonName": "preferredBackupWindow",
        "protoField": "preferred_backup_window",
        "type": {
          "kind": "string"
        },
        "description": "preferred_backup_window in UTC, format 'hh24:mi-hh24:mi'. Must not overlap maintenance window.",
        "required": false,
        "validation": {
          "pattern": "^([01][0-9]|2[0-3]):[0-5][0-9]-([01][0-9]|2[0-3]):[0-5][0-9]$"
        }
      },
      {
        "name": "CopyTagsToSnapshot",
        "jsonName": "copyTagsToSnapshot",
        "protoField": "copy_tags_to_snapshot",
        "type": {
          "kind": "bool"
        },
        "description": "copy_tags_to_snapshot copies tags from the cluster to snapshots.",
        "required": false
      },
      {
        "name": "SkipFinalSnapshot",
        "jsonName": "skipFinalSnapshot",
        "protoField": "skip_final_snapshot",
        "type": {
          "kind": "bool"
        },
        "description": "skip_final_snapshot controls whether a final snapshot is created before cluster deletion.",
        "required": false
      },
      {
        "name": "FinalSnapshotIdentifier",
        "jsonName": "finalSnapshotIdentifier",
        "protoField": "final_snapshot_identifier",
        "type": {
          "kind": "string"
        },
        "description": "final_snapshot_identifier is the identifier to use for the final snapshot when skip_final_snapshot is false.",
        "required": false
      },
      {
        "name": "IamDatabaseAuthenticationEnabled",
        "jsonName": "iamDatabaseAuthenticationEnabled",
        "protoField": "iam_database_authentication_enabled",
        "type": {
          "kind": "bool"
        },
        "description": "iam_database_authentication_enabled enables mapping of IAM users/roles to database logins.",
        "required": false
      },
      {
        "name": "EnableHttpEndpoint",
        "jsonName": "enableHttpEndpoint",
        "protoField": "enable_http_endpoint",
        "type": {
          "kind": "bool"
        },
        "description": "enable_http_endpoint enables the Data API for Aurora Serverless (where supported).",
        "required": false
      },
      {
        "name": "ServerlessV2Scaling",
        "jsonName": "serverlessV2Scaling",
        "protoField": "serverless_v2_scaling",
        "type": {
          "kind": "message",
          "messageType": "AwsRdsClusterServerlessV2ScalingConfiguration"
        },
        "description": "serverless_v2_scaling controls Aurora Serverless v2 capacity scaling (if supported by engine/engine_version).",
        "required": false
      },
      {
        "name": "SnapshotIdentifier",
        "jsonName": "snapshotIdentifier",
        "protoField": "snapshot_identifier",
        "type": {
          "kind": "string"
        },
        "description": "snapshot_identifier creates the cluster from the specified snapshot, when provided.",
        "required": false
      },
      {
        "name": "ReplicationSourceIdentifier",
        "jsonName": "replicationSourceIdentifier",
        "protoField": "replication_source_identifier",
        "type": {
          "kind": "string"
        },
        "description": "replication_source_identifier creates a read replica of another cluster when provided (ARN or identifier).",
        "required": false
      },
      {
        "name": "DbClusterParameterGroupName",
        "jsonName": "dbClusterParameterGroupName",
        "protoField": "db_cluster_parameter_group_name",
        "type": {
          "kind": "string"
        },
        "description": "db_cluster_parameter_group_name is the cluster-level parameter group to associate.",
        "required": false
      },
      {
        "name": "Parameters",
        "jsonName": "parameters",
        "protoField": "parameters",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "AwsRdsClusterParameter"
          }
        },
        "description": "cluster-level parameters to apply (depends on DB family).",
        "required": false
      },
      {
        "name": "VpcId",
        "jsonName": "vpcId",
        "protoField": "vpc_id",
        "type": {
          "kind": "string"
        },
        "description": "vpc_id for the cluster networking context (optional; generally derivable from subnet_ids/subnet group).",
        "required": false,
        "referenceKind": "AwsVpc",
        "referenceFieldPath": "status.outputs.vpc_id"
      },
      {
        "name": "EngineMode",
        "jsonName": "engineMode",
        "protoField": "engine_mode",
        "type": {
          "kind": "string"
        },
        "description": "Optional engine mode. For Aurora Serverless v1 use \"serverless\"; otherwise \"provisioned\".",
        "required": false
      },
      {
        "name": "StorageType",
        "jsonName": "storageType",
        "protoField": "storage_type",
        "type": {
          "kind": "string"
        },
        "description": "storage_type for Aurora (if supported): \"aurora\" or \"aurora-iopt1\".",
        "required": false,
        "validation": {
          "enum": [
            "aurora",
            "aurora-iopt1"
          ]
        }
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "AwsRdsClusterParameter",
      "description": "AwsRdsClusterParameter represents a cluster parameter to apply via the DB cluster parameter group.",
      "protoType": "org.openmcf.provider.aws.awsrdscluster.v1.AwsRdsClusterParameter",
      "fields": [
        {
          "name": "ApplyMethod",
          "jsonName": "applyMethod",
          "protoField": "apply_method",
          "type": {
            "kind": "string"
          },
          "description": "apply_method is either \"immediate\" (default) or \"pending-reboot\".",
          "required": false
        },
        {
          "name": "Name",
          "jsonName": "name",
          "protoField": "name",
          "type": {
            "kind": "string"
          },
          "description": "name of the parameter.",
          "required": false
        },
        {
          "name": "Value",
          "jsonName": "value",
          "protoField": "value",
          "type": {
            "kind": "string"
          },
          "description": "value of the parameter.",
          "required": false
        }
      ]
    },
    {
      "name": "AwsRdsClusterServerlessV2ScalingConfiguration",
      "description": "AwsRdsClusterServerlessV2ScalingConfiguration configures Aurora Serverless v2 capacity scaling.",
      "protoType": "org.openmcf.provider.aws.awsrdscluster.v1.AwsRdsClusterServerlessV2ScalingConfiguration",
      "fields": [
        {
          "name": "MinCapacity",
          "jsonName": "minCapacity",
          "protoField": "min_capacity",
          "type": {
            "kind": "double"
          },
          "description": "min_capacity is the minimum ACU.",
          "required": false
        },
        {
          "name": "MaxCapacity",
          "jsonName": "maxCapacity",
          "protoField": "max_capacity",
          "type": {
            "kind": "double"
          },
          "description": "max_capacity is the maximum ACU.",
          "required": false
        }
      ]
    }
  ]
}
