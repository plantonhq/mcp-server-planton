{
  "name": "AwsClientVpn",
  "kind": "AwsClientVpn",
  "cloudProvider": "aws",
  "apiVersion": "aws.openmcf.org/v1",
  "description": "AwsClientVpn represents an AWS Client VPN endpoint resource.\n It encapsulates the configuration for a managed OpenVPN endpoint attached to a VPC.",
  "protoPackage": "org.openmcf.provider.aws.awsclientvpn.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/aws/awsclientvpn/v1/api.proto",
    "spec": "org/openmcf/provider/aws/awsclientvpn/v1/spec.proto"
  },
  "spec": {
    "name": "AwsClientVpnSpec",
    "fields": [
      {
        "name": "Region",
        "jsonName": "region",
        "protoField": "region",
        "type": {
          "kind": "string"
        },
        "description": "The AWS region where the Client VPN endpoint will be created.\n Example: \"us-west-2\", \"eu-west-1\"",
        "required": false,
        "validation": {
          "minLength": 1
        }
      },
      {
        "name": "Description",
        "jsonName": "description",
        "protoField": "description",
        "type": {
          "kind": "string"
        },
        "description": "(Optional) A human-friendly description for the Client VPN endpoint. This is stored for clarity and is typically visible in the AWS Console as the description of the endpoint.",
        "required": false
      },
      {
        "name": "VpcId",
        "jsonName": "vpcId",
        "protoField": "vpc_id",
        "type": {
          "kind": "string"
        },
        "description": "The target AWS VPC in which to create the Client VPN endpoint. This should reference\n an existing AwsVpc resource. The Client VPN will be attached to this VPC's network.\n **Must** be a VPC in the same AWS region as the provided credentials.",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "AwsVpc",
        "referenceFieldPath": "status.outputs.vpc_id"
      },
      {
        "name": "Subnets",
        "jsonName": "subnets",
        "protoField": "subnets",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "The list of subnet IDs in the above VPC to associate as target networks for the Client VPN.\n Each subnet association enables VPN clients to access resources in that subnet’s Availability Zone.\n At least one subnet ID is required (the first association will activate the endpoint). All subnets must belong to the given VPC.",
        "required": true,
        "validation": {
          "required": true,
          "minItems": 1
        },
        "referenceKind": "AwsVpc"
      },
      {
        "name": "ClientCidrBlock",
        "jsonName": "clientCidrBlock",
        "protoField": "client_cidr_block",
        "type": {
          "kind": "string"
        },
        "description": "The IPv4 address range, in CIDR notation, from which to assign client IP addresses. For example, \"10.0.0.0/22\".\n This client CIDR block must not overlap with the VPC’s CIDR or any routes in the VPC.\n It defines the pool of IPs that VPN clients will receive. Note: The CIDR block size must be between /22 (inclusive) and /12 (inclusive).",
        "required": true,
        "validation": {
          "required": true,
          "pattern": "^([0-9]{1,3}\\.){3}[0-9]{1,3}/([0-9]|[1-2][0-9]|3[0-2])$"
        }
      },
      {
        "name": "AuthenticationType",
        "jsonName": "authenticationType",
        "protoField": "authentication_type",
        "type": {
          "kind": "enum",
          "enumType": "org.openmcf.provider.aws.awsclientvpn.v1.AwsClientVpnAuthenticationType",
          "enumValues": [
            "directory",
            "cognito"
          ]
        },
        "description": "The authentication method for clients connecting to this VPN endpoint.\n defaults to `certificate` (mutual TLS authentication using client certificates).",
        "required": false
      },
      {
        "name": "ServerCertificateArn",
        "jsonName": "serverCertificateArn",
        "protoField": "server_certificate_arn",
        "type": {
          "kind": "string"
        },
        "description": "The ARN of the ACM server certificate to use for the Client VPN endpoint. This TLS certificate is presented by the VPN server to clients upon connection.\n The certificate must be present in AWS Certificate Manager in the same region. This field is **required** for establishing the VPN (mutual TLS requires a server cert, and user-based auth still needs a server certificate for encryption).",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "AwsCertManagerCert",
        "referenceFieldPath": "status.outputs.cert_arn"
      },
      {
        "name": "CidrAuthorizationRules",
        "jsonName": "cidrAuthorizationRules",
        "protoField": "cidr_authorization_rules",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "A list of IPv4 network CIDR ranges that VPN clients are authorized to access through this endpoint.\n Typically, these correspond to private subnet ranges within the VPC (e.g., \"10.0.0.0/16\") or other networks.\n For each CIDR here, an authorization rule will be created to allow clients to access that network.\n If omitted, no default authorization rule is set (clients would not have access to any network until one is added).",
        "required": false,
        "validation": {
          "unique": true
        }
      },
      {
        "name": "DisableSplitTunnel",
        "jsonName": "disableSplitTunnel",
        "protoField": "disable_split_tunnel",
        "type": {
          "kind": "bool"
        },
        "description": "Enables or disables split-tunnel routing for the VPN. When `false`, only traffic destined for the above authorized CIDRs (internal networks) will go through the VPN, while all other Internet traffic stays local to the client.\n When `true` (full-tunnel), all client traffic is routed through the VPN. Default is `false` (split-tunnel enabled) to limit VPN to internal traffic.",
        "required": false
      },
      {
        "name": "VpnPort",
        "jsonName": "vpnPort",
        "protoField": "vpn_port",
        "type": {
          "kind": "int32"
        },
        "description": "The port number on which the Client VPN endpoint will accept connections. The default (443) is commonly used for OpenVPN over TLS.\n Using port 443 allows VPN traffic to more easily traverse corporate firewalls.\n If a different port (e.g., 1194) is needed, it can be specified here.",
        "required": false,
        "default": "443",
        "oneofGroup": "_vpn_port"
      },
      {
        "name": "TransportProtocol",
        "jsonName": "transportProtocol",
        "protoField": "transport_protocol",
        "type": {
          "kind": "enum",
          "enumType": "org.openmcf.provider.aws.awsclientvpn.v1.AwsClientVpnTransportProtocol",
          "enumValues": [
            "udp",
            "tcp"
          ]
        },
        "description": "The transport protocol for VPN connections. Can be `tcp` or `udp`.",
        "required": false,
        "recommendedDefault": "tcp"
      },
      {
        "name": "LogGroupName",
        "jsonName": "logGroupName",
        "protoField": "log_group_name",
        "type": {
          "kind": "string"
        },
        "description": "The CloudWatch Logs group name for VPN connection logs. If specified, connection logging is enabled for this Client VPN endpoint.\n The VPN service will send connection events to the given log group (a log stream is created automatically if not provided).\n If left blank, connection logging is disabled.",
        "required": false
      },
      {
        "name": "SecurityGroups",
        "jsonName": "securityGroups",
        "protoField": "security_groups",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "(Optional) One or more security group IDs to apply to the Client VPN endpoint's network associations.\n These security groups control traffic between VPN clients and VPC resources.\n If not provided, the VPC’s default security group will be applied to the Client VPN endpoint.\n If provided, ensure the security group rules allow the intended traffic (for example, allowing inbound traffic from clients to target services).\n By default, OpenMCF may create a dedicated security group for the endpoint if none are specified.",
        "required": false,
        "referenceKind": "AwsSecurityGroup",
        "referenceFieldPath": "status.outputs.security_group_id"
      },
      {
        "name": "DnsServers",
        "jsonName": "dnsServers",
        "protoField": "dns_servers",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "string"
          }
        },
        "description": "(Optional) Custom DNS server IP addresses for VPN clients. Up to two IP addresses can be specified.\n If set, connected clients will use these DNS servers for name resolution while connected. If not set, clients default to the VPC’s DNS (AmazonProvidedDNS) for name resolution.",
        "required": false,
        "validation": {
          "maxItems": 2,
          "unique": true
        }
      }
    ]
  }
}
