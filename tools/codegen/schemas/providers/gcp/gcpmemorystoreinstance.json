{
  "name": "GcpMemorystoreInstance",
  "kind": "GcpMemorystoreInstance",
  "cloudProvider": "gcp",
  "apiVersion": "gcp.openmcf.org/v1",
  "description": "gcp-memorystore-instance",
  "protoPackage": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1",
  "protoFiles": {
    "api": "org/openmcf/provider/gcp/gcpmemorystoreinstance/v1/api.proto",
    "spec": "org/openmcf/provider/gcp/gcpmemorystoreinstance/v1/spec.proto"
  },
  "spec": {
    "name": "GcpMemorystoreInstanceSpec",
    "fields": [
      {
        "name": "ProjectId",
        "jsonName": "projectId",
        "protoField": "project_id",
        "type": {
          "kind": "string"
        },
        "description": "GCP project where the Memorystore instance will be created.",
        "required": true,
        "validation": {
          "required": true
        },
        "referenceKind": "GcpProject",
        "referenceFieldPath": "status.outputs.project_id"
      },
      {
        "name": "InstanceName",
        "jsonName": "instanceName",
        "protoField": "instance_name",
        "type": {
          "kind": "string"
        },
        "description": "Name of the Memorystore instance. This becomes the GCP resource name.\n Must start with a lowercase letter, contain only lowercase letters,\n numbers, and hyphens, and end with a lowercase letter or number.\n 4-63 characters. Immutable after creation.",
        "required": true,
        "validation": {
          "required": true,
          "minLength": 4,
          "maxLength": 63,
          "pattern": "^[a-z][a-z0-9-]{2,61}[a-z0-9]$"
        }
      },
      {
        "name": "Location",
        "jsonName": "location",
        "protoField": "location",
        "type": {
          "kind": "string"
        },
        "description": "GCP region where the instance will be deployed (e.g., \"us-central1\").\n Immutable after creation.",
        "required": true,
        "validation": {
          "required": true
        }
      },
      {
        "name": "ShardCount",
        "jsonName": "shardCount",
        "protoField": "shard_count",
        "type": {
          "kind": "int32"
        },
        "description": "Number of shards for the instance. Each shard handles a portion of\n the keyspace. Minimum 1 shard.\n\n For CLUSTER mode: multiple shards distribute data across nodes.\n For CLUSTER_DISABLED mode: typically 1 shard (single primary).",
        "required": true,
        "validation": {
          "required": true,
          "min": 1
        }
      },
      {
        "name": "Mode",
        "jsonName": "mode",
        "protoField": "mode",
        "type": {
          "kind": "string"
        },
        "description": "Instance mode controlling cluster topology.\n CLUSTER: sharded mode with native cluster protocol support.\n   Clients must use cluster-aware drivers.\n CLUSTER_DISABLED: standalone mode with a single primary endpoint.\n   Compatible with any Valkey/Redis client.\n Immutable after creation.",
        "required": false
      },
      {
        "name": "NodeType",
        "jsonName": "nodeType",
        "protoField": "node_type",
        "type": {
          "kind": "string"
        },
        "description": "Predefined node type determining CPU and memory per node.\n SHARED_CORE_NANO: shared-core, smallest (dev/test).\n STANDARD_SMALL: dedicated core, small workloads.\n HIGHMEM_MEDIUM: high memory, medium production workloads.\n HIGHMEM_XLARGE: high memory, large production workloads.\n If not specified, GCP selects a default.",
        "required": false
      },
      {
        "name": "EngineVersion",
        "jsonName": "engineVersion",
        "protoField": "engine_version",
        "type": {
          "kind": "string"
        },
        "description": "Engine version (e.g., \"VALKEY_8_0\", \"VALKEY_7_2\").\n If not specified, the latest supported version is used.",
        "required": false
      },
      {
        "name": "EngineConfigs",
        "jsonName": "engineConfigs",
        "protoField": "engine_configs",
        "type": {
          "kind": "map",
          "keyType": {
            "kind": "string"
          },
          "valueType": {
            "kind": "string"
          }
        },
        "description": "Engine configuration parameters as key-value pairs.\n See Valkey/Redis configuration reference for supported parameters\n (e.g., \"maxmemory-policy\", \"notify-keyspace-events\").",
        "required": false
      },
      {
        "name": "ReplicaCount",
        "jsonName": "replicaCount",
        "protoField": "replica_count",
        "type": {
          "kind": "int32"
        },
        "description": "Number of read replicas per shard (0-5). Default: 0 (no replicas).\n Replicas provide read scaling and automatic failover.",
        "required": false
      },
      {
        "name": "PscAutoConnections",
        "jsonName": "pscAutoConnections",
        "protoField": "psc_auto_connections",
        "type": {
          "kind": "array",
          "elementType": {
            "kind": "message",
            "messageType": "GcpMemorystoreInstancePscAutoConnection"
          }
        },
        "description": "Private Service Connect (PSC) endpoints for VPC connectivity.\n Each entry creates a PSC endpoint in the specified consumer VPC,\n allowing applications in that VPC to reach the instance.\n\n At least one PSC connection is recommended for the instance to be\n reachable. Multiple connections enable cross-project or multi-VPC access.\n Immutable after creation.",
        "required": false
      },
      {
        "name": "AuthorizationMode",
        "jsonName": "authorizationMode",
        "protoField": "authorization_mode",
        "type": {
          "kind": "string"
        },
        "description": "Authentication mode for client connections.\n AUTH_DISABLED: no authentication required (default).\n IAM_AUTH: clients authenticate using GCP IAM credentials.\n Immutable after creation.",
        "required": false
      },
      {
        "name": "TransitEncryptionMode",
        "jsonName": "transitEncryptionMode",
        "protoField": "transit_encryption_mode",
        "type": {
          "kind": "string"
        },
        "description": "TLS encryption mode for client-to-server traffic.\n TRANSIT_ENCRYPTION_DISABLED: no encryption (default).\n SERVER_AUTHENTICATION: clients verify the server's identity via TLS.\n Immutable after creation.",
        "required": false
      },
      {
        "name": "KmsKey",
        "jsonName": "kmsKey",
        "protoField": "kms_key",
        "type": {
          "kind": "string"
        },
        "description": "Cloud KMS key for customer-managed encryption at rest (CMEK).\n Format: projects/{project}/locations/{location}/keyRings/{keyRing}/cryptoKeys/{key}\n If not specified, data is encrypted with Google-managed keys.\n Immutable after creation.",
        "required": false,
        "referenceKind": "GcpKmsKey",
        "referenceFieldPath": "status.outputs.key_id"
      },
      {
        "name": "PersistenceConfig",
        "jsonName": "persistenceConfig",
        "protoField": "persistence_config",
        "type": {
          "kind": "message",
          "messageType": "GcpMemorystoreInstancePersistenceConfig"
        },
        "description": "Persistence configuration for data durability.\n Controls whether and how data is written to disk.",
        "required": false
      },
      {
        "name": "ZoneDistributionConfig",
        "jsonName": "zoneDistributionConfig",
        "protoField": "zone_distribution_config",
        "type": {
          "kind": "message",
          "messageType": "GcpMemorystoreInstanceZoneDistributionConfig"
        },
        "description": "Zone distribution configuration.\n Controls how nodes are spread across availability zones.\n Immutable after creation.",
        "required": false
      },
      {
        "name": "MaintenancePolicy",
        "jsonName": "maintenancePolicy",
        "protoField": "maintenance_policy",
        "type": {
          "kind": "message",
          "messageType": "GcpMemorystoreInstanceMaintenancePolicy"
        },
        "description": "Maintenance policy for scheduled maintenance windows.",
        "required": false
      },
      {
        "name": "AutomatedBackupConfig",
        "jsonName": "automatedBackupConfig",
        "protoField": "automated_backup_config",
        "type": {
          "kind": "message",
          "messageType": "GcpMemorystoreInstanceAutomatedBackupConfig"
        },
        "description": "Automated backup configuration.\n When configured, GCP takes daily backups at the specified hour\n and retains them for the specified duration.",
        "required": false
      },
      {
        "name": "DeletionProtectionEnabled",
        "jsonName": "deletionProtectionEnabled",
        "protoField": "deletion_protection_enabled",
        "type": {
          "kind": "bool"
        },
        "description": "Whether deletion protection is enabled. When true, the instance\n cannot be deleted without first disabling this flag.\n GCP defaults to true for new instances.",
        "required": false
      }
    ]
  },
  "nestedTypes": [
    {
      "name": "GcpMemorystoreInstanceAofConfig",
      "description": "GcpMemorystoreInstanceAofConfig controls Append-Only File persistence.\n AOF logs every write operation, providing stronger durability guarantees\n than RDB at the cost of higher I/O.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstanceAofConfig",
      "fields": [
        {
          "name": "AppendFsync",
          "jsonName": "appendFsync",
          "protoField": "append_fsync",
          "type": {
            "kind": "string"
          },
          "description": "How often the AOF buffer is flushed to disk.\n NEVER: OS decides (best performance, risk of data loss on crash).\n EVERY_SEC: flush once per second (good balance).\n ALWAYS: flush on every write (strongest durability, lowest performance).",
          "required": true,
          "validation": {
            "required": true,
            "enum": [
              "NEVER",
              "EVERY_SEC",
              "ALWAYS"
            ]
          }
        }
      ]
    },
    {
      "name": "GcpMemorystoreInstanceAutomatedBackupConfig",
      "description": "GcpMemorystoreInstanceAutomatedBackupConfig configures scheduled backups\n for the Memorystore instance. Backups are stored in a managed backup\n collection and can be used to restore data.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstanceAutomatedBackupConfig",
      "fields": [
        {
          "name": "StartHour",
          "jsonName": "startHour",
          "protoField": "start_hour",
          "type": {
            "kind": "int32"
          },
          "description": "Hour of day (0-23, UTC) when the daily backup starts.",
          "required": false,
          "validation": {
            "max": 23
          }
        },
        {
          "name": "Retention",
          "jsonName": "retention",
          "protoField": "retention",
          "type": {
            "kind": "string"
          },
          "description": "Backup retention duration in seconds.\n Minimum: 86400s (1 day). Maximum: 31536000s (365 days).\n Example: \"3024000s\" for 35 days.",
          "required": true,
          "validation": {
            "required": true,
            "pattern": "^[0-9]+s$"
          }
        }
      ]
    },
    {
      "name": "GcpMemorystoreInstanceMaintenancePolicy",
      "description": "GcpMemorystoreInstanceMaintenancePolicy defines the maintenance schedule\n for the Memorystore instance.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstanceMaintenancePolicy",
      "fields": [
        {
          "name": "WeeklyMaintenanceWindow",
          "jsonName": "weeklyMaintenanceWindow",
          "protoField": "weekly_maintenance_window",
          "type": {
            "kind": "message",
            "messageType": "GcpMemorystoreInstanceMaintenanceWindow"
          },
          "description": "Weekly maintenance window schedule.",
          "required": true,
          "validation": {
            "required": true
          }
        }
      ]
    },
    {
      "name": "GcpMemorystoreInstanceMaintenanceWindow",
      "description": "GcpMemorystoreInstanceMaintenanceWindow defines when GCP may perform\n maintenance on the instance. The window is fixed at 1 hour duration.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstanceMaintenanceWindow",
      "fields": [
        {
          "name": "Day",
          "jsonName": "day",
          "protoField": "day",
          "type": {
            "kind": "string"
          },
          "description": "Day of the week for the maintenance window.",
          "required": true,
          "validation": {
            "required": true,
            "enum": [
              "MONDAY",
              "TUESDAY",
              "WEDNESDAY",
              "THURSDAY",
              "FRIDAY",
              "SATURDAY",
              "SUNDAY"
            ]
          }
        },
        {
          "name": "Hour",
          "jsonName": "hour",
          "protoField": "hour",
          "type": {
            "kind": "int32"
          },
          "description": "Hour of day (0-23, UTC) when the maintenance window starts.",
          "required": false,
          "validation": {
            "max": 23
          }
        }
      ]
    },
    {
      "name": "GcpMemorystoreInstancePersistenceConfig",
      "description": "GcpMemorystoreInstancePersistenceConfig controls data persistence for\n the Memorystore instance. Persistence ensures data survives restarts\n and failovers.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstancePersistenceConfig",
      "fields": [
        {
          "name": "Mode",
          "jsonName": "mode",
          "protoField": "mode",
          "type": {
            "kind": "string"
          },
          "description": "Persistence mode.\n DISABLED: no persistence, data is in-memory only.\n RDB: periodic point-in-time snapshots.\n AOF: append-only file logging every write.",
          "required": true,
          "validation": {
            "required": true,
            "enum": [
              "DISABLED",
              "RDB",
              "AOF"
            ]
          }
        },
        {
          "name": "RdbConfig",
          "jsonName": "rdbConfig",
          "protoField": "rdb_config",
          "type": {
            "kind": "message",
            "messageType": "GcpMemorystoreInstanceRdbConfig"
          },
          "description": "RDB snapshot configuration. Required when mode is RDB.",
          "required": false
        },
        {
          "name": "AofConfig",
          "jsonName": "aofConfig",
          "protoField": "aof_config",
          "type": {
            "kind": "message",
            "messageType": "GcpMemorystoreInstanceAofConfig"
          },
          "description": "AOF configuration. Required when mode is AOF.",
          "required": false
        }
      ]
    },
    {
      "name": "GcpMemorystoreInstancePscAutoConnection",
      "description": "GcpMemorystoreInstancePscAutoConnection defines a Private Service Connect\n auto-created endpoint that connects the Memorystore instance to a consumer\n VPC network. GCP creates and manages the PSC forwarding rules automatically.\n\n At least one PSC connection is needed for applications to reach the instance.\n Multiple connections can be defined for cross-project or multi-VPC access.\n PSC connections are immutable after instance creation.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstancePscAutoConnection",
      "fields": [
        {
          "name": "Network",
          "jsonName": "network",
          "protoField": "network",
          "type": {
            "kind": "string"
          },
          "description": "Consumer VPC network where the PSC endpoint will be created.\n Format: projects/{project_id}/global/networks/{network_id}",
          "required": true,
          "validation": {
            "required": true
          },
          "referenceKind": "GcpVpc",
          "referenceFieldPath": "status.outputs.network_self_link"
        },
        {
          "name": "ProjectId",
          "jsonName": "projectId",
          "protoField": "project_id",
          "type": {
            "kind": "string"
          },
          "description": "Consumer project ID where the PSC endpoint will be created.\n Usually the same project as the Memorystore instance, but can differ\n for cross-project connectivity.",
          "required": true,
          "validation": {
            "required": true
          },
          "referenceKind": "GcpProject",
          "referenceFieldPath": "status.outputs.project_id"
        }
      ]
    },
    {
      "name": "GcpMemorystoreInstanceRdbConfig",
      "description": "GcpMemorystoreInstanceRdbConfig controls RDB snapshot persistence.\n RDB creates point-in-time snapshots at a configurable interval.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstanceRdbConfig",
      "fields": [
        {
          "name": "RdbSnapshotPeriod",
          "jsonName": "rdbSnapshotPeriod",
          "protoField": "rdb_snapshot_period",
          "type": {
            "kind": "string"
          },
          "description": "How often RDB snapshots are taken.",
          "required": true,
          "validation": {
            "required": true,
            "enum": [
              "ONE_HOUR",
              "SIX_HOURS",
              "TWELVE_HOURS",
              "TWENTY_FOUR_HOURS"
            ]
          }
        },
        {
          "name": "RdbSnapshotStartTime",
          "jsonName": "rdbSnapshotStartTime",
          "protoField": "rdb_snapshot_start_time",
          "type": {
            "kind": "string"
          },
          "description": "Optional RFC3339 timestamp for when to start the first snapshot.\n If not specified, GCP picks an appropriate time.",
          "required": false
        }
      ]
    },
    {
      "name": "GcpMemorystoreInstanceZoneDistributionConfig",
      "description": "GcpMemorystoreInstanceZoneDistributionConfig controls how the instance\n is distributed across availability zones within the region.",
      "protoType": "org.openmcf.provider.gcp.gcpmemorystoreinstance.v1.GcpMemorystoreInstanceZoneDistributionConfig",
      "fields": [
        {
          "name": "Mode",
          "jsonName": "mode",
          "protoField": "mode",
          "type": {
            "kind": "string"
          },
          "description": "Zone distribution mode.\n MULTI_ZONE: nodes spread across multiple zones for high availability (default).\n SINGLE_ZONE: all nodes in a single zone for lowest latency.",
          "required": true,
          "validation": {
            "required": true,
            "enum": [
              "MULTI_ZONE",
              "SINGLE_ZONE"
            ]
          }
        },
        {
          "name": "Zone",
          "jsonName": "zone",
          "protoField": "zone",
          "type": {
            "kind": "string"
          },
          "description": "Zone for SINGLE_ZONE mode (e.g., \"us-central1-a\").\n Required when mode is SINGLE_ZONE. Ignored for MULTI_ZONE.",
          "required": false
        }
      ]
    }
  ]
}
