// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T22:24:53+05:30

package hetznercloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// hetznercloud-placement-group
type HetznerCloudPlacementGroupSpecInput struct {
	// Placement group strategy type.
	//
	//  Hetzner Cloud currently supports only "spread", which distributes
	//  servers across different physical hosts for fault tolerance.
	//
	//  Default: spread
	Type string `json:"type,omitempty" jsonschema:"enum=spread,Placement group strategy type. Hetzner Cloud currently supports only 'spread'; which distributes servers across different physical hosts for fault tolerance. Default: spread"`
}

func (s *HetznerCloudPlacementGroupSpecInput) validate() error {
	switch s.Type {
	case "", "spread":
	default:
		return fmt.Errorf("invalid type: %q", s.Type)
	}
	return nil
}

func (s *HetznerCloudPlacementGroupSpecInput) applyDefaults() {
	if s.Type == "" {
		s.Type = "spread"
	}
}

func (s *HetznerCloudPlacementGroupSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Type != "" {
		m["type"] = s.Type
	}
	return m
}

// ParseHetznerCloudPlacementGroup validates and normalizes a HetznerCloudPlacementGroup cloud_object.
func ParseHetznerCloudPlacementGroup(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "hetzner-cloud.openmcf.org/v1", "HetznerCloudPlacementGroup"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec HetznerCloudPlacementGroupSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
