// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T22:24:53+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-vswitch
type AliCloudVswitchSpecInput struct {
	// Alibaba Cloud region where the VSwitch will be created.
	//  Must match the region of the parent VPC.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region where the VSwitch will be created. Must match the region of the parent VPC. Examples: 'cn-hangzhou'; 'cn-shanghai'; 'us-west-1'; 'ap-southeast-1'."`
	// VPC ID that this VSwitch belongs to.
	//  The VSwitch's CIDR block must fall within the VPC's CIDR range.
	VpcId string `json:"vpc_id" jsonschema:"required,VPC ID that this VSwitch belongs to. The VSwitch's CIDR block must fall within the VPC's CIDR range."`
	// Availability zone for the VSwitch.
	//  Format: "{region}-{letter}" (e.g., "cn-hangzhou-a", "cn-hangzhou-b").
	//  The zone must exist in the VSwitch's region. All resources deployed into
	//  this VSwitch run in this zone.
	ZoneId string `json:"zone_id" jsonschema:"required,Availability zone for the VSwitch. Format: '{region}-{letter}' (e.g.; 'cn-hangzhou-a'; 'cn-hangzhou-b'). The zone must exist in the VSwitch's region. All resources deployed into this VSwitch run in th..."`
	// IPv4 CIDR block for the VSwitch.
	//  Must be a subnet of the parent VPC's CIDR block.
	//  Mask length: 16-29 (e.g., "10.0.0.0/24" gives 256 addresses).
	//  This field is immutable after creation.
	CidrBlock string `json:"cidr_block" jsonschema:"required,IPv4 CIDR block for the VSwitch. Must be a subnet of the parent VPC's CIDR block. Mask length: 16-29 (e.g.; '10.0.0.0/24' gives 256 addresses). This field is immutable after creation."`
	// VSwitch name. 1-128 characters; cannot start with http:// or https://.
	//  Maps to the provider field `vswitch_name`.
	VswitchName string `json:"vswitch_name" jsonschema:"required,VSwitch name. 1-128 characters; cannot start with http:// or https://. Maps to the provider field 'vswitch_name'."`
	// Human-readable description of the VSwitch.
	//  1-256 characters; cannot start with http:// or https://.
	Description string `json:"description,omitempty" jsonschema:"Human-readable description of the VSwitch. 1-256 characters; cannot start with http:// or https://."`
	// Enable IPv6 for this VSwitch.
	//  The parent VPC must have IPv6 enabled (enable_ipv6 = true) for this
	//  to take effect. When enabled, an IPv6 CIDR block is allocated to the
	//  VSwitch based on ipv6_cidr_block_mask.
	//  Default: false
	EnableIpv6 bool `json:"enable_ipv6,omitempty" jsonschema:"Enable IPv6 for this VSwitch. The parent VPC must have IPv6 enabled (enable_ipv6 = true) for this to take effect. When enabled; an IPv6 CIDR block is allocated to the VSwitch based on ipv6_cidr_block_..."`
	// IPv6 CIDR block mask for the VSwitch.
	//  Only meaningful when enable_ipv6 is true and the parent VPC has IPv6
	//  enabled. Valid range: 0-255. The mask selects a /64 segment from the
	//  VPC's /56 IPv6 allocation.
	Ipv6CidrBlockMask int32 `json:"ipv6_cidr_block_mask,omitempty" jsonschema:"IPv6 CIDR block mask for the VSwitch. Only meaningful when enable_ipv6 is true and the parent VPC has IPv6 enabled. Valid range: 0-255. The mask selects a /64 segment from the VPC's /56 IPv6 allocatio..."`
	// Tags to apply to the VSwitch.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Tags to apply to the VSwitch."`
}

func (s *AliCloudVswitchSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.VpcId == "" {
		return fmt.Errorf("vpc_id is required")
	}
	if s.ZoneId == "" {
		return fmt.Errorf("zone_id is required")
	}
	if s.CidrBlock == "" {
		return fmt.Errorf("cidr_block is required")
	}
	if s.VswitchName == "" {
		return fmt.Errorf("vswitch_name is required")
	}
	return nil
}

func (s *AliCloudVswitchSpecInput) applyDefaults() {
}

func (s *AliCloudVswitchSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["vpc_id"] = s.VpcId
	m["zone_id"] = s.ZoneId
	m["cidr_block"] = s.CidrBlock
	m["vswitch_name"] = s.VswitchName
	if s.Description != "" {
		m["description"] = s.Description
	}
	if s.EnableIpv6 {
		m["enable_ipv6"] = s.EnableIpv6
	}
	if s.Ipv6CidrBlockMask != 0 {
		m["ipv6_cidr_block_mask"] = s.Ipv6CidrBlockMask
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	return m
}

// ParseAliCloudVswitch validates and normalizes a AliCloudVswitch cloud_object.
func ParseAliCloudVswitch(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudVswitch"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudVswitchSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
