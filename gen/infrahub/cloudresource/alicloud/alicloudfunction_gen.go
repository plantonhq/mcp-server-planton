// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T22:24:53+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-function
type AliCloudFunctionSpecInput struct {
	// Alibaba Cloud region where the function will be created.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region where the function will be created. Examples: 'cn-hangzhou'; 'cn-shanghai'; 'us-west-1'; 'ap-southeast-1'."`
	// Function name. Must be unique within the region and account.
	//  This field is immutable after creation (ForceNew in the provider).
	//  1-128 characters, starting with a letter or underscore.
	FunctionName string `json:"function_name" jsonschema:"required,Function name. Must be unique within the region and account. This field is immutable after creation (ForceNew in the provider). 1-128 characters; starting with a letter or underscore."`
	// Entry point for function invocation.
	//  Format depends on runtime: "index.handler" (Node.js/Python),
	//  "com.example.Main::handleRequest" (Java), "main" (Go).
	//  Required for all runtimes including custom-container (provider enforces it).
	Handler string `json:"handler" jsonschema:"required,Entry point for function invocation. Format depends on runtime: 'index.handler' (Node.js/Python); 'com.example.Main::handleRequest' (Java); 'main' (Go). Required for all runtimes including custom-cont..."`
	// Runtime environment for the function code.
	Runtime string `json:"runtime" jsonschema:"required,Runtime environment for the function code."`
	// Human-readable description of the function's purpose.
	Description string `json:"description,omitempty" jsonschema:"Human-readable description of the function's purpose."`
	// vCPU allocation for each function instance. Range: 0.05-16.
	//  Provider computes a default based on memory_size when omitted.
	Cpu float64 `json:"cpu,omitempty" jsonschema:"vCPU allocation for each function instance. Range: 0.05-16. Provider computes a default based on memory_size when omitted."`
	// Memory allocation in MB for each function instance. Range: 64-32768.
	//  Provider computes a default when omitted.
	MemorySize int32 `json:"memory_size,omitempty" jsonschema:"Memory allocation in MB for each function instance. Range: 64-32768. Provider computes a default when omitted."`
	// Maximum execution time in seconds before the function is terminated.
	//  Range: 1-86400 (24 hours).
	Timeout int32 `json:"timeout,omitempty" jsonschema:"Maximum execution time in seconds before the function is terminated. Range: 1-86400 (24 hours)."`
	// Temporary disk size in MB available to the function instance.
	//  Minimum: 512 MB. Provider computes a default when omitted.
	DiskSize int32 `json:"disk_size,omitempty" jsonschema:"Temporary disk size in MB available to the function instance. Minimum: 512 MB. Provider computes a default when omitted."`
	// Maximum number of concurrent requests a single instance can handle.
	//  Range: 1-200. Higher values improve throughput but require the function
	//  code to be safe for concurrent execution.
	InstanceConcurrency int32 `json:"instance_concurrency,omitempty" jsonschema:"Maximum number of concurrent requests a single instance can handle. Range: 1-200. Higher values improve throughput but require the function code to be safe for concurrent execution."`
	// Code package for the function. Not required when runtime is
	//  "custom-container" (the container image is specified in
	//  custom_container_config instead).
	Code *AliCloudFunctionCodeInput `json:"code,omitempty" jsonschema:"Code package for the function. Not required when runtime is 'custom-container' (the container image is specified in custom_container_config instead)."`
	// RAM role ARN that the function assumes during execution.
	//  The role must trust the FC service principal (fc.aliyuncs.com).
	Role string `json:"role,omitempty" jsonschema:"RAM role ARN that the function assumes during execution. The role must trust the FC service principal (fc.aliyuncs.com)."`
	// Whether the function can access the public internet.
	//  When false, outbound internet access is blocked even if the function
	//  is not in a VPC.
	InternetAccess bool `json:"internet_access,omitempty" jsonschema:"Whether the function can access the public internet. When false; outbound internet access is blocked even if the function is not in a VPC."`
	// VPC configuration for functions that need to access VPC-internal
	//  resources (databases, caches, NAS). When set, the function runs inside
	//  the specified VPC and can reach private endpoints.
	VpcConfig *AliCloudFunctionVpcConfigInput `json:"vpc_config,omitempty" jsonschema:"VPC configuration for functions that need to access VPC-internal resources (databases; caches; NAS). When set; the function runs inside the specified VPC and can reach private endpoints."`
	// Log Service (SLS) configuration for function invocation logs.
	LogConfig *AliCloudFunctionLogConfigInput `json:"log_config,omitempty" jsonschema:"Log Service (SLS) configuration for function invocation logs."`
	// Configuration for custom container runtimes (runtime="custom-container").
	//  Specifies the container image, entrypoint, and health check.
	CustomContainerConfig *AliCloudFunctionCustomContainerConfigInput `json:"custom_container_config,omitempty" jsonschema:"Configuration for custom container runtimes (runtime='custom-container'). Specifies the container image; entrypoint; and health check."`
	// Configuration for custom runtimes (runtime="custom.*").
	//  Specifies the bootstrap command, arguments, listening port, and health check.
	CustomRuntimeConfig *AliCloudFunctionCustomRuntimeConfigInput `json:"custom_runtime_config,omitempty" jsonschema:"Configuration for custom runtimes (runtime='custom.*'). Specifies the bootstrap command; arguments; listening port; and health check."`
	// Lifecycle hooks for function instances. The initializer runs once when
	//  an instance is created (warm-up logic), and pre_stop runs before an
	//  instance is reclaimed (cleanup logic).
	InstanceLifecycleConfig *AliCloudFunctionInstanceLifecycleConfigInput `json:"instance_lifecycle_config,omitempty" jsonschema:"Lifecycle hooks for function instances. The initializer runs once when an instance is created (warm-up logic); and pre_stop runs before an instance is reclaimed (cleanup logic)."`
	// NAS file system mount configuration. Requires vpc_config to be set
	//  (NAS mount targets are VPC-internal).
	NasConfig *AliCloudFunctionNasConfigInput `json:"nas_config,omitempty" jsonschema:"NAS file system mount configuration. Requires vpc_config to be set (NAS mount targets are VPC-internal)."`
	// GPU configuration for AI/ML inference workloads.
	GpuConfig *AliCloudFunctionGpuConfigInput `json:"gpu_config,omitempty" jsonschema:"GPU configuration for AI/ML inference workloads."`
	// Layer ARNs to attach to the function. Layers provide shared libraries
	//  and dependencies without bundling them in the function code package.
	//  Maximum: 5 layers.
	Layers []string `json:"layers,omitempty" jsonschema:"Layer ARNs to attach to the function. Layers provide shared libraries and dependencies without bundling them in the function code package. Maximum: 5 layers."`
	// Environment variables passed to the function at runtime.
	EnvironmentVariables map[string]string `json:"environment_variables,omitempty" jsonschema:"Environment variables passed to the function at runtime."`
	// Tags to apply to the function resource.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Tags to apply to the function resource."`
	// Alibaba Cloud resource group ID for organizational grouping (per DD05).
	ResourceGroupId string `json:"resource_group_id,omitempty" jsonschema:"Alibaba Cloud resource group ID for organizational grouping (per DD05)."`
}

func (s *AliCloudFunctionSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.FunctionName == "" {
		return fmt.Errorf("function_name is required")
	}
	if s.Handler == "" {
		return fmt.Errorf("handler is required")
	}
	if s.Runtime == "" {
		return fmt.Errorf("runtime is required")
	}
	if s.Code != nil {
		if err := s.Code.validate(); err != nil {
			return fmt.Errorf("code: %w", err)
		}
	}
	if s.VpcConfig != nil {
		if err := s.VpcConfig.validate(); err != nil {
			return fmt.Errorf("vpc_config: %w", err)
		}
	}
	if s.LogConfig != nil {
		if err := s.LogConfig.validate(); err != nil {
			return fmt.Errorf("log_config: %w", err)
		}
	}
	if s.CustomContainerConfig != nil {
		if err := s.CustomContainerConfig.validate(); err != nil {
			return fmt.Errorf("custom_container_config: %w", err)
		}
	}
	if s.CustomRuntimeConfig != nil {
		if err := s.CustomRuntimeConfig.validate(); err != nil {
			return fmt.Errorf("custom_runtime_config: %w", err)
		}
	}
	if s.InstanceLifecycleConfig != nil {
		if err := s.InstanceLifecycleConfig.validate(); err != nil {
			return fmt.Errorf("instance_lifecycle_config: %w", err)
		}
	}
	if s.NasConfig != nil {
		if err := s.NasConfig.validate(); err != nil {
			return fmt.Errorf("nas_config: %w", err)
		}
	}
	if s.GpuConfig != nil {
		if err := s.GpuConfig.validate(); err != nil {
			return fmt.Errorf("gpu_config: %w", err)
		}
	}
	return nil
}

func (s *AliCloudFunctionSpecInput) applyDefaults() {
	if s.Code != nil {
		s.Code.applyDefaults()
	}
	if s.VpcConfig != nil {
		s.VpcConfig.applyDefaults()
	}
	if s.LogConfig != nil {
		s.LogConfig.applyDefaults()
	}
	if s.CustomContainerConfig != nil {
		s.CustomContainerConfig.applyDefaults()
	}
	if s.CustomRuntimeConfig != nil {
		s.CustomRuntimeConfig.applyDefaults()
	}
	if s.InstanceLifecycleConfig != nil {
		s.InstanceLifecycleConfig.applyDefaults()
	}
	if s.NasConfig != nil {
		s.NasConfig.applyDefaults()
	}
	if s.GpuConfig != nil {
		s.GpuConfig.applyDefaults()
	}
}

func (s *AliCloudFunctionSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["function_name"] = s.FunctionName
	m["handler"] = s.Handler
	m["runtime"] = s.Runtime
	if s.Description != "" {
		m["description"] = s.Description
	}
	if s.Cpu != 0 {
		m["cpu"] = s.Cpu
	}
	if s.MemorySize != 0 {
		m["memory_size"] = s.MemorySize
	}
	if s.Timeout != 0 {
		m["timeout"] = s.Timeout
	}
	if s.DiskSize != 0 {
		m["disk_size"] = s.DiskSize
	}
	if s.InstanceConcurrency != 0 {
		m["instance_concurrency"] = s.InstanceConcurrency
	}
	if s.Code != nil {
		m["code"] = s.Code.toMap()
	}
	if s.Role != "" {
		m["role"] = s.Role
	}
	if s.InternetAccess {
		m["internet_access"] = s.InternetAccess
	}
	if s.VpcConfig != nil {
		m["vpc_config"] = s.VpcConfig.toMap()
	}
	if s.LogConfig != nil {
		m["log_config"] = s.LogConfig.toMap()
	}
	if s.CustomContainerConfig != nil {
		m["custom_container_config"] = s.CustomContainerConfig.toMap()
	}
	if s.CustomRuntimeConfig != nil {
		m["custom_runtime_config"] = s.CustomRuntimeConfig.toMap()
	}
	if s.InstanceLifecycleConfig != nil {
		m["instance_lifecycle_config"] = s.InstanceLifecycleConfig.toMap()
	}
	if s.NasConfig != nil {
		m["nas_config"] = s.NasConfig.toMap()
	}
	if s.GpuConfig != nil {
		m["gpu_config"] = s.GpuConfig.toMap()
	}
	if len(s.Layers) > 0 {
		m["layers"] = s.Layers
	}
	if len(s.EnvironmentVariables) > 0 {
		m["environment_variables"] = s.EnvironmentVariables
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	if s.ResourceGroupId != "" {
		m["resource_group_id"] = s.ResourceGroupId
	}
	return m
}

// AliCloudFunctionCode defines the code package for a function.
type AliCloudFunctionCodeInput struct {
	// OSS bucket name where the function code ZIP package is stored.
	OssBucketName string `json:"oss_bucket_name,omitempty" jsonschema:"OSS bucket name where the function code ZIP package is stored."`
	// OSS object key for the function code ZIP package.
	OssObjectName string `json:"oss_object_name,omitempty" jsonschema:"OSS object key for the function code ZIP package."`
	// Base64-encoded function code ZIP package. Convenient for small functions
	//  or testing. Mutually exclusive with oss_bucket_name/oss_object_name in
	//  practice (the provider accepts both but only one source is meaningful).
	ZipFile string `json:"zip_file,omitempty" jsonschema:"Base64-encoded function code ZIP package. Convenient for small functions or testing. Mutually exclusive with oss_bucket_name/oss_object_name in practice (the provider accepts both but only one source ..."`
	// CRC-64 checksum of the code package for integrity verification.
	Checksum string `json:"checksum,omitempty" jsonschema:"CRC-64 checksum of the code package for integrity verification."`
}

func (s *AliCloudFunctionCodeInput) validate() error {
	return nil
}

func (s *AliCloudFunctionCodeInput) applyDefaults() {
}

func (s *AliCloudFunctionCodeInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.OssBucketName != "" {
		m["oss_bucket_name"] = s.OssBucketName
	}
	if s.OssObjectName != "" {
		m["oss_object_name"] = s.OssObjectName
	}
	if s.ZipFile != "" {
		m["zip_file"] = s.ZipFile
	}
	if s.Checksum != "" {
		m["checksum"] = s.Checksum
	}
	return m
}

// AliCloudFunctionCustomContainerConfig configures a custom container
//
//	runtime (runtime="custom-container").
type AliCloudFunctionCustomContainerConfigInput struct {
	// Container image URI. Required when this config is set.
	//  Example: "registry.cn-hangzhou.aliyuncs.com/my-ns/my-func:v1"
	Image string `json:"image,omitempty" jsonschema:"Container image URI. Required when this config is set. Example: 'registry.cn-hangzhou.aliyuncs.com/my-ns/my-func:v1'"`
	// Container entrypoint override (ENTRYPOINT in Dockerfile terms).
	Entrypoint []string `json:"entrypoint,omitempty" jsonschema:"Container entrypoint override (ENTRYPOINT in Dockerfile terms)."`
	// Container command override (CMD in Dockerfile terms).
	Command []string `json:"command,omitempty" jsonschema:"Container command override (CMD in Dockerfile terms)."`
	// Port the container listens on for HTTP requests.
	Port int32 `json:"port,omitempty" jsonschema:"Port the container listens on for HTTP requests."`
	// Health check configuration for the container.
	HealthCheckConfig *AliCloudFunctionHealthCheckConfigInput `json:"health_check_config,omitempty" jsonschema:"Health check configuration for the container."`
}

func (s *AliCloudFunctionCustomContainerConfigInput) validate() error {
	if s.HealthCheckConfig != nil {
		if err := s.HealthCheckConfig.validate(); err != nil {
			return fmt.Errorf("health_check_config: %w", err)
		}
	}
	return nil
}

func (s *AliCloudFunctionCustomContainerConfigInput) applyDefaults() {
	if s.HealthCheckConfig != nil {
		s.HealthCheckConfig.applyDefaults()
	}
}

func (s *AliCloudFunctionCustomContainerConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Image != "" {
		m["image"] = s.Image
	}
	if len(s.Entrypoint) > 0 {
		m["entrypoint"] = s.Entrypoint
	}
	if len(s.Command) > 0 {
		m["command"] = s.Command
	}
	if s.Port != 0 {
		m["port"] = s.Port
	}
	if s.HealthCheckConfig != nil {
		m["health_check_config"] = s.HealthCheckConfig.toMap()
	}
	return m
}

// AliCloudFunctionCustomRuntimeConfig configures a custom runtime
//
//	(runtime="custom.*"). The function starts a long-running HTTP server
//	and FC forwards invocations to it.
type AliCloudFunctionCustomRuntimeConfigInput struct {
	// Bootstrap command to start the custom runtime server.
	Command []string `json:"command,omitempty" jsonschema:"Bootstrap command to start the custom runtime server."`
	// Arguments passed to the bootstrap command.
	Args []string `json:"args,omitempty" jsonschema:"Arguments passed to the bootstrap command."`
	// Port the custom runtime listens on. Range: 0-65535.
	Port int32 `json:"port,omitempty" jsonschema:"Port the custom runtime listens on. Range: 0-65535."`
	// Health check configuration for the custom runtime.
	HealthCheckConfig *AliCloudFunctionHealthCheckConfigInput `json:"health_check_config,omitempty" jsonschema:"Health check configuration for the custom runtime."`
}

func (s *AliCloudFunctionCustomRuntimeConfigInput) validate() error {
	if s.HealthCheckConfig != nil {
		if err := s.HealthCheckConfig.validate(); err != nil {
			return fmt.Errorf("health_check_config: %w", err)
		}
	}
	return nil
}

func (s *AliCloudFunctionCustomRuntimeConfigInput) applyDefaults() {
	if s.HealthCheckConfig != nil {
		s.HealthCheckConfig.applyDefaults()
	}
}

func (s *AliCloudFunctionCustomRuntimeConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if len(s.Command) > 0 {
		m["command"] = s.Command
	}
	if len(s.Args) > 0 {
		m["args"] = s.Args
	}
	if s.Port != 0 {
		m["port"] = s.Port
	}
	if s.HealthCheckConfig != nil {
		m["health_check_config"] = s.HealthCheckConfig.toMap()
	}
	return m
}

// AliCloudFunctionGpuConfig enables GPU acceleration for AI/ML inference.
type AliCloudFunctionGpuConfigInput struct {
	// GPU memory in MB allocated to each function instance.
	GpuMemorySize int32 `json:"gpu_memory_size,omitempty" jsonschema:"GPU memory in MB allocated to each function instance."`
	// GPU hardware type.
	GpuType string `json:"gpu_type,omitempty" jsonschema:"GPU hardware type."`
}

func (s *AliCloudFunctionGpuConfigInput) validate() error {
	return nil
}

func (s *AliCloudFunctionGpuConfigInput) applyDefaults() {
}

func (s *AliCloudFunctionGpuConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.GpuMemorySize != 0 {
		m["gpu_memory_size"] = s.GpuMemorySize
	}
	if s.GpuType != "" {
		m["gpu_type"] = s.GpuType
	}
	return m
}

// AliCloudFunctionHealthCheckConfig defines an HTTP health check used by
//
//	both custom container and custom runtime configurations to verify that
//	the function instance is ready to serve traffic.
type AliCloudFunctionHealthCheckConfigInput struct {
	// Seconds to wait after instance start before the first health check.
	//  Range: 0-120.
	InitialDelaySeconds int32 `json:"initial_delay_seconds,omitempty" jsonschema:"Seconds to wait after instance start before the first health check. Range: 0-120."`
	// Seconds to wait for a health check response before marking it failed.
	//  Range: 0-3.
	TimeoutSeconds int32 `json:"timeout_seconds,omitempty" jsonschema:"Seconds to wait for a health check response before marking it failed. Range: 0-3."`
	// HTTP GET URL path for the health check (e.g., "/healthz").
	HttpGetUrl string `json:"http_get_url,omitempty" jsonschema:"HTTP GET URL path for the health check (e.g.; '/healthz')."`
	// Seconds between consecutive health checks. Range: 0-120.
	PeriodSeconds int32 `json:"period_seconds,omitempty" jsonschema:"Seconds between consecutive health checks. Range: 0-120."`
	// Number of consecutive failures before the instance is marked unhealthy.
	//  Range: 1-120.
	FailureThreshold int32 `json:"failure_threshold,omitempty" jsonschema:"Number of consecutive failures before the instance is marked unhealthy. Range: 1-120."`
	// Number of consecutive successes before the instance is marked healthy.
	//  Range: 1-120.
	SuccessThreshold int32 `json:"success_threshold,omitempty" jsonschema:"Number of consecutive successes before the instance is marked healthy. Range: 1-120."`
}

func (s *AliCloudFunctionHealthCheckConfigInput) validate() error {
	return nil
}

func (s *AliCloudFunctionHealthCheckConfigInput) applyDefaults() {
}

func (s *AliCloudFunctionHealthCheckConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.InitialDelaySeconds != 0 {
		m["initial_delay_seconds"] = s.InitialDelaySeconds
	}
	if s.TimeoutSeconds != 0 {
		m["timeout_seconds"] = s.TimeoutSeconds
	}
	if s.HttpGetUrl != "" {
		m["http_get_url"] = s.HttpGetUrl
	}
	if s.PeriodSeconds != 0 {
		m["period_seconds"] = s.PeriodSeconds
	}
	if s.FailureThreshold != 0 {
		m["failure_threshold"] = s.FailureThreshold
	}
	if s.SuccessThreshold != 0 {
		m["success_threshold"] = s.SuccessThreshold
	}
	return m
}

// AliCloudFunctionInstanceLifecycleConfig defines initializer and pre-stop
//
//	hooks that run at instance creation and destruction.
type AliCloudFunctionInstanceLifecycleConfigInput struct {
	// Initializer hook. Runs once when a new instance is created, before it
	//  receives any invocations. Use for warm-up tasks (loading models,
	//  opening DB connections).
	Initializer *AliCloudFunctionLifecycleHookInput `json:"initializer,omitempty" jsonschema:"Initializer hook. Runs once when a new instance is created; before it receives any invocations. Use for warm-up tasks (loading models; opening DB connections)."`
	// Pre-stop hook. Runs before an idle instance is reclaimed. Use for
	//  cleanup tasks (flushing buffers, closing connections).
	PreStop *AliCloudFunctionLifecycleHookInput `json:"pre_stop,omitempty" jsonschema:"Pre-stop hook. Runs before an idle instance is reclaimed. Use for cleanup tasks (flushing buffers; closing connections)."`
}

func (s *AliCloudFunctionInstanceLifecycleConfigInput) validate() error {
	if s.Initializer != nil {
		if err := s.Initializer.validate(); err != nil {
			return fmt.Errorf("initializer: %w", err)
		}
	}
	if s.PreStop != nil {
		if err := s.PreStop.validate(); err != nil {
			return fmt.Errorf("pre_stop: %w", err)
		}
	}
	return nil
}

func (s *AliCloudFunctionInstanceLifecycleConfigInput) applyDefaults() {
	if s.Initializer != nil {
		s.Initializer.applyDefaults()
	}
	if s.PreStop != nil {
		s.PreStop.applyDefaults()
	}
}

func (s *AliCloudFunctionInstanceLifecycleConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Initializer != nil {
		m["initializer"] = s.Initializer.toMap()
	}
	if s.PreStop != nil {
		m["pre_stop"] = s.PreStop.toMap()
	}
	return m
}

// AliCloudFunctionLifecycleHook defines a single lifecycle hook with a
//
//	handler entry point and a timeout.
type AliCloudFunctionLifecycleHookInput struct {
	// Entry point for the hook (e.g., "index.initializer").
	Handler string `json:"handler,omitempty" jsonschema:"Entry point for the hook (e.g.; 'index.initializer')."`
	// Maximum execution time in seconds for the hook.
	//  Initializer: 0-600. Pre-stop: 0-900.
	Timeout int32 `json:"timeout,omitempty" jsonschema:"Maximum execution time in seconds for the hook. Initializer: 0-600. Pre-stop: 0-900."`
	// Bootstrap command for the hook (FC v3 supports command-based hooks
	//  in addition to handler-based hooks).
	Command []string `json:"command,omitempty" jsonschema:"Bootstrap command for the hook (FC v3 supports command-based hooks in addition to handler-based hooks)."`
}

func (s *AliCloudFunctionLifecycleHookInput) validate() error {
	return nil
}

func (s *AliCloudFunctionLifecycleHookInput) applyDefaults() {
}

func (s *AliCloudFunctionLifecycleHookInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Handler != "" {
		m["handler"] = s.Handler
	}
	if s.Timeout != 0 {
		m["timeout"] = s.Timeout
	}
	if len(s.Command) > 0 {
		m["command"] = s.Command
	}
	return m
}

// AliCloudFunctionLogConfig configures function invocation logging to
//
//	Simple Log Service (SLS).
type AliCloudFunctionLogConfigInput struct {
	// SLS project name. References AliCloudLogProject.
	Project string `json:"project,omitempty" jsonschema:"SLS project name. References AliCloudLogProject."`
	// SLS logstore name within the project.
	Logstore string `json:"logstore,omitempty" jsonschema:"SLS logstore name within the project."`
	// Log begin rule for parsing log boundaries.
	//  "None" disables log splitting. "DefaultRegex" uses the default regex.
	LogBeginRule string `json:"log_begin_rule,omitempty" jsonschema:"Log begin rule for parsing log boundaries. 'None' disables log splitting. 'DefaultRegex' uses the default regex."`
	// Enable per-instance resource usage metrics (CPU, memory).
	EnableInstanceMetrics bool `json:"enable_instance_metrics,omitempty" jsonschema:"Enable per-instance resource usage metrics (CPU; memory)."`
	// Enable per-request latency and status metrics.
	EnableRequestMetrics bool `json:"enable_request_metrics,omitempty" jsonschema:"Enable per-request latency and status metrics."`
}

func (s *AliCloudFunctionLogConfigInput) validate() error {
	return nil
}

func (s *AliCloudFunctionLogConfigInput) applyDefaults() {
}

func (s *AliCloudFunctionLogConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Project != "" {
		m["project"] = s.Project
	}
	if s.Logstore != "" {
		m["logstore"] = s.Logstore
	}
	if s.LogBeginRule != "" {
		m["log_begin_rule"] = s.LogBeginRule
	}
	if s.EnableInstanceMetrics {
		m["enable_instance_metrics"] = s.EnableInstanceMetrics
	}
	if s.EnableRequestMetrics {
		m["enable_request_metrics"] = s.EnableRequestMetrics
	}
	return m
}

// AliCloudFunctionNasConfig mounts a NAS file system into the function
//
//	instance. Requires vpc_config to be set because NAS mount targets are
//	VPC-internal.
type AliCloudFunctionNasConfigInput struct {
	// POSIX user ID for file access. Typically 0 (root) or a custom UID.
	UserId int32 `json:"user_id,omitempty" jsonschema:"POSIX user ID for file access. Typically 0 (root) or a custom UID."`
	// POSIX group ID for file access.
	GroupId int32 `json:"group_id,omitempty" jsonschema:"POSIX group ID for file access."`
	// NAS mount points to attach to the function instance.
	MountPoints []*AliCloudFunctionNasMountPointInput `json:"mount_points,omitempty" jsonschema:"NAS mount points to attach to the function instance."`
}

func (s *AliCloudFunctionNasConfigInput) validate() error {
	for i, v := range s.MountPoints {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("mount_points[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *AliCloudFunctionNasConfigInput) applyDefaults() {
}

func (s *AliCloudFunctionNasConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.UserId != 0 {
		m["user_id"] = s.UserId
	}
	if s.GroupId != 0 {
		m["group_id"] = s.GroupId
	}
	if len(s.MountPoints) > 0 {
		items := make([]any, len(s.MountPoints))
		for i, v := range s.MountPoints {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["mount_points"] = items
	}
	return m
}

// AliCloudFunctionNasMountPoint defines a single NAS mount.
type AliCloudFunctionNasMountPointInput struct {
	// NAS mount target address.
	//  Format: "{file-system-id}-{mount-target-id}.{region}.nas.aliyuncs.com:/{path}"
	ServerAddr string `json:"server_addr,omitempty" jsonschema:"NAS mount target address. Format: '{file-system-id}-{mount-target-id}.{region}.nas.aliyuncs.com:/{path}'"`
	// Directory inside the function instance where the NAS path is mounted.
	//  Must start with "/mnt/" (e.g., "/mnt/data").
	MountDir string `json:"mount_dir,omitempty" jsonschema:"Directory inside the function instance where the NAS path is mounted. Must start with '/mnt/' (e.g.; '/mnt/data')."`
	// Enable TLS encryption for NAS traffic.
	EnableTls bool `json:"enable_tls,omitempty" jsonschema:"Enable TLS encryption for NAS traffic."`
}

func (s *AliCloudFunctionNasMountPointInput) validate() error {
	return nil
}

func (s *AliCloudFunctionNasMountPointInput) applyDefaults() {
}

func (s *AliCloudFunctionNasMountPointInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.ServerAddr != "" {
		m["server_addr"] = s.ServerAddr
	}
	if s.MountDir != "" {
		m["mount_dir"] = s.MountDir
	}
	if s.EnableTls {
		m["enable_tls"] = s.EnableTls
	}
	return m
}

// AliCloudFunctionVpcConfig places the function inside a VPC so it can
//
//	reach private resources (databases, caches, NAS mount targets).
type AliCloudFunctionVpcConfigInput struct {
	// VPC ID. Computed by the provider from the VSwitch when omitted in TF,
	//  but required in the OpenMCF model for explicit cross-component wiring.
	VpcId string `json:"vpc_id,omitempty" jsonschema:"VPC ID. Computed by the provider from the VSwitch when omitted in TF; but required in the OpenMCF model for explicit cross-component wiring."`
	// VSwitch IDs to place the function's ENIs in. Multiple VSwitches across
	//  availability zones improve resilience.
	VswitchIds []string `json:"vswitch_ids,omitempty" jsonschema:"VSwitch IDs to place the function's ENIs in. Multiple VSwitches across availability zones improve resilience."`
	// Security group ID applied to the function's ENIs.
	SecurityGroupId string `json:"security_group_id,omitempty" jsonschema:"Security group ID applied to the function's ENIs."`
}

func (s *AliCloudFunctionVpcConfigInput) validate() error {
	return nil
}

func (s *AliCloudFunctionVpcConfigInput) applyDefaults() {
}

func (s *AliCloudFunctionVpcConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.VpcId != "" {
		m["vpc_id"] = s.VpcId
	}
	if len(s.VswitchIds) > 0 {
		m["vswitch_ids"] = s.VswitchIds
	}
	if s.SecurityGroupId != "" {
		m["security_group_id"] = s.SecurityGroupId
	}
	return m
}

// ParseAliCloudFunction validates and normalizes a AliCloudFunction cloud_object.
func ParseAliCloudFunction(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudFunction"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudFunctionSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
