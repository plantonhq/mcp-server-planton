// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T22:24:53+05:30

package azure

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// azure-nat-gateway
type AzureNatGatewaySpecInput struct {
	// Reference to the subnet to attach this NAT Gateway to (usually an existing Azure Subnet).
	//  Defaults to referencing an AzureSubnet resource’s ID output.
	SubnetId string `json:"subnet_id" jsonschema:"required,Reference to the subnet to attach this NAT Gateway to (usually an existing Azure Subnet). Defaults to referencing an AzureSubnet resource’s ID output."`
	// Idle timeout in minutes for TCP connections through the NAT Gateway.
	//  Defaults to 4 if not set. Valid range: 4 to 120 (inclusive).
	IdleTimeoutMinutes int32 `json:"idle_timeout_minutes,omitempty" jsonschema:"Idle timeout in minutes for TCP connections through the NAT Gateway. Defaults to 4 if not set. Valid range: 4 to 120 (inclusive)."`
	// Optional prefix length for allocating a Public IP Prefix for this NAT Gateway.
	//  If set (allowed values 28–31), a Public IP Prefix of /<prefix_length> is created instead of a single IP.
	PublicIpPrefixLength int32 `json:"public_ip_prefix_length,omitempty" jsonschema:"Optional prefix length for allocating a Public IP Prefix for this NAT Gateway. If set (allowed values 28–31); a Public IP Prefix of /<prefix_length> is created instead of a single IP."`
	// Optional tags to assign to the NAT Gateway resource.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Optional tags to assign to the NAT Gateway resource."`
	// The Azure region where the NAT Gateway will be deployed.
	//  Examples: "eastus", "westus2", "westeurope".
	Region string `json:"region" jsonschema:"required,The Azure region where the NAT Gateway will be deployed. Examples: 'eastus'; 'westus2'; 'westeurope'."`
	// The Azure Resource Group where the NAT Gateway will be created.
	//  Can be a literal string or a reference to an AzureResourceGroup output.
	ResourceGroup string `json:"resource_group" jsonschema:"required,The Azure Resource Group where the NAT Gateway will be created. Can be a literal string or a reference to an AzureResourceGroup output."`
}

func (s *AzureNatGatewaySpecInput) validate() error {
	if s.SubnetId == "" {
		return fmt.Errorf("subnet_id is required")
	}
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.ResourceGroup == "" {
		return fmt.Errorf("resource_group is required")
	}
	return nil
}

func (s *AzureNatGatewaySpecInput) applyDefaults() {
}

func (s *AzureNatGatewaySpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["subnet_id"] = s.SubnetId
	if s.IdleTimeoutMinutes != 0 {
		m["idle_timeout_minutes"] = s.IdleTimeoutMinutes
	}
	if s.PublicIpPrefixLength != 0 {
		m["public_ip_prefix_length"] = s.PublicIpPrefixLength
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	m["region"] = s.Region
	m["resource_group"] = s.ResourceGroup
	return m
}

// ParseAzureNatGateway validates and normalizes a AzureNatGateway cloud_object.
func ParseAzureNatGateway(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "azure.openmcf.org/v1", "AzureNatGateway"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AzureNatGatewaySpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
