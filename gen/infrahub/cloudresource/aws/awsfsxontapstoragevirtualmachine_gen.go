// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T22:24:53+05:30

package aws

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// aws-fsx-ontap-storage-virtual-machine
type AwsFsxOntapStorageVirtualMachineSpecInput struct {
	// The AWS region where the resource will be created.
	//  Example: "us-west-2", "eu-west-1"
	Region string `json:"region,omitempty" jsonschema:"The AWS region where the resource will be created. Example: 'us-west-2'; 'eu-west-1'"`
	// The ID of the FSx for ONTAP file system that this SVM belongs to. Required.
	//  ForceNew — the SVM cannot be moved to a different file system.
	//
	//  The file system provides the underlying storage, throughput, networking,
	//  and HA infrastructure. Multiple SVMs can share a single file system for
	//  multi-ten...
	FileSystemId string `json:"file_system_id" jsonschema:"required,The ID of the FSx for ONTAP file system that this SVM belongs to. Required. ForceNew — the SVM cannot be moved to a different file system. The file system provides the underlying storage; throughput..."`
	// The name of the SVM within the ONTAP file system. Required. ForceNew.
	//
	//  This is the ONTAP SVM name (not the OpenMCF metadata name). It must be
	//  unique within the file system and is used as the SVM identity in ONTAP CLI
	//  operations, SnapMirror relationships, and DNS endpoint names.
	//
	//  Constraints: 1-4...
	Name string `json:"name,omitempty" jsonschema:"The name of the SVM within the ONTAP file system. Required. ForceNew. This is the ONTAP SVM name (not the OpenMCF metadata name). It must be unique within the file system and is used as the SVM identi..."`
	// The security style for the root volume and the default for all volumes
	//  created under this SVM. ForceNew — cannot be changed after creation.
	//
	//  - "UNIX": UNIX permissions (mode bits, uid/gid). Best for Linux/NFS
	//    workloads. This is the most common choice for NFS-only SVMs.
	//  - "NTFS": Windows ACLs...
	RootVolumeSecurityStyle string `json:"root_volume_security_style,omitempty" jsonschema:"The security style for the root volume and the default for all volumes created under this SVM. ForceNew — cannot be changed after creation. - 'UNIX': UNIX permissions (mode bits; uid/gid). Best for ..."`
	// Password for the SVM administrative user ("vsadmin"). Enables SSH access
	//  to the SVM management endpoint for ONTAP CLI operations scoped to this SVM.
	//
	//  The vsadmin account can manage volumes, LIFs, export policies, and other
	//  SVM-scoped resources. Unlike the file system's fsxadmin account (which has...
	SvmAdminPassword string `json:"svm_admin_password,omitempty" jsonschema:"Password for the SVM administrative user ('vsadmin'). Enables SSH access to the SVM management endpoint for ONTAP CLI operations scoped to this SVM. The vsadmin account can manage volumes; LIFs; expor..."`
	// Active Directory configuration for enabling SMB protocol access. Optional.
	//
	//  When configured, the SVM joins the specified AD domain and an SMB endpoint
	//  is automatically created. Without AD, only NFS and iSCSI endpoints are
	//  available.
	//
	//  ONTAP SVMs support only self-managed Active Directory (on-prem...
	ActiveDirectoryConfiguration *AwsFsxOntapStorageVirtualMachineActiveDirectoryConfigurationInput `json:"active_directory_configuration,omitempty" jsonschema:"Active Directory configuration for enabling SMB protocol access. Optional. When configured; the SVM joins the specified AD domain and an SMB endpoint is automatically created. Without AD; only NFS and..."`
}

func (s *AwsFsxOntapStorageVirtualMachineSpecInput) validate() error {
	if s.FileSystemId == "" {
		return fmt.Errorf("file_system_id is required")
	}
	if s.ActiveDirectoryConfiguration != nil {
		if err := s.ActiveDirectoryConfiguration.validate(); err != nil {
			return fmt.Errorf("active_directory_configuration: %w", err)
		}
	}
	return nil
}

func (s *AwsFsxOntapStorageVirtualMachineSpecInput) applyDefaults() {
	if s.RootVolumeSecurityStyle == "" {
		s.RootVolumeSecurityStyle = "UNIX"
	}
	if s.ActiveDirectoryConfiguration != nil {
		s.ActiveDirectoryConfiguration.applyDefaults()
	}
}

func (s *AwsFsxOntapStorageVirtualMachineSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Region != "" {
		m["region"] = s.Region
	}
	m["file_system_id"] = s.FileSystemId
	if s.Name != "" {
		m["name"] = s.Name
	}
	if s.RootVolumeSecurityStyle != "" {
		m["root_volume_security_style"] = s.RootVolumeSecurityStyle
	}
	if s.SvmAdminPassword != "" {
		m["svm_admin_password"] = s.SvmAdminPassword
	}
	if s.ActiveDirectoryConfiguration != nil {
		m["active_directory_configuration"] = s.ActiveDirectoryConfiguration.toMap()
	}
	return m
}

// AwsFsxOntapStorageVirtualMachineActiveDirectoryConfiguration configures the
//
//	SVM to join a self-managed Active Directory domain for SMB protocol access.
//
//	When this block is specified, the SVM joins the AD domain during creation and
//	an SMB endpoint is automatically provisioned. The SVM appears as a computer
//	object in the specified organizational unit (or the default "Computers" OU).
//
//	Only self-managed AD is supported for ONTAP SVMs. Use this when your AD
//	domain controller runs on-premises, on EC2, or on Azure AD DS. AWS Managed
//	Microsoft AD integration is not available for ONTAP SVMs.
type AwsFsxOntapStorageVirtualMachineActiveDirectoryConfigurationInput struct {
	// NetBIOS name for the SVM's computer object in Active Directory.
	//
	//  This is the short name (up to 15 characters) that identifies the SVM in
	//  the AD domain. If omitted, AWS generates a name automatically.
	//
	//  Constraints: 1-15 characters, alphanumeric only.
	NetbiosName string `json:"netbios_name,omitempty" jsonschema:"NetBIOS name for the SVM's computer object in Active Directory. This is the short name (up to 15 characters) that identifies the SVM in the AD domain. If omitted; AWS generates a name automatically. C..."`
	// Fully qualified domain name of the Active Directory directory.
	//  Example: "corp.example.com"
	DomainName string `json:"domain_name,omitempty" jsonschema:"Fully qualified domain name of the Active Directory directory. Example: 'corp.example.com'"`
	// IP addresses of the DNS servers for the AD domain. Required. These must be
	//  reachable from the file system's subnets (typically in the same VPC CIDR or
	//  connected via VPN/peering).
	//
	//  Minimum 1, maximum 3 IP addresses.
	DnsIps []string `json:"dns_ips,omitempty" jsonschema:"IP addresses of the DNS servers for the AD domain. Required. These must be reachable from the file system's subnets (typically in the same VPC CIDR or connected via VPN/peering). Minimum 1; maximum 3 ..."`
	// Service account username for AD domain join operations. Required.
	//
	//  This account must have permissions to create computer objects in the
	//  specified OU (or the default Computers container).
	Username string `json:"username,omitempty" jsonschema:"Service account username for AD domain join operations. Required. This account must have permissions to create computer objects in the specified OU (or the default Computers container)."`
	// Service account password for AD domain join operations. Required.
	//
	//  This value is sensitive and will not be returned in read operations.
	//  For production workloads, consider injecting this value via CI/CD secrets
	//  management rather than storing it in the resource manifest.
	Password string `json:"password,omitempty" jsonschema:"Service account password for AD domain join operations. Required. This value is sensitive and will not be returned in read operations. For production workloads; consider injecting this value via CI/CD..."`
	// Name of the AD domain group whose members are granted administrative
	//  privileges on the SVM for file share management.
	//
	//  Default: Domain Admins
	FileSystemAdministratorsGroup string `json:"file_system_administrators_group,omitempty" jsonschema:"Name of the AD domain group whose members are granted administrative privileges on the SVM for file share management. Default: Domain Admins"`
	// Organizational Unit (OU) distinguished name within the AD directory where
	//  the SVM's computer object is created.
	//
	//  Example: "OU=FSx,DC=corp,DC=example,DC=com"
	//
	//  Only the OU immediately above the computer object can be specified.
	//  If not provided, the computer object is created in the default "Comput...
	OrganizationalUnitDistinguishedName string `json:"organizational_unit_distinguished_name,omitempty" jsonschema:"Organizational Unit (OU) distinguished name within the AD directory where the SVM's computer object is created. Example: 'OU=FSx;DC=corp;DC=example;DC=com' Only the OU immediately above the computer o..."`
}

func (s *AwsFsxOntapStorageVirtualMachineActiveDirectoryConfigurationInput) validate() error {
	if len(s.DnsIps) < 1 {
		return fmt.Errorf("dns_ips requires at least 1 items, got %d", len(s.DnsIps))
	}
	return nil
}

func (s *AwsFsxOntapStorageVirtualMachineActiveDirectoryConfigurationInput) applyDefaults() {
	if s.FileSystemAdministratorsGroup == "" {
		s.FileSystemAdministratorsGroup = "Domain Admins"
	}
}

func (s *AwsFsxOntapStorageVirtualMachineActiveDirectoryConfigurationInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.NetbiosName != "" {
		m["netbios_name"] = s.NetbiosName
	}
	if s.DomainName != "" {
		m["domain_name"] = s.DomainName
	}
	if len(s.DnsIps) > 0 {
		m["dns_ips"] = s.DnsIps
	}
	if s.Username != "" {
		m["username"] = s.Username
	}
	if s.Password != "" {
		m["password"] = s.Password
	}
	if s.FileSystemAdministratorsGroup != "" {
		m["file_system_administrators_group"] = s.FileSystemAdministratorsGroup
	}
	if s.OrganizationalUnitDistinguishedName != "" {
		m["organizational_unit_distinguished_name"] = s.OrganizationalUnitDistinguishedName
	}
	return m
}

// ParseAwsFsxOntapStorageVirtualMachine validates and normalizes a AwsFsxOntapStorageVirtualMachine cloud_object.
func ParseAwsFsxOntapStorageVirtualMachine(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "aws.openmcf.org/v1", "AwsFsxOntapStorageVirtualMachine"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AwsFsxOntapStorageVirtualMachineSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
