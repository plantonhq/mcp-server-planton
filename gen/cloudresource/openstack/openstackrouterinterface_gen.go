// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package openstack

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// OpenStackRouterInterface is a Kubernetes Resource Model (KRM) style resource
//
//	for attaching OpenStack Neutron routers to subnets.
//
//	A router interface is a join resource that creates a port on a subnet and
//	attaches it to a router, providing L3 routing for that subnet. This is the
//	glue between Layer 2 (subnet) and Layer 3 (router) -- without it, a subnet
//	has no route to other subnets or to the external network.
type OpenStackRouterInterfaceSpecInput struct {
	// router_id is the ID of the router to attach the subnet to.
	//  This is a required foreign key -- every router interface must reference
	//  exactly one router.
	//  Can reference an OpenStackRouter resource's output or be a literal router UUID.
	RouterId string `json:"router_id" jsonschema:"required,router_id is the ID of the router to attach the subnet to. This is a required foreign key -- every router interface must reference exactly one router. Can reference an OpenStackRouter resource's outpu..."`
	// subnet_id is the ID of the subnet to connect to the router.
	//  This is a required foreign key -- every router interface must reference
	//  exactly one subnet.
	//  Can reference an OpenStackSubnet resource's output or be a literal subnet UUID.
	SubnetId string `json:"subnet_id" jsonschema:"required,subnet_id is the ID of the subnet to connect to the router. This is a required foreign key -- every router interface must reference exactly one subnet. Can reference an OpenStackSubnet resource's outp..."`
	// region overrides the region from the provider config for this router interface.
	//  If omitted, the region from the OpenStack provider config is used.
	//  Example: "RegionOne"
	Region string `json:"region,omitempty" jsonschema:"region overrides the region from the provider config for this router interface. If omitted; the region from the OpenStack provider config is used. Example: 'RegionOne'"`
}

func (s *OpenStackRouterInterfaceSpecInput) validate() error {
	if s.RouterId == "" {
		return fmt.Errorf("router_id is required")
	}
	if s.SubnetId == "" {
		return fmt.Errorf("subnet_id is required")
	}
	return nil
}

func (s *OpenStackRouterInterfaceSpecInput) applyDefaults() {
}

func (s *OpenStackRouterInterfaceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["router_id"] = s.RouterId
	m["subnet_id"] = s.SubnetId
	if s.Region != "" {
		m["region"] = s.Region
	}
	return m
}

// ParseOpenStackRouterInterface validates and normalizes a OpenStackRouterInterface cloud_object.
func ParseOpenStackRouterInterface(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "openstack.openmcf.org/v1", "OpenStackRouterInterface"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec OpenStackRouterInterfaceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
