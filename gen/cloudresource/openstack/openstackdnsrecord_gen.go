// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:50:56+05:30

package openstack

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// OpenStackDnsRecord is a Kubernetes Resource Model (KRM) style resource for managing
//
//	a standalone DNS record in an OpenStack Designate zone.
//
//	This component creates a single DNS recordset (one name + one type + one or more values)
//	in an existing zone. Use this for DAG-visible, independently managed records in
//	InfraCharts. For convenience (all records in one component), use the inline records
//	feature of OpenStackDnsZone instead.
type OpenStackDnsRecordSpecInput struct {
	// (Required) The ID of the Designate zone where this record will be created.
	//  Can be a literal UUID or a reference to an OpenStackDnsZone resource's output.
	//
	//  FK: OpenStackDnsZone.status.outputs.zone_id
	//  ForceNew: changing this requires recreating the record.
	ZoneId string `json:"zone_id" jsonschema:"required,(Required) The ID of the Designate zone where this record will be created. Can be a literal UUID or a reference to an OpenStackDnsZone resource's output. FK: OpenStackDnsZone.status.outputs.zone_id Fo..."`
	// (Required) The fully qualified domain name for this record.
	//  Must end with a trailing dot to indicate FQDN.
	//  Example: "www.example.com." or "api.example.com."
	//  ForceNew: changing this requires recreating the record.
	RecordName string `json:"record_name" jsonschema:"required,(Required) The fully qualified domain name for this record. Must end with a trailing dot to indicate FQDN. Example: 'www.example.com.' or 'api.example.com.' ForceNew: changing this requires recreating..."`
	// (Required) The DNS record type.
	//  Supported types: A, AAAA, CNAME, MX, TXT, SRV, NS, PTR, CAA, SOA, SPF, SSHFP, NAPTR.
	//  ForceNew: changing this requires recreating the record.
	Type string `json:"type" jsonschema:"required,enum=A|AAAA|CNAME|MX|TXT|SRV|NS|PTR|CAA|SOA|SPF|SSHFP|NAPTR,(Required) The DNS record type. Supported types: A; AAAA; CNAME; MX; TXT; SRV; NS; PTR; CAA; SOA; SPF; SSHFP; NAPTR. ForceNew: changing this requires recreating the record."`
	// (Required) The DNS record values.
	//  Format depends on record type:
	//    - A record: IPv4 addresses (e.g., ["192.0.2.1", "192.0.2.2"])
	//    - AAAA record: IPv6 addresses (e.g., ["2001:db8::1"])
	//    - CNAME record: target hostname with trailing dot (e.g., ["target.example.com."])
	//    - MX record: priority an...
	Values []string `json:"values,omitempty" jsonschema:"(Required) The DNS record values. Format depends on record type: - A record: IPv4 addresses (e.g.; ['192.0.2.1'; '192.0.2.2']) - AAAA record: IPv6 addresses (e.g.; ['2001:db8::1']) - CNAME record: tar..."`
	// (Optional) Time To Live (in seconds) for this DNS record.
	//  Determines how long resolvers cache this record.
	//  If omitted, the zone's default TTL is used.
	Ttl int32 `json:"ttl,omitempty" jsonschema:"(Optional) Time To Live (in seconds) for this DNS record. Determines how long resolvers cache this record. If omitted; the zone's default TTL is used."`
	// (Optional) Human-readable description of the DNS record.
	Description string `json:"description,omitempty" jsonschema:"(Optional) Human-readable description of the DNS record."`
	// (Optional) Override the region from the provider config for this record.
	//  If omitted, the region from the OpenStack provider config is used.
	//  ForceNew: changing this requires recreating the record.
	Region string `json:"region,omitempty" jsonschema:"(Optional) Override the region from the provider config for this record. If omitted; the region from the OpenStack provider config is used. ForceNew: changing this requires recreating the record."`
}

func (s *OpenStackDnsRecordSpecInput) validate() error {
	if s.ZoneId == "" {
		return fmt.Errorf("zone_id is required")
	}
	if s.RecordName == "" {
		return fmt.Errorf("record_name is required")
	}
	if s.Type == "" {
		return fmt.Errorf("type is required")
	}
	switch s.Type {
	case "A", "AAAA", "CNAME", "MX", "TXT", "SRV", "NS", "PTR", "CAA", "SOA", "SPF", "SSHFP", "NAPTR":
	default:
		return fmt.Errorf("invalid type: %q", s.Type)
	}
	if len(s.Values) < 1 {
		return fmt.Errorf("values requires at least 1 items, got %d", len(s.Values))
	}
	return nil
}

func (s *OpenStackDnsRecordSpecInput) applyDefaults() {
}

func (s *OpenStackDnsRecordSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["zone_id"] = s.ZoneId
	m["record_name"] = s.RecordName
	m["type"] = s.Type
	if len(s.Values) > 0 {
		m["values"] = s.Values
	}
	if s.Ttl != 0 {
		m["ttl"] = s.Ttl
	}
	if s.Description != "" {
		m["description"] = s.Description
	}
	if s.Region != "" {
		m["region"] = s.Region
	}
	return m
}

// ParseOpenStackDnsRecord validates and normalizes a OpenStackDnsRecord cloud_object.
func ParseOpenStackDnsRecord(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "openstack.openmcf.org/v1", "OpenStackDnsRecord"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec OpenStackDnsRecordSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
