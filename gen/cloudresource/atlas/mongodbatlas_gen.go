// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package atlas

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// mongodb-atlas
type MongodbAtlasSpecInput struct {
	// cluster-config
	ClusterConfig *MongodbAtlasClusterConfigInput `json:"cluster_config,omitempty" jsonschema:"cluster-config"`
}

func (s *MongodbAtlasSpecInput) validate() error {
	if s.ClusterConfig != nil {
		if err := s.ClusterConfig.validate(); err != nil {
			return fmt.Errorf("cluster_config: %w", err)
		}
	}
	return nil
}

func (s *MongodbAtlasSpecInput) applyDefaults() {
	if s.ClusterConfig != nil {
		s.ClusterConfig.applyDefaults()
	}
}

func (s *MongodbAtlasSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.ClusterConfig != nil {
		m["cluster_config"] = s.ClusterConfig.toMap()
	}
	return m
}

// mongodb-atlas cluster config
type MongodbAtlasClusterConfigInput struct {
	// The unique ID for the project to create the database user.
	// https://www.pulumi.com/registry/packages/mongodbatlas/api-docs/cluster/#projectid_yaml
	ProjectId string `json:"project_id,omitempty" jsonschema:"The unique ID for the project to create the database user. https://www.pulumi.com/registry/packages/mongodbatlas/api-docs/cluster/#projectid_yaml"`
	// Specifies the type of the cluster that you want to modify. You cannot convert a sharded cluster deployment to a replica set deployment.
	// Accepted values include:
	// REPLICASET Replica set
	// SHARDED Sharded cluster
	// GEOSHARDED Global Cluster
	// https://www.pulumi.com/registry/packages/mongodbatlas/api-docs/clu...
	ClusterType string `json:"cluster_type,omitempty" jsonschema:"Specifies the type of the cluster that you want to modify. You cannot convert a sharded cluster deployment to a replica set deployment. Accepted values include: REPLICASET Replica set SHARDED Sharded ..."`
	// Number of electable nodes for Atlas to deploy to the region. Electable nodes can become the primary and can facilitate local reads.
	// The total number of electableNodes across all replication spec regions must total 3, 5, or 7.
	// Specify 0 if you do not want any electable nodes in the region.
	// You cannot...
	ElectableNodes int32 `json:"electable_nodes,omitempty" jsonschema:"Number of electable nodes for Atlas to deploy to the region. Electable nodes can become the primary and can facilitate local reads. The total number of electableNodes across all replication spec regio..."`
	// Election priority of the region. For regions with only read-only nodes, set this value to 0.
	// For regions where electable_nodes is at least 1, each region must have a priority of exactly one (1) less than the previous region. The first region must have a priority of 7. The lowest possible priority is...
	Priority int32 `json:"priority,omitempty" jsonschema:"Election priority of the region. For regions with only read-only nodes; set this value to 0. For regions where electable_nodes is at least 1; each region must have a priority of exactly one (1) less t..."`
	// Number of read-only nodes for Atlas to deploy to the region. Read-only nodes can never become the primary, but can facilitate local-reads. Specify 0 if you do not want any read-only nodes in the region.
	// https://www.pulumi.com/registry/packages/mongodbatlas/api-docs/cluster/#readonlynodes_yaml
	ReadOnlyNodes int32 `json:"read_only_nodes,omitempty" jsonschema:"Number of read-only nodes for Atlas to deploy to the region. Read-only nodes can never become the primary; but can facilitate local-reads. Specify 0 if you do not want any read-only nodes in the regio..."`
	// enable or disable cloud backup
	CloudBackup bool `json:"cloud_backup,omitempty" jsonschema:"enable or disable cloud backup"`
	// auto scaling disk db enabled
	AutoScalingDiskGbEnabled bool `json:"auto_scaling_disk_gb_enabled,omitempty" jsonschema:"auto scaling disk db enabled"`
	// Version of the cluster to deploy. Atlas supports the following MongoDB versions for M10+ clusters: 4.4, 5.0, 6.0 or 7.0.
	//  If omitted, Atlas deploys a cluster that runs MongoDB 7.0.
	//  If provider_instance_size_name: M0, M2 or M5, Atlas deploys MongoDB 5.0.
	//  Atlas always deploys the cluster with the la...
	MongoDbMajorVersion string `json:"mongo_db_major_version,omitempty" jsonschema:"Version of the cluster to deploy. Atlas supports the following MongoDB versions for M10+ clusters: 4.4; 5.0; 6.0 or 7.0. If omitted; Atlas deploys a cluster that runs MongoDB 7.0. If provider_instance..."`
	// Cloud service provider on which the servers are provisioned.
	//
	// The possible values are:
	//
	// AWS - Amazon AWS
	// GCP - Google Cloud Platform
	// AZURE - Microsoft Azure
	// TENANT - A multi-tenant deployment on one of the supported cloud service providers. Only valid when providerSettings.instanceSizeName is either...
	ProviderName string `json:"provider_name,omitempty" jsonschema:"Cloud service provider on which the servers are provisioned. The possible values are: AWS - Amazon AWS GCP - Google Cloud Platform AZURE - Microsoft Azure TENANT - A multi-tenant deployment on one of ..."`
	// https://www.pulumi.com/registry/packages/mongodbatlas/api-docs/cluster/#providerinstancesizename_yaml
	// Atlas provides different instance sizes, each with a default storage capacity and RAM size.
	//  The instance size you select is used for all the data-bearing servers in your cluster.
	// https://www.pulumi...
	ProviderInstanceSizeName string `json:"provider_instance_size_name,omitempty" jsonschema:"https://www.pulumi.com/registry/packages/mongodbatlas/api-docs/cluster/#providerinstancesizename_yaml Atlas provides different instance sizes; each with a default storage capacity and RAM size. The in..."`
}

func (s *MongodbAtlasClusterConfigInput) validate() error {
	return nil
}

func (s *MongodbAtlasClusterConfigInput) applyDefaults() {
}

func (s *MongodbAtlasClusterConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.ProjectId != "" {
		m["project_id"] = s.ProjectId
	}
	if s.ClusterType != "" {
		m["cluster_type"] = s.ClusterType
	}
	if s.ElectableNodes != 0 {
		m["electable_nodes"] = s.ElectableNodes
	}
	if s.Priority != 0 {
		m["priority"] = s.Priority
	}
	if s.ReadOnlyNodes != 0 {
		m["read_only_nodes"] = s.ReadOnlyNodes
	}
	if s.CloudBackup {
		m["cloud_backup"] = s.CloudBackup
	}
	if s.AutoScalingDiskGbEnabled {
		m["auto_scaling_disk_gb_enabled"] = s.AutoScalingDiskGbEnabled
	}
	if s.MongoDbMajorVersion != "" {
		m["mongo_db_major_version"] = s.MongoDbMajorVersion
	}
	if s.ProviderName != "" {
		m["provider_name"] = s.ProviderName
	}
	if s.ProviderInstanceSizeName != "" {
		m["provider_instance_size_name"] = s.ProviderInstanceSizeName
	}
	return m
}

// ParseMongodbAtlas validates and normalizes a MongodbAtlas cloud_object.
func ParseMongodbAtlas(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "atlas.openmcf.org/v1", "MongodbAtlas"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec MongodbAtlasSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
