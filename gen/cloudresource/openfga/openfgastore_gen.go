// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:50:56+05:30

package openfga

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// OpenFgaStore is a deployment component that creates a store in OpenFGA.
//
//	A store is the top-level container for authorization data in OpenFGA. Each store
//	contains authorization models (which define the relationships and permissions)
//	and relationship tuples (which represent the actual authorization data).
//
//	IMPORTANT: OpenFGA only has a Terraform provider - there is no Pulumi provider available.
//	This component must be deployed using Terraform/Tofu as the provisioner.
//	The Pulumi module is a pass-through placeholder that does not create resources.
//
//	Use cases:
//	- Create isolated authorization stores for different environments (dev/staging/prod)
//	- Separate authorization data for different applications or tenants
//	- Manage authorization infrastructure as code
//
//	Example manifest:
//	```yaml
//	apiVersion: openfga.openmcf.org/v1
//	kind: OpenFgaStore
//	metadata:
//	  name: production-authz
//	  org: my-organization
//	  env: production
//	spec:
//	  name: production-authorization-store
//	```
type OpenFgaStoreSpecInput struct {
	// name is the display name of the OpenFGA store.
	//
	//  This name is used to identify the store in the OpenFGA server.
	//  The store name should be descriptive of its purpose or environment.
	//
	//  Note: The store name is immutable - changing it requires replacing the store.
	//
	//  Examples: "production-authz", "stagin...
	Name string `json:"name" jsonschema:"required,name is the display name of the OpenFGA store. This name is used to identify the store in the OpenFGA server. The store name should be descriptive of its purpose or environment. Note: The store name i..."`
}

func (s *OpenFgaStoreSpecInput) validate() error {
	if s.Name == "" {
		return fmt.Errorf("name is required")
	}
	return nil
}

func (s *OpenFgaStoreSpecInput) applyDefaults() {
}

func (s *OpenFgaStoreSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["name"] = s.Name
	return m
}

// ParseOpenFgaStore validates and normalizes a OpenFgaStore cloud_object.
func ParseOpenFgaStore(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "openfga.openmcf.org/v1", "OpenFgaStore"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec OpenFgaStoreSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
