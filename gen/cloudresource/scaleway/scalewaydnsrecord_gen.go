// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package scaleway

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// ScalewayDnsRecord is a Kubernetes Resource Model (KRM) style resource
//
//	for managing individual DNS records within a Scaleway DNS zone.
//
//	This is the **standalone** DNS record kind -- the DAG-friendly
//	counterpart to ScalewayDnsZone's inline records. Use this kind when
//	record values come from other infrastructure resources (A records
//	pointing to a Load Balancer IP, CNAMEs to a Kapsule cluster endpoint)
//	so that infra charts can express explicit dependency edges.
//
//	Maps to a single `scaleway_domain_record` Terraform resource.
type ScalewayDnsRecordSpecInput struct {
	// The DNS zone name where this record will be created.
	//
	//  This can be a direct value (e.g., "example.com" or
	//  "staging.example.com") or a reference to a ScalewayDnsZone
	//  resource's output. The zone must already exist in Scaleway.
	//
	//  Examples:
	//    Direct: { value: "example.com" }
	//    Reference: { value_fro...
	ZoneName string `json:"zone_name" jsonschema:"required,The DNS zone name where this record will be created. This can be a direct value (e.g.; 'example.com' or 'staging.example.com') or a reference to a ScalewayDnsZone resource's output. The zone must alre..."`
	// Record name relative to the zone.
	//
	//  Use empty string for the zone apex (root record). Scaleway
	//  normalizes "@" and empty string to the zone root.
	//
	//  Cannot be changed after creation (ForceNew in Terraform). Changing
	//  the name requires recreating the record resource.
	//
	//  Examples:
	//    "" -> zone apex (e....
	Name string `json:"name,omitempty" jsonschema:"Record name relative to the zone. Use empty string for the zone apex (root record). Scaleway normalizes '@' and empty string to the zone root. Cannot be changed after creation (ForceNew in Terraform)...."`
	// DNS record type.
	//
	//  All Scaleway-supported record types and their data formats:
	//    A: IPv4 address (e.g., "192.0.2.1")
	//    AAAA: IPv6 address (e.g., "2001:db8::1")
	//    ALIAS: target hostname (e.g., "www.example.com.")
	//    CAA: flags tag value (e.g., '0 issue "letsencrypt.org"')
	//    CNAME: target hostname...
	Type string `json:"type" jsonschema:"required,enum=A|AAAA|ALIAS|CAA|CNAME|DNAME|MX|NS|PTR|SOA|SRV|TXT|TLSA,DNS record type. All Scaleway-supported record types and their data formats: A: IPv4 address (e.g.; '192.0.2.1') AAAA: IPv6 address (e.g.; '2001:db8::1') ALIAS: target hostname (e.g.; 'www.example.com..."`
	// Record data/value.
	//
	//  This can be a direct value or a reference to another resource's
	//  output via StringValueOrRef. This is the primary mechanism for
	//  cross-resource wiring in infra charts.
	//
	//  No default_kind is specified because record values can reference
	//  many different resource types (Load Balance...
	Data string `json:"data" jsonschema:"required,Record data/value. This can be a direct value or a reference to another resource's output via StringValueOrRef. This is the primary mechanism for cross-resource wiring in infra charts. No default_kind..."`
	// Time to live in seconds.
	//
	//  Determines how long DNS resolvers cache this record before
	//  querying Scaleway's nameservers again.
	//
	//  Common TTL values:
	//    300 (5 min) -- during migrations or cutover events
	//    3600 (1 hour) -- default for most records
	//    86400 (24 hours) -- static records that rarely chan...
	Ttl uint32 `json:"ttl,omitempty" jsonschema:"Time to live in seconds. Determines how long DNS resolvers cache this record before querying Scaleway's nameservers again. Common TTL values: 300 (5 min) -- during migrations or cutover events 3600 (1..."`
	// Priority for MX and SRV records.
	//
	//  Lower values indicate higher priority. For MX records, this
	//  determines mail delivery preference (e.g., 1 = primary, 10 = backup).
	//
	//  Ignored for record types other than MX and SRV.
	//  Defaults to 0 if not specified.
	Priority uint32 `json:"priority,omitempty" jsonschema:"Priority for MX and SRV records. Lower values indicate higher priority. For MX records; this determines mail delivery preference (e.g.; 1 = primary; 10 = backup). Ignored for record types other than M..."`
	// Keep the DNS zone alive when this record is the last one being
	//  destroyed.
	//
	//  When false (Scaleway default), destroying the last record in a zone
	//  also deletes the zone itself. When true, the zone persists even
	//  when empty.
	//
	//  Recommended to set to true when zones are managed by separate
	//  ScalewayDnsZ...
	KeepEmptyZone bool `json:"keep_empty_zone,omitempty" jsonschema:"Keep the DNS zone alive when this record is the last one being destroyed. When false (Scaleway default); destroying the last record in a zone also deletes the zone itself. When true; the zone persists..."`
}

func (s *ScalewayDnsRecordSpecInput) validate() error {
	if s.ZoneName == "" {
		return fmt.Errorf("zone_name is required")
	}
	if s.Type == "" {
		return fmt.Errorf("type is required")
	}
	switch s.Type {
	case "A", "AAAA", "ALIAS", "CAA", "CNAME", "DNAME", "MX", "NS", "PTR", "SOA", "SRV", "TXT", "TLSA":
	default:
		return fmt.Errorf("invalid type: %q", s.Type)
	}
	if s.Data == "" {
		return fmt.Errorf("data is required")
	}
	return nil
}

func (s *ScalewayDnsRecordSpecInput) applyDefaults() {
}

func (s *ScalewayDnsRecordSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["zone_name"] = s.ZoneName
	if s.Name != "" {
		m["name"] = s.Name
	}
	m["type"] = s.Type
	m["data"] = s.Data
	if s.Ttl != 0 {
		m["ttl"] = s.Ttl
	}
	if s.Priority != 0 {
		m["priority"] = s.Priority
	}
	if s.KeepEmptyZone {
		m["keep_empty_zone"] = s.KeepEmptyZone
	}
	return m
}

// ParseScalewayDnsRecord validates and normalizes a ScalewayDnsRecord cloud_object.
func ParseScalewayDnsRecord(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "scaleway.openmcf.org/v1", "ScalewayDnsRecord"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec ScalewayDnsRecordSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
