// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package scaleway

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// scaleway-dns-zone
type ScalewayDnsZoneSpecInput struct {
	// The registered parent domain name (e.g., "example.com").
	//
	//  This must be a domain you own or have been delegated control of.
	//  Scaleway does not perform domain registration -- the domain must
	//  already exist at a registrar (Namecheap, Google Domains, etc.).
	//
	//  Cannot be changed after creation (ForceNew ...
	Domain string `json:"domain" jsonschema:"required,The registered parent domain name (e.g.; 'example.com'). This must be a domain you own or have been delegated control of. Scaleway does not perform domain registration -- the domain must already exist..."`
	// Subdomain prefix for this zone.
	//
	//  Leave empty ("") for the root zone of the domain.
	//  Set to a value like "staging" to create a zone for
	//  "staging.example.com", which enables subdomain delegation
	//  (a separate set of nameservers for a portion of the namespace).
	//
	//  Can be updated after creation without ...
	Subdomain string `json:"subdomain,omitempty" jsonschema:"Subdomain prefix for this zone. Leave empty ('') for the root zone of the domain. Set to a value like 'staging' to create a zone for 'staging.example.com'; which enables subdomain delegation (a separa..."`
	// DNS records to create within this zone.
	//
	//  Each entry creates one `scaleway_domain_record` resource.
	//  Suitable for static records known at zone creation time:
	//    - MX records for email routing
	//    - TXT records for SPF, DKIM, DMARC, domain verification
	//    - CAA records for certificate authority author...
	Records []*ScalewayDnsZoneRecordInput `json:"records,omitempty" jsonschema:"DNS records to create within this zone. Each entry creates one 'scaleway_domain_record' resource. Suitable for static records known at zone creation time: - MX records for email routing - TXT records ..."`
}

func (s *ScalewayDnsZoneSpecInput) validate() error {
	if s.Domain == "" {
		return fmt.Errorf("domain is required")
	}
	for i, v := range s.Records {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("records[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *ScalewayDnsZoneSpecInput) applyDefaults() {
}

func (s *ScalewayDnsZoneSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["domain"] = s.Domain
	if s.Subdomain != "" {
		m["subdomain"] = s.Subdomain
	}
	if len(s.Records) > 0 {
		items := make([]any, len(s.Records))
		for i, v := range s.Records {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["records"] = items
	}
	return m
}

// ScalewayDnsZoneRecord defines an inline DNS record within the zone.
//
//	Each record entry maps to exactly one `scaleway_domain_record`
//	Terraform resource. For multi-value records (e.g., multiple MX
//	records for the same domain), add multiple entries with the same
//	name and type but different data values and priorities.
//
//	Supported record types cover all Scaleway DNS record types:
//	  A, AAAA, ALIAS, CAA, CNAME, DNAME, MX, NS, PTR, SOA, SRV, TXT, TLSA
type ScalewayDnsZoneRecordInput struct {
	// Record name relative to the zone.
	//
	//  Use empty string or omit for the zone apex (root record).
	//  Scaleway normalizes "@" and empty string to the zone root.
	//
	//  Examples:
	//    "" or "@" -> zone apex (e.g., example.com)
	//    "www" -> www.example.com
	//    "api" -> api.example.com
	//    "_dmarc" -> _dmarc.example.co...
	Name string `json:"name,omitempty" jsonschema:"Record name relative to the zone. Use empty string or omit for the zone apex (root record). Scaleway normalizes '@' and empty string to the zone root. Examples: '' or '@' -> zone apex (e.g.; example.c..."`
	// DNS record type.
	//
	//  All Scaleway-supported record types and their data formats:
	//    A: IPv4 address (e.g., "192.0.2.1")
	//    AAAA: IPv6 address (e.g., "2001:db8::1")
	//    ALIAS: target hostname (e.g., "www.example.com.")
	//    CAA: flags tag value (e.g., '0 issue "letsencrypt.org"')
	//    CNAME: target hostname...
	Type string `json:"type" jsonschema:"required,enum=A|AAAA|ALIAS|CAA|CNAME|DNAME|MX|NS|PTR|SOA|SRV|TXT|TLSA,DNS record type. All Scaleway-supported record types and their data formats: A: IPv4 address (e.g.; '192.0.2.1') AAAA: IPv6 address (e.g.; '2001:db8::1') ALIAS: target hostname (e.g.; 'www.example.com..."`
	// Record data/value.
	//
	//  Can be a literal string or a reference to another resource's
	//  output via StringValueOrRef. This enables inline records to
	//  reference dynamic values from other infrastructure:
	//    - A Load Balancer's IP address
	//    - A Kapsule cluster's wildcard DNS endpoint
	//    - An Instance's publ...
	Data string `json:"data" jsonschema:"required,Record data/value. Can be a literal string or a reference to another resource's output via StringValueOrRef. This enables inline records to reference dynamic values from other infrastructure: - A Load..."`
	// Time to live in seconds.
	//
	//  Determines how long DNS resolvers cache this record before
	//  querying Scaleway's nameservers again.
	//
	//  Common TTL values:
	//    300 (5 min) -- during migrations or cutover events
	//    3600 (1 hour) -- default for most records
	//    86400 (24 hours) -- static records that rarely chan...
	Ttl uint32 `json:"ttl,omitempty" jsonschema:"Time to live in seconds. Determines how long DNS resolvers cache this record before querying Scaleway's nameservers again. Common TTL values: 300 (5 min) -- during migrations or cutover events 3600 (1..."`
	// Priority for MX and SRV records.
	//
	//  Lower values indicate higher priority. For MX records, this
	//  determines mail delivery preference (e.g., 1 = primary, 10 = backup).
	//
	//  Ignored for record types other than MX and SRV.
	//  Defaults to 0 if not specified.
	Priority uint32 `json:"priority,omitempty" jsonschema:"Priority for MX and SRV records. Lower values indicate higher priority. For MX records; this determines mail delivery preference (e.g.; 1 = primary; 10 = backup). Ignored for record types other than M..."`
}

func (s *ScalewayDnsZoneRecordInput) validate() error {
	if s.Type == "" {
		return fmt.Errorf("type is required")
	}
	switch s.Type {
	case "A", "AAAA", "ALIAS", "CAA", "CNAME", "DNAME", "MX", "NS", "PTR", "SOA", "SRV", "TXT", "TLSA":
	default:
		return fmt.Errorf("invalid type: %q", s.Type)
	}
	if s.Data == "" {
		return fmt.Errorf("data is required")
	}
	return nil
}

func (s *ScalewayDnsZoneRecordInput) applyDefaults() {
}

func (s *ScalewayDnsZoneRecordInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Name != "" {
		m["name"] = s.Name
	}
	m["type"] = s.Type
	m["data"] = s.Data
	if s.Ttl != 0 {
		m["ttl"] = s.Ttl
	}
	if s.Priority != 0 {
		m["priority"] = s.Priority
	}
	return m
}

// ParseScalewayDnsZone validates and normalizes a ScalewayDnsZone cloud_object.
func ParseScalewayDnsZone(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "scaleway.openmcf.org/v1", "ScalewayDnsZone"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec ScalewayDnsZoneSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
