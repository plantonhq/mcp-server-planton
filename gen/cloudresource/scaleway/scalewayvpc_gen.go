// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package scaleway

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// scaleway-vpc
type ScalewayVpcSpecInput struct {
	// The Scaleway region where the VPC will be created.
	//  Examples: "fr-par", "nl-ams", "pl-waw"
	//
	//  This field is required and cannot be changed after creation.
	Region string `json:"region" jsonschema:"required,The Scaleway region where the VPC will be created. Examples: 'fr-par'; 'nl-ams'; 'pl-waw' This field is required and cannot be changed after creation."`
	// Whether to enable routing between Private Networks in this VPC.
	//
	//  When enabled, resources in different Private Networks attached to this VPC
	//  can communicate with each other. This is essential for multi-tier architectures
	//  (e.g., a Kapsule cluster in one Private Network talking to an RDB instance
	//  i...
	EnableRouting bool `json:"enable_routing,omitempty" jsonschema:"Whether to enable routing between Private Networks in this VPC. When enabled; resources in different Private Networks attached to this VPC can communicate with each other. This is essential for multi-..."`
	// Whether to enable custom routes propagation between Private Networks in this VPC.
	//
	//  When enabled, custom routes from one Private Network are advertised to other
	//  Private Networks in the same VPC. This is useful for advanced networking
	//  scenarios such as VPN gateways or network appliances.
	//
	//  IMPORTAN...
	EnableCustomRoutesPropagation bool `json:"enable_custom_routes_propagation,omitempty" jsonschema:"Whether to enable custom routes propagation between Private Networks in this VPC. When enabled; custom routes from one Private Network are advertised to other Private Networks in the same VPC. This is..."`
}

func (s *ScalewayVpcSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	return nil
}

func (s *ScalewayVpcSpecInput) applyDefaults() {
}

func (s *ScalewayVpcSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	if s.EnableRouting {
		m["enable_routing"] = s.EnableRouting
	}
	if s.EnableCustomRoutesPropagation {
		m["enable_custom_routes_propagation"] = s.EnableCustomRoutesPropagation
	}
	return m
}

// ParseScalewayVpc validates and normalizes a ScalewayVpc cloud_object.
func ParseScalewayVpc(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "scaleway.openmcf.org/v1", "ScalewayVpc"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec ScalewayVpcSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
