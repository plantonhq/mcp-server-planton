// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:01:03+05:30

package hetznercloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// hetznercloud-snapshot
type HetznerCloudSnapshotSpecInput struct {
	// Server to create the snapshot from. Required.
	//
	//  Accepts a literal Hetzner Cloud server ID (as a string) or a reference
	//  to a HetznerCloudServer resource's output via valueFrom.
	//
	//  Changing this value forces replacement of the snapshot (the existing
	//  snapshot is destroyed and a new one is created from...
	ServerId string `json:"server_id" jsonschema:"required,Server to create the snapshot from. Required. Accepts a literal Hetzner Cloud server ID (as a string) or a reference to a HetznerCloudServer resource's output via valueFrom. Changing this value forces..."`
	// Human-readable description of the snapshot. Optional.
	//
	//  Useful for identifying the purpose of the snapshot (e.g.,
	//  "pre-upgrade baseline", "golden image v2.1"). Can be updated after
	//  creation without replacing the snapshot.
	Description string `json:"description,omitempty" jsonschema:"Human-readable description of the snapshot. Optional. Useful for identifying the purpose of the snapshot (e.g.; 'pre-upgrade baseline'; 'golden image v2.1'). Can be updated after creation without repl..."`
}

func (s *HetznerCloudSnapshotSpecInput) validate() error {
	if s.ServerId == "" {
		return fmt.Errorf("server_id is required")
	}
	return nil
}

func (s *HetznerCloudSnapshotSpecInput) applyDefaults() {
}

func (s *HetznerCloudSnapshotSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["server_id"] = s.ServerId
	if s.Description != "" {
		m["description"] = s.Description
	}
	return m
}

// ParseHetznerCloudSnapshot validates and normalizes a HetznerCloudSnapshot cloud_object.
func ParseHetznerCloudSnapshot(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "hetzner-cloud.openmcf.org/v1", "HetznerCloudSnapshot"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec HetznerCloudSnapshotSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
