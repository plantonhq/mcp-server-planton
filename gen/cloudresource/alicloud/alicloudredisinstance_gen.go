// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-redis-instance
type AliCloudRedisInstanceSpecInput struct {
	// Alibaba Cloud region where the Redis instance will be created.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region where the Redis instance will be created. Examples: 'cn-hangzhou'; 'cn-shanghai'; 'us-west-1'; 'ap-southeast-1'."`
	// VSwitch ID where the Redis instance is placed. The instance inherits the
	//  VPC and availability zone from the VSwitch.
	VswitchId string `json:"vswitch_id" jsonschema:"required,VSwitch ID where the Redis instance is placed. The instance inherits the VPC and availability zone from the VSwitch."`
	// Instance specification class that determines memory capacity and
	//  performance tier. Examples: "redis.master.small.default",
	//  "redis.master.large.default", "redis.sharding.mid.default".
	//  See Alibaba Cloud documentation for the full list of instance classes.
	InstanceClass string `json:"instance_class" jsonschema:"required,Instance specification class that determines memory capacity and performance tier. Examples: 'redis.master.small.default'; 'redis.master.large.default'; 'redis.sharding.mid.default'. See Alibaba Cloud..."`
	// Instance authentication password. 8-32 characters, must contain at least
	//  three of: uppercase letters, lowercase letters, digits, special characters.
	Password string `json:"password" jsonschema:"required,Instance authentication password. 8-32 characters; must contain at least three of: uppercase letters; lowercase letters; digits; special characters."`
	// Redis engine version. Alibaba Cloud KVStore supports multiple versions.
	//  Default: "7.0"
	EngineVersion string `json:"engine_version,omitempty" jsonschema:"Redis engine version. Alibaba Cloud KVStore supports multiple versions. Default: '7.0'"`
	// KVStore engine type. "Redis" is the default and recommended engine.
	//  "Memcache" is supported but rare; the component is named RedisInstance
	//  because Redis represents 95%+ of KVStore usage.
	//  Default: "Redis"
	InstanceType string `json:"instance_type,omitempty" jsonschema:"KVStore engine type. 'Redis' is the default and recommended engine. 'Memcache' is supported but rare; the component is named RedisInstance because Redis represents 95%+ of KVStore usage. Default: 'Red..."`
	// Instance display name. 2-256 characters.
	//  If omitted, defaults to the metadata.name.
	DbInstanceName string `json:"db_instance_name,omitempty" jsonschema:"Instance display name. 2-256 characters. If omitted; defaults to the metadata.name."`
	// Primary availability zone ID. If omitted, Alibaba Cloud selects a zone
	//  from the VSwitch's region.
	//  Examples: "cn-hangzhou-a", "cn-shanghai-b".
	ZoneId string `json:"zone_id,omitempty" jsonschema:"Primary availability zone ID. If omitted; Alibaba Cloud selects a zone from the VSwitch's region. Examples: 'cn-hangzhou-a'; 'cn-shanghai-b'."`
	// Secondary availability zone for multi-zone high availability deployments.
	//  When set, the standby node runs in this zone for cross-AZ failover.
	//  Must differ from zone_id.
	SecondaryZoneId string `json:"secondary_zone_id,omitempty" jsonschema:"Secondary availability zone for multi-zone high availability deployments. When set; the standby node runs in this zone for cross-AZ failover. Must differ from zone_id."`
	// Billing method. "PostPaid" for pay-as-you-go, "PrePaid" for subscription.
	//  Default: "PostPaid"
	PaymentType string `json:"payment_type,omitempty" jsonschema:"Billing method. 'PostPaid' for pay-as-you-go; 'PrePaid' for subscription. Default: 'PostPaid'"`
	// IP addresses or CIDR blocks allowed to access the Redis instance.
	//  Default: ["127.0.0.1"] (no access). Set to ["0.0.0.0/0"] to allow all
	//  (not recommended for production).
	SecurityIps []string `json:"security_ips,omitempty" jsonschema:"IP addresses or CIDR blocks allowed to access the Redis instance. Default: ['127.0.0.1'] (no access). Set to ['0.0.0.0/0'] to allow all (not recommended for production)."`
	// Security group ID to associate with the Redis instance. Multiple
	//  security group IDs can be provided as a comma-separated string.
	SecurityGroupId string `json:"security_group_id,omitempty" jsonschema:"Security group ID to associate with the Redis instance. Multiple security group IDs can be provided as a comma-separated string."`
	// Alibaba Cloud resource group ID for organizational grouping (per DD05).
	//  If omitted, the instance is placed in the account's default resource group.
	ResourceGroupId string `json:"resource_group_id,omitempty" jsonschema:"Alibaba Cloud resource group ID for organizational grouping (per DD05). If omitted; the instance is placed in the account's default resource group."`
	// Tags to apply to the Redis instance.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Tags to apply to the Redis instance."`
	// Number of data shards for cluster (sharding) instances. Setting this to
	//  a value > 1 creates a cluster-mode Redis instance. Cluster mode is
	//  recommended for large-scale caching workloads that exceed the memory
	//  capacity or throughput of a single node.
	//  Valid range depends on the instance class; comm...
	ShardCount int32 `json:"shard_count,omitempty" jsonschema:"Number of data shards for cluster (sharding) instances. Setting this to a value > 1 creates a cluster-mode Redis instance. Cluster mode is recommended for large-scale caching workloads that exceed the..."`
	// Number of read-only replicas in the primary zone (1-9). Read replicas
	//  enable read scaling by distributing read traffic across multiple nodes.
	//  Only available for master-slave and cluster instances.
	ReadOnlyCount int32 `json:"read_only_count,omitempty" jsonschema:"Number of read-only replicas in the primary zone (1-9). Read replicas enable read scaling by distributing read traffic across multiple nodes. Only available for master-slave and cluster instances."`
	// SSL/TLS encryption for client connections.
	//  "Enable" turns on SSL. "Disable" turns off SSL.
	//  "Update" rotates the SSL certificate.
	SslEnable string `json:"ssl_enable,omitempty" jsonschema:"SSL/TLS encryption for client connections. 'Enable' turns on SSL. 'Disable' turns off SSL. 'Update' rotates the SSL certificate."`
	// Transparent Data Encryption (TDE) status. Once enabled, TDE cannot be
	//  disabled. Encrypts data at rest at the storage level.
	TdeStatus string `json:"tde_status,omitempty" jsonschema:"Transparent Data Encryption (TDE) status. Once enabled; TDE cannot be disabled. Encrypts data at rest at the storage level."`
	// Custom KMS key ID for TDE encryption. When set with tde_status = Enabled,
	//  uses a customer-managed key instead of the service-managed default.
	EncryptionKey string `json:"encryption_key,omitempty" jsonschema:"Custom KMS key ID for TDE encryption. When set with tde_status = Enabled; uses a customer-managed key instead of the service-managed default."`
	// VPC authentication mode. "Open" requires password authentication for
	//  VPC-internal connections. "Close" disables password authentication for
	//  VPC-internal connections (connections from within the VPC don't need a
	//  password). Default: "Open"
	VpcAuthMode string `json:"vpc_auth_mode,omitempty" jsonschema:"VPC authentication mode. 'Open' requires password authentication for VPC-internal connections. 'Close' disables password authentication for VPC-internal connections (connections from within the VPC do..."`
	// Redis configuration parameters as key-value pairs. Allows tuning Redis
	//  engine settings such as maxmemory-policy, timeout, hz, etc.
	//  Refer to Alibaba Cloud documentation for valid parameter names.
	Config map[string]string `json:"config,omitempty" jsonschema:"Redis configuration parameters as key-value pairs. Allows tuning Redis engine settings such as maxmemory-policy; timeout; hz; etc. Refer to Alibaba Cloud documentation for valid parameter names."`
	// Enable release protection to prevent accidental deletion via the
	//  console or API.
	InstanceReleaseProtection bool `json:"instance_release_protection,omitempty" jsonschema:"Enable release protection to prevent accidental deletion via the console or API."`
	// Maintenance window start time in UTC format (e.g., "02:00Z").
	//  The Redis service may perform minor version upgrades or patches
	//  during this window.
	MaintainStartTime string `json:"maintain_start_time,omitempty" jsonschema:"Maintenance window start time in UTC format (e.g.; '02:00Z'). The Redis service may perform minor version upgrades or patches during this window."`
	// Maintenance window end time in UTC format (e.g., "06:00Z").
	MaintainEndTime string `json:"maintain_end_time,omitempty" jsonschema:"Maintenance window end time in UTC format (e.g.; '06:00Z')."`
	// Backup days of the week. Each entry is a day name.
	//  Examples: ["Monday", "Wednesday", "Friday"].
	BackupPeriod []string `json:"backup_period,omitempty" jsonschema:"Backup days of the week. Each entry is a day name. Examples: ['Monday'; 'Wednesday'; 'Friday']."`
	// Backup time window in UTC. Format: "HH:mmZ-HH:mmZ".
	//  Example: "02:00Z-03:00Z".
	BackupTime string `json:"backup_time,omitempty" jsonschema:"Backup time window in UTC. Format: 'HH:mmZ-HH:mmZ'. Example: '02:00Z-03:00Z'."`
	// Custom prefix for the private connection string.
	//  When set, the private connection domain uses this prefix instead of
	//  the auto-generated one.
	PrivateConnectionPrefix string `json:"private_connection_prefix,omitempty" jsonschema:"Custom prefix for the private connection string. When set; the private connection domain uses this prefix instead of the auto-generated one."`
	// Auto-renewal for PrePaid instances. Ignored for PostPaid instances.
	AutoRenew bool `json:"auto_renew,omitempty" jsonschema:"Auto-renewal for PrePaid instances. Ignored for PostPaid instances."`
	// Auto-renewal period in months (1-12). Only applicable when auto_renew
	//  is true and payment_type is "PrePaid".
	AutoRenewPeriod int32 `json:"auto_renew_period,omitempty" jsonschema:"Auto-renewal period in months (1-12). Only applicable when auto_renew is true and payment_type is 'PrePaid'."`
	// Subscription period in months. Only applicable when payment_type
	//  is "PrePaid". Valid values: 1-9, 12, 24, 36.
	Period string `json:"period,omitempty" jsonschema:"Subscription period in months. Only applicable when payment_type is 'PrePaid'. Valid values: 1-9; 12; 24; 36."`
}

func (s *AliCloudRedisInstanceSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.VswitchId == "" {
		return fmt.Errorf("vswitch_id is required")
	}
	if s.InstanceClass == "" {
		return fmt.Errorf("instance_class is required")
	}
	if s.Password == "" {
		return fmt.Errorf("password is required")
	}
	return nil
}

func (s *AliCloudRedisInstanceSpecInput) applyDefaults() {
	if s.EngineVersion == "" {
		s.EngineVersion = "7.0"
	}
	if s.InstanceType == "" {
		s.InstanceType = "Redis"
	}
	if s.PaymentType == "" {
		s.PaymentType = "PostPaid"
	}
	if s.VpcAuthMode == "" {
		s.VpcAuthMode = "Open"
	}
}

func (s *AliCloudRedisInstanceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["vswitch_id"] = s.VswitchId
	m["instance_class"] = s.InstanceClass
	m["password"] = s.Password
	if s.EngineVersion != "" {
		m["engine_version"] = s.EngineVersion
	}
	if s.InstanceType != "" {
		m["instance_type"] = s.InstanceType
	}
	if s.DbInstanceName != "" {
		m["db_instance_name"] = s.DbInstanceName
	}
	if s.ZoneId != "" {
		m["zone_id"] = s.ZoneId
	}
	if s.SecondaryZoneId != "" {
		m["secondary_zone_id"] = s.SecondaryZoneId
	}
	if s.PaymentType != "" {
		m["payment_type"] = s.PaymentType
	}
	if len(s.SecurityIps) > 0 {
		m["security_ips"] = s.SecurityIps
	}
	if s.SecurityGroupId != "" {
		m["security_group_id"] = s.SecurityGroupId
	}
	if s.ResourceGroupId != "" {
		m["resource_group_id"] = s.ResourceGroupId
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	if s.ShardCount != 0 {
		m["shard_count"] = s.ShardCount
	}
	if s.ReadOnlyCount != 0 {
		m["read_only_count"] = s.ReadOnlyCount
	}
	if s.SslEnable != "" {
		m["ssl_enable"] = s.SslEnable
	}
	if s.TdeStatus != "" {
		m["tde_status"] = s.TdeStatus
	}
	if s.EncryptionKey != "" {
		m["encryption_key"] = s.EncryptionKey
	}
	if s.VpcAuthMode != "" {
		m["vpc_auth_mode"] = s.VpcAuthMode
	}
	if len(s.Config) > 0 {
		m["config"] = s.Config
	}
	if s.InstanceReleaseProtection {
		m["instance_release_protection"] = s.InstanceReleaseProtection
	}
	if s.MaintainStartTime != "" {
		m["maintain_start_time"] = s.MaintainStartTime
	}
	if s.MaintainEndTime != "" {
		m["maintain_end_time"] = s.MaintainEndTime
	}
	if len(s.BackupPeriod) > 0 {
		m["backup_period"] = s.BackupPeriod
	}
	if s.BackupTime != "" {
		m["backup_time"] = s.BackupTime
	}
	if s.PrivateConnectionPrefix != "" {
		m["private_connection_prefix"] = s.PrivateConnectionPrefix
	}
	if s.AutoRenew {
		m["auto_renew"] = s.AutoRenew
	}
	if s.AutoRenewPeriod != 0 {
		m["auto_renew_period"] = s.AutoRenewPeriod
	}
	if s.Period != "" {
		m["period"] = s.Period
	}
	return m
}

// ParseAliCloudRedisInstance validates and normalizes a AliCloudRedisInstance cloud_object.
func ParseAliCloudRedisInstance(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudRedisInstance"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudRedisInstanceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
