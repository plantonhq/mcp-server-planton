// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:50:56+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-cen-instance
type AliCloudCenInstanceSpecInput struct {
	// Alibaba Cloud region used for API routing. CEN is a global service so
	//  this does not restrict where attached networks reside -- each attachment
	//  declares its own region via child_instance_region_id.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region used for API routing. CEN is a global service so this does not restrict where attached networks reside -- each attachment declares its own region via child_instance_region_id. Exa..."`
	// CEN instance name. 2-128 characters; must start with a letter or Chinese
	//  character; can contain digits, underscores, periods, and hyphens.
	CenInstanceName string `json:"cen_instance_name" jsonschema:"required,CEN instance name. 2-128 characters; must start with a letter or Chinese character; can contain digits; underscores; periods; and hyphens."`
	// Human-readable description of the CEN instance's purpose.
	Description string `json:"description,omitempty" jsonschema:"Human-readable description of the CEN instance's purpose."`
	// CIDR block overlap protection level for attached networks. When set to
	//  "REDUCED", CEN allows overlapping CIDR blocks between attached VPCs
	//  (routing is controlled by route maps). Leave empty for the default
	//  strict mode that rejects CIDR overlaps.
	ProtectionLevel string `json:"protection_level,omitempty" jsonschema:"CIDR block overlap protection level for attached networks. When set to 'REDUCED'; CEN allows overlapping CIDR blocks between attached VPCs (routing is controlled by route maps). Leave empty for the de..."`
	// Resource group ID for organizational access control. Leave empty to use
	//  the account's default resource group.
	ResourceGroupId string `json:"resource_group_id,omitempty" jsonschema:"Resource group ID for organizational access control. Leave empty to use the account's default resource group."`
	// Tags to apply to the CEN instance resource.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Tags to apply to the CEN instance resource."`
	// Child-instance attachments bundled with this CEN. Each entry attaches a
	//  VPC, VBR (Virtual Border Router), or CCN (Cloud Connect Network) to the
	//  CEN instance, enabling private connectivity between the attached networks.
	Attachments []*AliCloudCenAttachmentInput `json:"attachments,omitempty" jsonschema:"Child-instance attachments bundled with this CEN. Each entry attaches a VPC; VBR (Virtual Border Router); or CCN (Cloud Connect Network) to the CEN instance; enabling private connectivity between the ..."`
}

func (s *AliCloudCenInstanceSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.CenInstanceName == "" {
		return fmt.Errorf("cen_instance_name is required")
	}
	for i, v := range s.Attachments {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("attachments[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *AliCloudCenInstanceSpecInput) applyDefaults() {
}

func (s *AliCloudCenInstanceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["cen_instance_name"] = s.CenInstanceName
	if s.Description != "" {
		m["description"] = s.Description
	}
	if s.ProtectionLevel != "" {
		m["protection_level"] = s.ProtectionLevel
	}
	if s.ResourceGroupId != "" {
		m["resource_group_id"] = s.ResourceGroupId
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	if len(s.Attachments) > 0 {
		items := make([]any, len(s.Attachments))
		for i, v := range s.Attachments {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["attachments"] = items
	}
	return m
}

// AliCloudCenAttachment attaches a single child instance (VPC, VBR, or CCN)
//
//	to the parent CEN instance. Each attachment creates an
//	alicloud_cen_instance_attachment resource in the provider.
type AliCloudCenAttachmentInput struct {
	// ID of the child instance to attach. For VPCs this is the vpc_id; for VBRs
	//  the vbr_id; for CCNs the ccn_id. When the child is a VPC managed by
	//  OpenMCF, use valueFrom to reference its output.
	ChildInstanceId string `json:"child_instance_id" jsonschema:"required,ID of the child instance to attach. For VPCs this is the vpc_id; for VBRs the vbr_id; for CCNs the ccn_id. When the child is a VPC managed by OpenMCF; use valueFrom to reference its output."`
	// Type of the child instance being attached.
	//  Default: "VPC"
	ChildInstanceType string `json:"child_instance_type,omitempty" jsonschema:"Type of the child instance being attached. Default: 'VPC'"`
	// Region of the child instance. Required because CEN is global and the
	//  attached child instance can reside in any region.
	//  Examples: "cn-hangzhou", "us-west-1", "eu-central-1".
	ChildInstanceRegionId string `json:"child_instance_region_id" jsonschema:"required,Region of the child instance. Required because CEN is global and the attached child instance can reside in any region. Examples: 'cn-hangzhou'; 'us-west-1'; 'eu-central-1'."`
}

func (s *AliCloudCenAttachmentInput) validate() error {
	if s.ChildInstanceId == "" {
		return fmt.Errorf("child_instance_id is required")
	}
	if s.ChildInstanceRegionId == "" {
		return fmt.Errorf("child_instance_region_id is required")
	}
	return nil
}

func (s *AliCloudCenAttachmentInput) applyDefaults() {
	if s.ChildInstanceType == "" {
		s.ChildInstanceType = "VPC"
	}
}

func (s *AliCloudCenAttachmentInput) toMap() map[string]any {
	m := make(map[string]any)
	m["child_instance_id"] = s.ChildInstanceId
	if s.ChildInstanceType != "" {
		m["child_instance_type"] = s.ChildInstanceType
	}
	m["child_instance_region_id"] = s.ChildInstanceRegionId
	return m
}

// ParseAliCloudCenInstance validates and normalizes a AliCloudCenInstance cloud_object.
func ParseAliCloudCenInstance(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudCenInstance"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudCenInstanceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
