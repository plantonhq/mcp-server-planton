// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-rocketmq-instance
type AliCloudRocketmqInstanceSpecInput struct {
	// Alibaba Cloud region where the RocketMQ instance will be created.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region where the RocketMQ instance will be created. Examples: 'cn-hangzhou'; 'cn-shanghai'; 'us-west-1'; 'ap-southeast-1'."`
	// Instance edition series. Determines feature set and throughput ceiling.
	//  "standard" -- cost-effective for light workloads (dev/test).
	//  "professional" -- production workloads with higher throughput.
	//  "ultimate" -- mission-critical workloads with the highest throughput.
	//  ForceNew: changing this replac...
	SeriesCode string `json:"series_code" jsonschema:"required,Instance edition series. Determines feature set and throughput ceiling. 'standard' -- cost-effective for light workloads (dev/test). 'professional' -- production workloads with higher throughput. 'ult..."`
	// Instance deployment architecture within the chosen series.
	//  "cluster_ha" -- multi-node cluster with high availability.
	//  "single_node" -- single node for development and testing.
	//  "serverless" -- auto-scaling serverless deployment.
	//  ForceNew: changing this replaces the instance.
	SubSeriesCode string `json:"sub_series_code" jsonschema:"required,Instance deployment architecture within the chosen series. 'cluster_ha' -- multi-node cluster with high availability. 'single_node' -- single node for development and testing. 'serverless' -- auto-sca..."`
	// VPC ID where the RocketMQ instance is deployed.
	//  ForceNew: changing this replaces the instance.
	VpcId string `json:"vpc_id" jsonschema:"required,VPC ID where the RocketMQ instance is deployed. ForceNew: changing this replaces the instance."`
	// Human-readable instance name. 2-64 characters.
	//  If omitted, defaults to metadata.name.
	InstanceName string `json:"instance_name,omitempty" jsonschema:"Human-readable instance name. 2-64 characters. If omitted; defaults to metadata.name."`
	// Instance description or remark.
	Remark string `json:"remark,omitempty" jsonschema:"Instance description or remark."`
	// Billing method.
	//  "PayAsYouGo" -- pay-as-you-go (post-paid).
	//  "Subscription" -- prepaid with commitment period.
	//  Default: "PayAsYouGo"
	PaymentType string `json:"payment_type,omitempty" jsonschema:"Billing method. 'PayAsYouGo' -- pay-as-you-go (post-paid). 'Subscription' -- prepaid with commitment period. Default: 'PayAsYouGo'"`
	// Subscription period length. Only applicable when payment_type is
	//  "Subscription". Used together with period_unit.
	Period int32 `json:"period,omitempty" jsonschema:"Subscription period length. Only applicable when payment_type is 'Subscription'. Used together with period_unit."`
	// Subscription period unit.
	//  "Month" or "Year". Only applicable when payment_type is "Subscription".
	PeriodUnit string `json:"period_unit,omitempty" jsonschema:"Subscription period unit. 'Month' or 'Year'. Only applicable when payment_type is 'Subscription'."`
	// Enable auto-renewal for Subscription instances.
	AutoRenew bool `json:"auto_renew,omitempty" jsonschema:"Enable auto-renewal for Subscription instances."`
	// Auto-renewal period. Valid values: 1, 2, 3, 6, 12.
	//  Only applicable when auto_renew is true.
	AutoRenewPeriod int32 `json:"auto_renew_period,omitempty" jsonschema:"Auto-renewal period. Valid values: 1; 2; 3; 6; 12. Only applicable when auto_renew is true."`
	// VSwitch ID for the instance's VPC endpoint. When provided, the instance
	//  is placed in this VSwitch's availability zone within the VPC.
	//  For serverless instances, at least two VSwitches are recommended.
	//  ForceNew: changing this replaces the instance.
	VswitchId string `json:"vswitch_id,omitempty" jsonschema:"VSwitch ID for the instance's VPC endpoint. When provided; the instance is placed in this VSwitch's availability zone within the VPC. For serverless instances; at least two VSwitches are recommended. ..."`
	// Security group ID to associate with the instance's VPC endpoint.
	//  ForceNew: changing this replaces the instance.
	SecurityGroupId string `json:"security_group_id,omitempty" jsonschema:"Security group ID to associate with the instance's VPC endpoint. ForceNew: changing this replaces the instance."`
	// Internet access configuration. When omitted, internet access is disabled
	//  and the instance is only accessible within the VPC.
	InternetInfo *AliCloudRocketmqInternetInfoInput `json:"internet_info,omitempty" jsonschema:"Internet access configuration. When omitted; internet access is disabled and the instance is only accessible within the VPC."`
	// Message processing specification that determines the instance's
	//  throughput capacity. Examples: "rmq.s1.micro", "rmq.p2.4xlarge",
	//  "rmq.u2.4xlarge". Required when product_info is set.
	//  The valid values depend on the selected series_code.
	MsgProcessSpec string `json:"msg_process_spec,omitempty" jsonschema:"Message processing specification that determines the instance's throughput capacity. Examples: 'rmq.s1.micro'; 'rmq.p2.4xlarge'; 'rmq.u2.4xlarge'. Required when product_info is set. The valid values d..."`
	// Advanced product configuration for message retention, auto-scaling,
	//  tracing, and encryption at rest. When omitted, provider defaults apply.
	ProductInfo *AliCloudRocketmqProductInfoInput `json:"product_info,omitempty" jsonschema:"Advanced product configuration for message retention; auto-scaling; tracing; and encryption at rest. When omitted; provider defaults apply."`
	// IP addresses or CIDR blocks allowed to access the instance.
	IpWhitelists []string `json:"ip_whitelists,omitempty" jsonschema:"IP addresses or CIDR blocks allowed to access the instance."`
	// Alibaba Cloud resource group ID (per DD05).
	ResourceGroupId string `json:"resource_group_id,omitempty" jsonschema:"Alibaba Cloud resource group ID (per DD05)."`
	// Tags to apply to the RocketMQ instance.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Tags to apply to the RocketMQ instance."`
	// Topics to create within the instance.
	Topics []*AliCloudRocketmqTopicInput `json:"topics,omitempty" jsonschema:"Topics to create within the instance."`
	// Consumer groups to create within the instance.
	ConsumerGroups []*AliCloudRocketmqConsumerGroupInput `json:"consumer_groups,omitempty" jsonschema:"Consumer groups to create within the instance."`
}

func (s *AliCloudRocketmqInstanceSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.SeriesCode == "" {
		return fmt.Errorf("series_code is required")
	}
	if s.SubSeriesCode == "" {
		return fmt.Errorf("sub_series_code is required")
	}
	if s.VpcId == "" {
		return fmt.Errorf("vpc_id is required")
	}
	if s.InternetInfo != nil {
		if err := s.InternetInfo.validate(); err != nil {
			return fmt.Errorf("internet_info: %w", err)
		}
	}
	if s.ProductInfo != nil {
		if err := s.ProductInfo.validate(); err != nil {
			return fmt.Errorf("product_info: %w", err)
		}
	}
	for i, v := range s.Topics {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("topics[%d]: %w", i, err)
			}
		}
	}
	for i, v := range s.ConsumerGroups {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("consumer_groups[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *AliCloudRocketmqInstanceSpecInput) applyDefaults() {
	if s.PaymentType == "" {
		s.PaymentType = "PayAsYouGo"
	}
	if s.InternetInfo != nil {
		s.InternetInfo.applyDefaults()
	}
	if s.ProductInfo != nil {
		s.ProductInfo.applyDefaults()
	}
}

func (s *AliCloudRocketmqInstanceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["series_code"] = s.SeriesCode
	m["sub_series_code"] = s.SubSeriesCode
	m["vpc_id"] = s.VpcId
	if s.InstanceName != "" {
		m["instance_name"] = s.InstanceName
	}
	if s.Remark != "" {
		m["remark"] = s.Remark
	}
	if s.PaymentType != "" {
		m["payment_type"] = s.PaymentType
	}
	if s.Period != 0 {
		m["period"] = s.Period
	}
	if s.PeriodUnit != "" {
		m["period_unit"] = s.PeriodUnit
	}
	if s.AutoRenew {
		m["auto_renew"] = s.AutoRenew
	}
	if s.AutoRenewPeriod != 0 {
		m["auto_renew_period"] = s.AutoRenewPeriod
	}
	if s.VswitchId != "" {
		m["vswitch_id"] = s.VswitchId
	}
	if s.SecurityGroupId != "" {
		m["security_group_id"] = s.SecurityGroupId
	}
	if s.InternetInfo != nil {
		m["internet_info"] = s.InternetInfo.toMap()
	}
	if s.MsgProcessSpec != "" {
		m["msg_process_spec"] = s.MsgProcessSpec
	}
	if s.ProductInfo != nil {
		m["product_info"] = s.ProductInfo.toMap()
	}
	if len(s.IpWhitelists) > 0 {
		m["ip_whitelists"] = s.IpWhitelists
	}
	if s.ResourceGroupId != "" {
		m["resource_group_id"] = s.ResourceGroupId
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	if len(s.Topics) > 0 {
		items := make([]any, len(s.Topics))
		for i, v := range s.Topics {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["topics"] = items
	}
	if len(s.ConsumerGroups) > 0 {
		items := make([]any, len(s.ConsumerGroups))
		for i, v := range s.ConsumerGroups {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["consumer_groups"] = items
	}
	return m
}

// AliCloudRocketmqConsumeRetryPolicy configures how failed messages are
//
//	retried before being sent to the dead-letter topic.
type AliCloudRocketmqConsumeRetryPolicyInput struct {
	// Retry strategy.
	//  "DefaultRetryPolicy" -- exponential backoff (recommended).
	//  "FixedRetryPolicy" -- fixed interval between retries.
	//  Default: "DefaultRetryPolicy"
	RetryPolicy string `json:"retry_policy,omitempty" jsonschema:"Retry strategy. 'DefaultRetryPolicy' -- exponential backoff (recommended). 'FixedRetryPolicy' -- fixed interval between retries. Default: 'DefaultRetryPolicy'"`
	// Maximum number of retry attempts. Range: 0-1000.
	//  Default: 16 (provider default).
	MaxRetryTimes int32 `json:"max_retry_times,omitempty" jsonschema:"Maximum number of retry attempts. Range: 0-1000. Default: 16 (provider default)."`
	// Dead-letter topic name. When a message exhausts all retries, it is
	//  delivered to this topic for manual investigation.
	DeadLetterTargetTopic string `json:"dead_letter_target_topic,omitempty" jsonschema:"Dead-letter topic name. When a message exhausts all retries; it is delivered to this topic for manual investigation."`
}

func (s *AliCloudRocketmqConsumeRetryPolicyInput) validate() error {
	return nil
}

func (s *AliCloudRocketmqConsumeRetryPolicyInput) applyDefaults() {
	if s.RetryPolicy == "" {
		s.RetryPolicy = "DefaultRetryPolicy"
	}
}

func (s *AliCloudRocketmqConsumeRetryPolicyInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.RetryPolicy != "" {
		m["retry_policy"] = s.RetryPolicy
	}
	if s.MaxRetryTimes != 0 {
		m["max_retry_times"] = s.MaxRetryTimes
	}
	if s.DeadLetterTargetTopic != "" {
		m["dead_letter_target_topic"] = s.DeadLetterTargetTopic
	}
	return m
}

// AliCloudRocketmqConsumerGroup defines a consumer group within the instance.
type AliCloudRocketmqConsumerGroupInput struct {
	// Consumer group ID. Must be unique within the instance.
	//  ForceNew: changing this replaces the consumer group.
	ConsumerGroupId string `json:"consumer_group_id" jsonschema:"required,Consumer group ID. Must be unique within the instance. ForceNew: changing this replaces the consumer group."`
	// Message delivery order type.
	//  "Concurrently" -- messages delivered in parallel (higher throughput).
	//  "Orderly" -- messages delivered in order per message group.
	DeliveryOrderType string `json:"delivery_order_type,omitempty" jsonschema:"Message delivery order type. 'Concurrently' -- messages delivered in parallel (higher throughput). 'Orderly' -- messages delivered in order per message group."`
	// Human-readable description of the consumer group's purpose.
	Remark string `json:"remark,omitempty" jsonschema:"Human-readable description of the consumer group's purpose."`
	// Maximum receive TPS for the consumer group.
	MaxReceiveTps int32 `json:"max_receive_tps,omitempty" jsonschema:"Maximum receive TPS for the consumer group."`
	// Retry policy for failed message consumption. When omitted, defaults to
	//  DefaultRetryPolicy with 16 retries.
	ConsumeRetryPolicy *AliCloudRocketmqConsumeRetryPolicyInput `json:"consume_retry_policy,omitempty" jsonschema:"Retry policy for failed message consumption. When omitted; defaults to DefaultRetryPolicy with 16 retries."`
}

func (s *AliCloudRocketmqConsumerGroupInput) validate() error {
	if s.ConsumerGroupId == "" {
		return fmt.Errorf("consumer_group_id is required")
	}
	if s.ConsumeRetryPolicy != nil {
		if err := s.ConsumeRetryPolicy.validate(); err != nil {
			return fmt.Errorf("consume_retry_policy: %w", err)
		}
	}
	return nil
}

func (s *AliCloudRocketmqConsumerGroupInput) applyDefaults() {
	if s.ConsumeRetryPolicy != nil {
		s.ConsumeRetryPolicy.applyDefaults()
	}
}

func (s *AliCloudRocketmqConsumerGroupInput) toMap() map[string]any {
	m := make(map[string]any)
	m["consumer_group_id"] = s.ConsumerGroupId
	if s.DeliveryOrderType != "" {
		m["delivery_order_type"] = s.DeliveryOrderType
	}
	if s.Remark != "" {
		m["remark"] = s.Remark
	}
	if s.MaxReceiveTps != 0 {
		m["max_receive_tps"] = s.MaxReceiveTps
	}
	if s.ConsumeRetryPolicy != nil {
		m["consume_retry_policy"] = s.ConsumeRetryPolicy.toMap()
	}
	return m
}

// AliCloudRocketmqInternetInfo configures public internet access for the
//
//	RocketMQ instance. All fields in this message are ForceNew in the provider.
type AliCloudRocketmqInternetInfoInput struct {
	// Enable public internet access. When true, the instance gets a public
	//  endpoint in addition to the VPC endpoint.
	//  Default: false (internet disabled)
	Enabled bool `json:"enabled,omitempty" jsonschema:"Enable public internet access. When true; the instance gets a public endpoint in addition to the VPC endpoint. Default: false (internet disabled)"`
	// Billing type for public network outbound traffic. Only relevant when
	//  enabled is true.
	//  "payByBandwidth" -- fixed bandwidth billing (set flow_out_bandwidth).
	//  "payByTraffic" -- usage-based traffic billing.
	//  Default: "payByTraffic"
	FlowOutType string `json:"flow_out_type,omitempty" jsonschema:"Billing type for public network outbound traffic. Only relevant when enabled is true. 'payByBandwidth' -- fixed bandwidth billing (set flow_out_bandwidth). 'payByTraffic' -- usage-based traffic billin..."`
	// Public network bandwidth in Mb/s. Range: 1-1000.
	//  Only applicable when flow_out_type is "payByBandwidth".
	FlowOutBandwidth int32 `json:"flow_out_bandwidth,omitempty" jsonschema:"Public network bandwidth in Mb/s. Range: 1-1000. Only applicable when flow_out_type is 'payByBandwidth'."`
}

func (s *AliCloudRocketmqInternetInfoInput) validate() error {
	return nil
}

func (s *AliCloudRocketmqInternetInfoInput) applyDefaults() {
	if s.FlowOutType == "" {
		s.FlowOutType = "payByTraffic"
	}
}

func (s *AliCloudRocketmqInternetInfoInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Enabled {
		m["enabled"] = s.Enabled
	}
	if s.FlowOutType != "" {
		m["flow_out_type"] = s.FlowOutType
	}
	if s.FlowOutBandwidth != 0 {
		m["flow_out_bandwidth"] = s.FlowOutBandwidth
	}
	return m
}

// AliCloudRocketmqProductInfo contains advanced product configuration for
//
//	message retention, scaling, tracing, and encryption.
type AliCloudRocketmqProductInfoInput struct {
	// Duration of message retention in hours. Controls how long messages are
	//  stored before expiration. Longer retention increases storage costs.
	MessageRetentionTime int32 `json:"message_retention_time,omitempty" jsonschema:"Duration of message retention in hours. Controls how long messages are stored before expiration. Longer retention increases storage costs."`
	// Ratio of message send to receive capacity. Range: 0.2-0.5.
	SendReceiveRatio float64 `json:"send_receive_ratio,omitempty" jsonschema:"Ratio of message send to receive capacity. Range: 0.2-0.5."`
	// Enable auto-scaling of throughput capacity.
	AutoScaling bool `json:"auto_scaling,omitempty" jsonschema:"Enable auto-scaling of throughput capacity."`
	// Enable message trace functionality for debugging and monitoring
	//  message flows.
	TraceOn bool `json:"trace_on,omitempty" jsonschema:"Enable message trace functionality for debugging and monitoring message flows."`
	// Enable encryption at rest for stored messages.
	//  ForceNew: changing this replaces the instance.
	StorageEncryption bool `json:"storage_encryption,omitempty" jsonschema:"Enable encryption at rest for stored messages. ForceNew: changing this replaces the instance."`
	// KMS key for encryption at rest. Only applicable when
	//  storage_encryption is true.
	//  ForceNew: changing this replaces the instance.
	StorageSecretKey string `json:"storage_secret_key,omitempty" jsonschema:"KMS key for encryption at rest. Only applicable when storage_encryption is true. ForceNew: changing this replaces the instance."`
}

func (s *AliCloudRocketmqProductInfoInput) validate() error {
	return nil
}

func (s *AliCloudRocketmqProductInfoInput) applyDefaults() {
}

func (s *AliCloudRocketmqProductInfoInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.MessageRetentionTime != 0 {
		m["message_retention_time"] = s.MessageRetentionTime
	}
	if s.SendReceiveRatio != 0 {
		m["send_receive_ratio"] = s.SendReceiveRatio
	}
	if s.AutoScaling {
		m["auto_scaling"] = s.AutoScaling
	}
	if s.TraceOn {
		m["trace_on"] = s.TraceOn
	}
	if s.StorageEncryption {
		m["storage_encryption"] = s.StorageEncryption
	}
	if s.StorageSecretKey != "" {
		m["storage_secret_key"] = s.StorageSecretKey
	}
	return m
}

// AliCloudRocketmqTopic defines a topic to create within the instance.
type AliCloudRocketmqTopicInput struct {
	// Topic name. Must match ^[%a-zA-Z0-9_-]+$ and be unique within the
	//  instance. ForceNew: changing this replaces the topic.
	TopicName string `json:"topic_name" jsonschema:"required,Topic name. Must match ^[%a-zA-Z0-9_-]+$ and be unique within the instance. ForceNew: changing this replaces the topic."`
	// Message type determines how messages in this topic are processed.
	//  "NORMAL" -- standard messages with no ordering guarantee.
	//  "FIFO" -- messages delivered in strict FIFO order.
	//  "DELAY" -- messages delivered after a configurable delay.
	//  "TRANSACTION" -- messages with two-phase commit semantics.
	//  Def...
	MessageType string `json:"message_type,omitempty" jsonschema:"Message type determines how messages in this topic are processed. 'NORMAL' -- standard messages with no ordering guarantee. 'FIFO' -- messages delivered in strict FIFO order. 'DELAY' -- messages deliv..."`
	// Human-readable description of the topic's purpose.
	Remark string `json:"remark,omitempty" jsonschema:"Human-readable description of the topic's purpose."`
	// Maximum send TPS (transactions per second) for the topic.
	MaxSendTps int32 `json:"max_send_tps,omitempty" jsonschema:"Maximum send TPS (transactions per second) for the topic."`
}

func (s *AliCloudRocketmqTopicInput) validate() error {
	if s.TopicName == "" {
		return fmt.Errorf("topic_name is required")
	}
	return nil
}

func (s *AliCloudRocketmqTopicInput) applyDefaults() {
	if s.MessageType == "" {
		s.MessageType = "NORMAL"
	}
}

func (s *AliCloudRocketmqTopicInput) toMap() map[string]any {
	m := make(map[string]any)
	m["topic_name"] = s.TopicName
	if s.MessageType != "" {
		m["message_type"] = s.MessageType
	}
	if s.Remark != "" {
		m["remark"] = s.Remark
	}
	if s.MaxSendTps != 0 {
		m["max_send_tps"] = s.MaxSendTps
	}
	return m
}

// ParseAliCloudRocketmqInstance validates and normalizes a AliCloudRocketmqInstance cloud_object.
func ParseAliCloudRocketmqInstance(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudRocketmqInstance"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudRocketmqInstanceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
