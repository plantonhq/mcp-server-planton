// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-container-registry
type AliCloudContainerRegistrySpecInput struct {
	// Alibaba Cloud region where the registry instance will be created.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region where the registry instance will be created. Examples: 'cn-hangzhou'; 'cn-shanghai'; 'us-west-1'; 'ap-southeast-1'."`
	// Registry instance name. This is the human-readable identifier for the
	//  ACR Enterprise Edition instance.
	InstanceName string `json:"instance_name" jsonschema:"required,Registry instance name. This is the human-readable identifier for the ACR Enterprise Edition instance."`
	// Tier of the ACR Enterprise Edition instance.
	//  Basic: suitable for individual developers or small teams.
	//  Standard: suitable for small and medium enterprises.
	//  Advanced: suitable for large enterprises with geo-replication needs.
	//
	//  The instance type is immutable after creation (ForceNew in the provide...
	InstanceType string `json:"instance_type" jsonschema:"required,Tier of the ACR Enterprise Edition instance. Basic: suitable for individual developers or small teams. Standard: suitable for small and medium enterprises. Advanced: suitable for large enterprises wit..."`
	// Payment model for the registry instance.
	//  Subscription: pre-paid monthly/yearly billing (lower cost for long-term use).
	//  PayAsYouGo: post-paid usage-based billing (flexible for dev/test).
	//
	//  Immutable after creation (ForceNew in the provider).
	//  Default: "Subscription"
	PaymentType string `json:"payment_type,omitempty" jsonschema:"Payment model for the registry instance. Subscription: pre-paid monthly/yearly billing (lower cost for long-term use). PayAsYouGo: post-paid usage-based billing (flexible for dev/test). Immutable afte..."`
	// Subscription period in months. Only applies when payment_type is
	//  "Subscription". Common values: 1, 3, 6, 12.
	Period int32 `json:"period,omitempty" jsonschema:"Subscription period in months. Only applies when payment_type is 'Subscription'. Common values: 1; 3; 6; 12."`
	// Login password for the registry instance. Used for authenticating
	//  docker login / image push and pull operations.
	//  8-32 characters.
	Password string `json:"password,omitempty" jsonschema:"Login password for the registry instance. Used for authenticating docker login / image push and pull operations. 8-32 characters."`
	// Alibaba Cloud resource group ID for organizational grouping (per DD05).
	//  If omitted, the instance is placed in the account's default resource group.
	ResourceGroupId string `json:"resource_group_id,omitempty" jsonschema:"Alibaba Cloud resource group ID for organizational grouping (per DD05). If omitted; the instance is placed in the account's default resource group."`
	// Namespaces to create within the registry instance.
	//  Namespaces are the top-level organizational units for container images.
	//  Images are addressed as: {registry-endpoint}/{namespace}/{repo}:{tag}
	Namespaces []*AliCloudContainerRegistryNamespaceInput `json:"namespaces,omitempty" jsonschema:"Namespaces to create within the registry instance. Namespaces are the top-level organizational units for container images. Images are addressed as: {registry-endpoint}/{namespace}/{repo}:{tag}"`
}

func (s *AliCloudContainerRegistrySpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.InstanceName == "" {
		return fmt.Errorf("instance_name is required")
	}
	if s.InstanceType == "" {
		return fmt.Errorf("instance_type is required")
	}
	for i, v := range s.Namespaces {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("namespaces[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *AliCloudContainerRegistrySpecInput) applyDefaults() {
	if s.PaymentType == "" {
		s.PaymentType = "Subscription"
	}
}

func (s *AliCloudContainerRegistrySpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["instance_name"] = s.InstanceName
	m["instance_type"] = s.InstanceType
	if s.PaymentType != "" {
		m["payment_type"] = s.PaymentType
	}
	if s.Period != 0 {
		m["period"] = s.Period
	}
	if s.Password != "" {
		m["password"] = s.Password
	}
	if s.ResourceGroupId != "" {
		m["resource_group_id"] = s.ResourceGroupId
	}
	if len(s.Namespaces) > 0 {
		items := make([]any, len(s.Namespaces))
		for i, v := range s.Namespaces {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["namespaces"] = items
	}
	return m
}

// AliCloudContainerRegistryNamespace defines a namespace within the ACR
//
//	Enterprise Edition instance.
//
//	Namespaces group related image repositories. A typical pattern is one
//	namespace per team or application (e.g., "platform", "frontend", "backend").
type AliCloudContainerRegistryNamespaceInput struct {
	// Namespace name. 2-120 characters; can contain lowercase letters, digits,
	//  underscores, hyphens, and periods. Cannot start or end with a delimiter.
	Name string `json:"name" jsonschema:"required,Namespace name. 2-120 characters; can contain lowercase letters; digits; underscores; hyphens; and periods. Cannot start or end with a delimiter."`
	// When true, image repositories are automatically created within this
	//  namespace when an image is pushed to a repository that does not yet exist.
	//  This is convenient for CI/CD pipelines that push to dynamic repository names.
	//  Default: false
	AutoCreate bool `json:"auto_create,omitempty" jsonschema:"When true; image repositories are automatically created within this namespace when an image is pushed to a repository that does not yet exist. This is convenient for CI/CD pipelines that push to dynam..."`
	// Default visibility for repositories auto-created within this namespace.
	//  PUBLIC: anyone can pull images (no authentication required).
	//  PRIVATE: only authenticated users with access can pull images.
	//  Default: "PRIVATE"
	DefaultVisibility string `json:"default_visibility,omitempty" jsonschema:"Default visibility for repositories auto-created within this namespace. PUBLIC: anyone can pull images (no authentication required). PRIVATE: only authenticated users with access can pull images. Defa..."`
}

func (s *AliCloudContainerRegistryNamespaceInput) validate() error {
	if s.Name == "" {
		return fmt.Errorf("name is required")
	}
	return nil
}

func (s *AliCloudContainerRegistryNamespaceInput) applyDefaults() {
	if s.DefaultVisibility == "" {
		s.DefaultVisibility = "PRIVATE"
	}
}

func (s *AliCloudContainerRegistryNamespaceInput) toMap() map[string]any {
	m := make(map[string]any)
	m["name"] = s.Name
	if s.AutoCreate {
		m["auto_create"] = s.AutoCreate
	}
	if s.DefaultVisibility != "" {
		m["default_visibility"] = s.DefaultVisibility
	}
	return m
}

// ParseAliCloudContainerRegistry validates and normalizes a AliCloudContainerRegistry cloud_object.
func ParseAliCloudContainerRegistry(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudContainerRegistry"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudContainerRegistrySpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
