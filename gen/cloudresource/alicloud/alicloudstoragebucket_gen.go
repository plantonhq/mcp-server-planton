// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:50:56+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-storage-bucket
type AliCloudStorageBucketSpecInput struct {
	// Alibaba Cloud region where the bucket will be created.
	//  The region determines the physical location of stored data and the
	//  available endpoints.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region where the bucket will be created. The region determines the physical location of stored data and the available endpoints. Examples: 'cn-hangzhou'; 'cn-shanghai'; 'us-west-1'; 'ap-..."`
	// Globally unique bucket name. Must be 3-63 characters, lowercase letters,
	//  digits, and hyphens only. Cannot start or end with a hyphen.
	//  OSS uses the bucket name as the resource ID.
	BucketName string `json:"bucket_name" jsonschema:"required,Globally unique bucket name. Must be 3-63 characters; lowercase letters; digits; and hyphens only. Cannot start or end with a hyphen. OSS uses the bucket name as the resource ID."`
	// Bucket access control list.
	//  Controls the default access permissions for all objects in the bucket.
	//
	//  Uses the provider's exact values: "private", "public-read", "public-read-write".
	//  Default: "private"
	Acl string `json:"acl,omitempty" jsonschema:"Bucket access control list. Controls the default access permissions for all objects in the bucket. Uses the provider's exact values: 'private'; 'public-read'; 'public-read-write'. Default: 'private'"`
	// Storage class for the bucket. Determines cost, availability, and access
	//  latency characteristics. This is immutable after creation (ForceNew).
	//
	//  Uses the provider's exact values:
	//    "Standard"      -- frequent access, highest cost, lowest latency
	//    "IA"            -- infrequent access, lower cost, ...
	StorageClass string `json:"storage_class,omitempty" jsonschema:"Storage class for the bucket. Determines cost; availability; and access latency characteristics. This is immutable after creation (ForceNew). Uses the provider's exact values: 'Standard' -- frequent a..."`
	// Data redundancy type. Controls how data is replicated within the region.
	//  This is immutable after creation (ForceNew).
	//
	//    "LRS" -- Locally Redundant Storage: 3 copies in a single zone
	//    "ZRS" -- Zone-Redundant Storage: 3 copies across multiple zones
	//  Default: "LRS"
	RedundancyType string `json:"redundancy_type,omitempty" jsonschema:"Data redundancy type. Controls how data is replicated within the region. This is immutable after creation (ForceNew). 'LRS' -- Locally Redundant Storage: 3 copies in a single zone 'ZRS' -- Zone-Redund..."`
	// Enable object versioning on this bucket.
	//  When true, OSS preserves all versions of every object, allowing recovery
	//  from accidental overwrites or deletes. Combine with
	//  lifecycle_rules.noncurrent_version_expiration_days to control version
	//  retention costs.
	//  Default: false
	VersioningEnabled bool `json:"versioning_enabled,omitempty" jsonschema:"Enable object versioning on this bucket. When true; OSS preserves all versions of every object; allowing recovery from accidental overwrites or deletes. Combine with lifecycle_rules.noncurrent_version..."`
	// Server-side encryption configuration.
	//  When set, all objects stored in this bucket are encrypted at rest using
	//  the specified algorithm. Omit to store objects without default encryption.
	ServerSideEncryption *AliCloudStorageBucketEncryptionInput `json:"server_side_encryption,omitempty" jsonschema:"Server-side encryption configuration. When set; all objects stored in this bucket are encrypted at rest using the specified algorithm. Omit to store objects without default encryption."`
	// Lifecycle management rules for automatic object transitions and expiration.
	//  Rules are evaluated independently; multiple rules can match the same object.
	//  Maximum 1000 rules per bucket.
	LifecycleRules []*AliCloudStorageBucketLifecycleRuleInput `json:"lifecycle_rules,omitempty" jsonschema:"Lifecycle management rules for automatic object transitions and expiration. Rules are evaluated independently; multiple rules can match the same object. Maximum 1000 rules per bucket."`
	// Cross-Origin Resource Sharing rules.
	//  Required when browser-based clients need to access OSS directly.
	//  Maximum 10 rules per bucket.
	CorsRules []*AliCloudStorageBucketCorsRuleInput `json:"cors_rules,omitempty" jsonschema:"Cross-Origin Resource Sharing rules. Required when browser-based clients need to access OSS directly. Maximum 10 rules per bucket."`
	// Server access logging configuration.
	//  When set, OSS writes access logs to the specified target bucket.
	//  Omit to disable access logging.
	Logging *AliCloudStorageBucketLoggingInput `json:"logging,omitempty" jsonschema:"Server access logging configuration. When set; OSS writes access logs to the specified target bucket. Omit to disable access logging."`
	// Allow force-destroying a non-empty bucket.
	//  When true, Terraform/Pulumi will delete all objects in the bucket before
	//  destroying it. Use with caution in production.
	//  Default: false
	ForceDestroy bool `json:"force_destroy,omitempty" jsonschema:"Allow force-destroying a non-empty bucket. When true; Terraform/Pulumi will delete all objects in the bucket before destroying it. Use with caution in production. Default: false"`
	// Alibaba Cloud resource group ID for organizational grouping (per DD05).
	//  If omitted, the bucket is placed in the account's default resource group.
	ResourceGroupId string `json:"resource_group_id,omitempty" jsonschema:"Alibaba Cloud resource group ID for organizational grouping (per DD05). If omitted; the bucket is placed in the account's default resource group."`
	// Tags to apply to the bucket.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Tags to apply to the bucket."`
}

func (s *AliCloudStorageBucketSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.BucketName == "" {
		return fmt.Errorf("bucket_name is required")
	}
	if s.ServerSideEncryption != nil {
		if err := s.ServerSideEncryption.validate(); err != nil {
			return fmt.Errorf("server_side_encryption: %w", err)
		}
	}
	for i, v := range s.LifecycleRules {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("lifecycle_rules[%d]: %w", i, err)
			}
		}
	}
	for i, v := range s.CorsRules {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("cors_rules[%d]: %w", i, err)
			}
		}
	}
	if s.Logging != nil {
		if err := s.Logging.validate(); err != nil {
			return fmt.Errorf("logging: %w", err)
		}
	}
	return nil
}

func (s *AliCloudStorageBucketSpecInput) applyDefaults() {
	if s.Acl == "" {
		s.Acl = "private"
	}
	if s.StorageClass == "" {
		s.StorageClass = "Standard"
	}
	if s.RedundancyType == "" {
		s.RedundancyType = "LRS"
	}
	if s.ServerSideEncryption != nil {
		s.ServerSideEncryption.applyDefaults()
	}
	if s.Logging != nil {
		s.Logging.applyDefaults()
	}
}

func (s *AliCloudStorageBucketSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["bucket_name"] = s.BucketName
	if s.Acl != "" {
		m["acl"] = s.Acl
	}
	if s.StorageClass != "" {
		m["storage_class"] = s.StorageClass
	}
	if s.RedundancyType != "" {
		m["redundancy_type"] = s.RedundancyType
	}
	if s.VersioningEnabled {
		m["versioning_enabled"] = s.VersioningEnabled
	}
	if s.ServerSideEncryption != nil {
		m["server_side_encryption"] = s.ServerSideEncryption.toMap()
	}
	if len(s.LifecycleRules) > 0 {
		items := make([]any, len(s.LifecycleRules))
		for i, v := range s.LifecycleRules {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["lifecycle_rules"] = items
	}
	if len(s.CorsRules) > 0 {
		items := make([]any, len(s.CorsRules))
		for i, v := range s.CorsRules {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["cors_rules"] = items
	}
	if s.Logging != nil {
		m["logging"] = s.Logging.toMap()
	}
	if s.ForceDestroy {
		m["force_destroy"] = s.ForceDestroy
	}
	if s.ResourceGroupId != "" {
		m["resource_group_id"] = s.ResourceGroupId
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	return m
}

// CORS rule for browser-based cross-origin access to an OSS bucket.
type AliCloudStorageBucketCorsRuleInput struct {
	// Origins allowed to make cross-origin requests. Use "*" to allow all origins.
	//  Example: ["https://example.com", "https://app.example.com"]
	AllowedOrigins []string `json:"allowed_origins,omitempty" jsonschema:"Origins allowed to make cross-origin requests. Use '*' to allow all origins. Example: ['https://example.com'; 'https://app.example.com']"`
	// HTTP methods allowed for cross-origin requests.
	//  Valid values: GET, PUT, POST, DELETE, HEAD
	AllowedMethods []string `json:"allowed_methods,omitempty" jsonschema:"HTTP methods allowed for cross-origin requests. Valid values: GET; PUT; POST; DELETE; HEAD"`
	// Request headers that are allowed in a preflight OPTIONS request.
	//  Use "*" to allow all headers.
	AllowedHeaders []string `json:"allowed_headers,omitempty" jsonschema:"Request headers that are allowed in a preflight OPTIONS request. Use '*' to allow all headers."`
	// Response headers that the browser is allowed to access.
	//  Example: ["x-oss-request-id", "ETag"]
	ExposeHeaders []string `json:"expose_headers,omitempty" jsonschema:"Response headers that the browser is allowed to access. Example: ['x-oss-request-id'; 'ETag']"`
	// Maximum time (in seconds) that the browser should cache the preflight
	//  response. Reduces the number of OPTIONS requests for repeated access.
	MaxAgeSeconds int32 `json:"max_age_seconds,omitempty" jsonschema:"Maximum time (in seconds) that the browser should cache the preflight response. Reduces the number of OPTIONS requests for repeated access."`
}

func (s *AliCloudStorageBucketCorsRuleInput) validate() error {
	if len(s.AllowedOrigins) < 1 {
		return fmt.Errorf("allowed_origins requires at least 1 items, got %d", len(s.AllowedOrigins))
	}
	if len(s.AllowedMethods) < 1 {
		return fmt.Errorf("allowed_methods requires at least 1 items, got %d", len(s.AllowedMethods))
	}
	return nil
}

func (s *AliCloudStorageBucketCorsRuleInput) applyDefaults() {
}

func (s *AliCloudStorageBucketCorsRuleInput) toMap() map[string]any {
	m := make(map[string]any)
	if len(s.AllowedOrigins) > 0 {
		m["allowed_origins"] = s.AllowedOrigins
	}
	if len(s.AllowedMethods) > 0 {
		m["allowed_methods"] = s.AllowedMethods
	}
	if len(s.AllowedHeaders) > 0 {
		m["allowed_headers"] = s.AllowedHeaders
	}
	if len(s.ExposeHeaders) > 0 {
		m["expose_headers"] = s.ExposeHeaders
	}
	if s.MaxAgeSeconds != 0 {
		m["max_age_seconds"] = s.MaxAgeSeconds
	}
	return m
}

// Server-side encryption configuration for an OSS bucket.
type AliCloudStorageBucketEncryptionInput struct {
	// Encryption algorithm.
	//  "AES256" uses OSS-managed keys (no additional configuration needed).
	//  "KMS" uses Alibaba Cloud KMS; optionally specify kms_master_key_id for
	//  a customer-managed key, or omit for the OSS default KMS key.
	SseAlgorithm string `json:"sse_algorithm" jsonschema:"required,Encryption algorithm. 'AES256' uses OSS-managed keys (no additional configuration needed). 'KMS' uses Alibaba Cloud KMS; optionally specify kms_master_key_id for a customer-managed key; or omit for th..."`
	// KMS master key ID for customer-managed encryption.
	//  Only applicable when sse_algorithm is "KMS". When omitted with KMS,
	//  OSS uses the default service key.
	KmsMasterKeyId string `json:"kms_master_key_id,omitempty" jsonschema:"KMS master key ID for customer-managed encryption. Only applicable when sse_algorithm is 'KMS'. When omitted with KMS; OSS uses the default service key."`
}

func (s *AliCloudStorageBucketEncryptionInput) validate() error {
	if s.SseAlgorithm == "" {
		return fmt.Errorf("sse_algorithm is required")
	}
	return nil
}

func (s *AliCloudStorageBucketEncryptionInput) applyDefaults() {
}

func (s *AliCloudStorageBucketEncryptionInput) toMap() map[string]any {
	m := make(map[string]any)
	m["sse_algorithm"] = s.SseAlgorithm
	if s.KmsMasterKeyId != "" {
		m["kms_master_key_id"] = s.KmsMasterKeyId
	}
	return m
}

// A lifecycle rule for automatic object management within an OSS bucket.
//
//	Each rule applies to objects matching the given prefix. At least one action
//	(expiration, transition, abort multipart upload, or noncurrent version
//	expiration) should be configured for the rule to be meaningful.
type AliCloudStorageBucketLifecycleRuleInput struct {
	// Object name prefix that scopes this rule. An empty prefix applies
	//  the rule to all objects in the bucket.
	Prefix string `json:"prefix,omitempty" jsonschema:"Object name prefix that scopes this rule. An empty prefix applies the rule to all objects in the bucket."`
	// Whether this rule is active. Disabled rules are retained but not evaluated.
	Enabled bool `json:"enabled,omitempty" jsonschema:"Whether this rule is active. Disabled rules are retained but not evaluated."`
	// Number of days after object creation to expire (permanently delete) objects.
	//  Set to 0 to skip expiration. Only one of date-based or days-based expiration
	//  can be active; this component exposes the days-based approach as the standard
	//  pattern.
	ExpirationDays int32 `json:"expiration_days,omitempty" jsonschema:"Number of days after object creation to expire (permanently delete) objects. Set to 0 to skip expiration. Only one of date-based or days-based expiration can be active; this component exposes the days..."`
	// Storage class transitions. Objects are moved to a cheaper storage tier
	//  after the specified number of days.
	Transitions []*AliCloudStorageBucketLifecycleTransitionInput `json:"transitions,omitempty" jsonschema:"Storage class transitions. Objects are moved to a cheaper storage tier after the specified number of days."`
	// Number of days after which incomplete multipart uploads are automatically
	//  aborted. This prevents orphaned upload parts from consuming storage.
	//  Recommended: 7 days for most workloads.
	AbortMultipartUploadDays int32 `json:"abort_multipart_upload_days,omitempty" jsonschema:"Number of days after which incomplete multipart uploads are automatically aborted. This prevents orphaned upload parts from consuming storage. Recommended: 7 days for most workloads."`
	// Number of days after which noncurrent object versions are expired.
	//  Only meaningful when versioning is enabled on the bucket.
	//  Recommended: 30-90 days depending on recovery requirements.
	NoncurrentVersionExpirationDays int32 `json:"noncurrent_version_expiration_days,omitempty" jsonschema:"Number of days after which noncurrent object versions are expired. Only meaningful when versioning is enabled on the bucket. Recommended: 30-90 days depending on recovery requirements."`
}

func (s *AliCloudStorageBucketLifecycleRuleInput) validate() error {
	for i, v := range s.Transitions {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("transitions[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *AliCloudStorageBucketLifecycleRuleInput) applyDefaults() {
}

func (s *AliCloudStorageBucketLifecycleRuleInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Prefix != "" {
		m["prefix"] = s.Prefix
	}
	if s.Enabled {
		m["enabled"] = s.Enabled
	}
	if s.ExpirationDays != 0 {
		m["expiration_days"] = s.ExpirationDays
	}
	if len(s.Transitions) > 0 {
		items := make([]any, len(s.Transitions))
		for i, v := range s.Transitions {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["transitions"] = items
	}
	if s.AbortMultipartUploadDays != 0 {
		m["abort_multipart_upload_days"] = s.AbortMultipartUploadDays
	}
	if s.NoncurrentVersionExpirationDays != 0 {
		m["noncurrent_version_expiration_days"] = s.NoncurrentVersionExpirationDays
	}
	return m
}

// A storage class transition within a lifecycle rule.
type AliCloudStorageBucketLifecycleTransitionInput struct {
	// Number of days after object creation to transition to the target
	//  storage class.
	Days int32 `json:"days,omitempty" jsonschema:"Number of days after object creation to transition to the target storage class."`
	// Target storage class for the transition.
	//  Transitions must move objects to a colder tier (cost-decreasing order):
	//    Standard -> IA -> Archive -> ColdArchive -> DeepColdArchive
	StorageClass string `json:"storage_class" jsonschema:"required,Target storage class for the transition. Transitions must move objects to a colder tier (cost-decreasing order): Standard -> IA -> Archive -> ColdArchive -> DeepColdArchive"`
}

func (s *AliCloudStorageBucketLifecycleTransitionInput) validate() error {
	if s.StorageClass == "" {
		return fmt.Errorf("storage_class is required")
	}
	return nil
}

func (s *AliCloudStorageBucketLifecycleTransitionInput) applyDefaults() {
}

func (s *AliCloudStorageBucketLifecycleTransitionInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Days != 0 {
		m["days"] = s.Days
	}
	m["storage_class"] = s.StorageClass
	return m
}

// Access logging configuration for an OSS bucket.
type AliCloudStorageBucketLoggingInput struct {
	// Destination bucket for access log objects. Can be the same bucket or a
	//  different bucket in the same region.
	TargetBucket string `json:"target_bucket" jsonschema:"required,Destination bucket for access log objects. Can be the same bucket or a different bucket in the same region."`
	// Key prefix for log objects. Useful for organizing logs within the
	//  target bucket. Example: "logs/my-bucket/"
	TargetPrefix string `json:"target_prefix,omitempty" jsonschema:"Key prefix for log objects. Useful for organizing logs within the target bucket. Example: 'logs/my-bucket/'"`
}

func (s *AliCloudStorageBucketLoggingInput) validate() error {
	if s.TargetBucket == "" {
		return fmt.Errorf("target_bucket is required")
	}
	return nil
}

func (s *AliCloudStorageBucketLoggingInput) applyDefaults() {
}

func (s *AliCloudStorageBucketLoggingInput) toMap() map[string]any {
	m := make(map[string]any)
	m["target_bucket"] = s.TargetBucket
	if s.TargetPrefix != "" {
		m["target_prefix"] = s.TargetPrefix
	}
	return m
}

// ParseAliCloudStorageBucket validates and normalizes a AliCloudStorageBucket cloud_object.
func ParseAliCloudStorageBucket(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudStorageBucket"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudStorageBucketSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
