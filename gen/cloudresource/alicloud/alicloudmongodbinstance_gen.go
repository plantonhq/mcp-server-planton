// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:50:56+05:30

package alicloud

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// alicloud-mongodb-instance
type AliCloudMongodbInstanceSpecInput struct {
	// Alibaba Cloud region where the MongoDB instance will be created.
	//  Examples: "cn-hangzhou", "cn-shanghai", "us-west-1", "ap-southeast-1".
	Region string `json:"region" jsonschema:"required,Alibaba Cloud region where the MongoDB instance will be created. Examples: 'cn-hangzhou'; 'cn-shanghai'; 'us-west-1'; 'ap-southeast-1'."`
	// VSwitch ID where the MongoDB instance is placed. The instance inherits
	//  the VPC and availability zone from the VSwitch.
	VswitchId string `json:"vswitch_id" jsonschema:"required,VSwitch ID where the MongoDB instance is placed. The instance inherits the VPC and availability zone from the VSwitch."`
	// MongoDB engine version. This is a critical architectural choice --
	//  different versions support different features and wire protocols.
	EngineVersion string `json:"engine_version" jsonschema:"required,MongoDB engine version. This is a critical architectural choice -- different versions support different features and wire protocols."`
	// Instance specification class that determines CPU, memory, and IOPS.
	//  Examples: "dds.mongo.mid", "dds.mongo.standard", "mongo.x8.medium",
	//  "mongo.x8.large", "mongo.x8.xlarge".
	//  See Alibaba Cloud documentation for the full list of instance classes.
	DbInstanceClass string `json:"db_instance_class" jsonschema:"required,Instance specification class that determines CPU; memory; and IOPS. Examples: 'dds.mongo.mid'; 'dds.mongo.standard'; 'mongo.x8.medium'; 'mongo.x8.large'; 'mongo.x8.xlarge'. See Alibaba Cloud documenta..."`
	// Storage space in GB. The valid range depends on the instance class and
	//  storage type. Typical values: 10, 20, 50, 100, 200, 500, 1000, 2000.
	DbInstanceStorage int32 `json:"db_instance_storage" jsonschema:"required,Storage space in GB. The valid range depends on the instance class and storage type. Typical values: 10; 20; 50; 100; 200; 500; 1000; 2000."`
	// Root account password. 8-32 characters, must contain at least three of:
	//  uppercase letters, lowercase letters, digits, special characters.
	AccountPassword string `json:"account_password" jsonschema:"required,Root account password. 8-32 characters; must contain at least three of: uppercase letters; lowercase letters; digits; special characters."`
	// Instance display name. 2-256 characters.
	//  If omitted, defaults to the metadata.name.
	DbInstanceName string `json:"db_instance_name,omitempty" jsonschema:"Instance display name. 2-256 characters. If omitted; defaults to the metadata.name."`
	// Primary availability zone ID. If omitted, Alibaba Cloud selects a zone
	//  from the VSwitch's region.
	//  Examples: "cn-hangzhou-a", "cn-shanghai-b".
	ZoneId string `json:"zone_id,omitempty" jsonschema:"Primary availability zone ID. If omitted; Alibaba Cloud selects a zone from the VSwitch's region. Examples: 'cn-hangzhou-a'; 'cn-shanghai-b'."`
	// Secondary availability zone for the standby node. When set together with
	//  zone_id and hidden_zone_id, creates a three-zone high-availability
	//  deployment where each replica-set member runs in a different AZ.
	SecondaryZoneId string `json:"secondary_zone_id,omitempty" jsonschema:"Secondary availability zone for the standby node. When set together with zone_id and hidden_zone_id; creates a three-zone high-availability deployment where each replica-set member runs in a different..."`
	// Availability zone for the hidden node (the third replica-set member used
	//  for elections and backups). Required for full three-zone HA deployments.
	HiddenZoneId string `json:"hidden_zone_id,omitempty" jsonschema:"Availability zone for the hidden node (the third replica-set member used for elections and backups). Required for full three-zone HA deployments."`
	// Number of replica-set nodes. Includes the primary, secondary, and hidden
	//  nodes. Higher values increase read capacity and fault tolerance.
	//  Default: 3
	ReplicationFactor int32 `json:"replication_factor,omitempty" jsonschema:"Number of replica-set nodes. Includes the primary; secondary; and hidden nodes. Higher values increase read capacity and fault tolerance. Default: 3"`
	// Number of read-only replicas (0-5). Read replicas handle read traffic
	//  to reduce load on the primary. Only available for replica-set instances
	//  with replication_factor >= 3.
	ReadonlyReplicas int32 `json:"readonly_replicas,omitempty" jsonschema:"Number of read-only replicas (0-5). Read replicas handle read traffic to reduce load on the primary. Only available for replica-set instances with replication_factor >= 3."`
	// Storage engine. WiredTiger is the default and recommended engine for
	//  most workloads. RocksDB is optimized for write-heavy workloads but is
	//  deprecated in newer MongoDB versions.
	//  Default: "WiredTiger"
	StorageEngine string `json:"storage_engine,omitempty" jsonschema:"Storage engine. WiredTiger is the default and recommended engine for most workloads. RocksDB is optimized for write-heavy workloads but is deprecated in newer MongoDB versions. Default: 'WiredTiger'"`
	// Storage type. Determines the underlying disk technology.
	//  "cloud_essd1" (PL1), "cloud_essd2" (PL2), "cloud_essd3" (PL3) offer
	//  increasing IOPS tiers. "cloud_auto" auto-scales IOPS. "local_ssd"
	//  uses local NVMe disks for lowest latency.
	StorageType string `json:"storage_type,omitempty" jsonschema:"Storage type. Determines the underlying disk technology. 'cloud_essd1' (PL1); 'cloud_essd2' (PL2); 'cloud_essd3' (PL3) offer increasing IOPS tiers. 'cloud_auto' auto-scales IOPS. 'local_ssd' uses loca..."`
	// Provisioned IOPS for cloud storage types. Only applicable when
	//  storage_type is a cloud_essd variant or cloud_auto.
	ProvisionedIops int32 `json:"provisioned_iops,omitempty" jsonschema:"Provisioned IOPS for cloud storage types. Only applicable when storage_type is a cloud_essd variant or cloud_auto."`
	// Billing method. "PostPaid" for pay-as-you-go, "PrePaid" for subscription.
	//  Default: "PostPaid"
	InstanceChargeType string `json:"instance_charge_type,omitempty" jsonschema:"Billing method. 'PostPaid' for pay-as-you-go; 'PrePaid' for subscription. Default: 'PostPaid'"`
	// IP addresses or CIDR blocks allowed to access the MongoDB instance.
	//  Default: ["127.0.0.1"] (no access). Set to ["0.0.0.0/0"] to allow all
	//  (not recommended for production).
	SecurityIpList []string `json:"security_ip_list,omitempty" jsonschema:"IP addresses or CIDR blocks allowed to access the MongoDB instance. Default: ['127.0.0.1'] (no access). Set to ['0.0.0.0/0'] to allow all (not recommended for production)."`
	// ECS security group ID to associate with the MongoDB instance.
	SecurityGroupId string `json:"security_group_id,omitempty" jsonschema:"ECS security group ID to associate with the MongoDB instance."`
	// Alibaba Cloud resource group ID for organizational grouping (per DD05).
	//  If omitted, the instance is placed in the account's default resource group.
	ResourceGroupId string `json:"resource_group_id,omitempty" jsonschema:"Alibaba Cloud resource group ID for organizational grouping (per DD05). If omitted; the instance is placed in the account's default resource group."`
	// Tags to apply to the MongoDB instance.
	Tags map[string]string `json:"tags,omitempty" jsonschema:"Tags to apply to the MongoDB instance."`
	// SSL encryption action for client connections.
	//  "Open" enables SSL. "Close" disables SSL. "Update" rotates the
	//  SSL certificate. Once set, SSL cannot be fully removed (only toggled).
	SslAction string `json:"ssl_action,omitempty" jsonschema:"SSL encryption action for client connections. 'Open' enables SSL. 'Close' disables SSL. 'Update' rotates the SSL certificate. Once set; SSL cannot be fully removed (only toggled)."`
	// Transparent Data Encryption (TDE) status. Once enabled, TDE cannot be
	//  disabled. Encrypts data at rest at the storage engine level.
	//  Mutually exclusive with `encrypted` and `cloud_disk_encryption_key`.
	TdeStatus string `json:"tde_status,omitempty" jsonschema:"Transparent Data Encryption (TDE) status. Once enabled; TDE cannot be disabled. Encrypts data at rest at the storage engine level. Mutually exclusive with 'encrypted' and 'cloud_disk_encryption_key'."`
	// Custom KMS key ID for TDE encryption. When set with tde_status = "enabled",
	//  uses a customer-managed key instead of the service-managed default.
	EncryptionKey string `json:"encryption_key,omitempty" jsonschema:"Custom KMS key ID for TDE encryption. When set with tde_status = 'enabled'; uses a customer-managed key instead of the service-managed default."`
	// Cloud disk encryption. Encrypts the underlying cloud disk at the
	//  infrastructure layer. Mutually exclusive with `tde_status`.
	Encrypted bool `json:"encrypted,omitempty" jsonschema:"Cloud disk encryption. Encrypts the underlying cloud disk at the infrastructure layer. Mutually exclusive with 'tde_status'."`
	// KMS key ID for cloud disk encryption. Only applicable when encrypted
	//  is true. Mutually exclusive with `tde_status` and `encryption_key`.
	CloudDiskEncryptionKey string `json:"cloud_disk_encryption_key,omitempty" jsonschema:"KMS key ID for cloud disk encryption. Only applicable when encrypted is true. Mutually exclusive with 'tde_status' and 'encryption_key'."`
	// Maintenance window start time in UTC format (e.g., "02:00Z").
	//  Alibaba Cloud may perform minor version upgrades or patches during
	//  this window.
	MaintainStartTime string `json:"maintain_start_time,omitempty" jsonschema:"Maintenance window start time in UTC format (e.g.; '02:00Z'). Alibaba Cloud may perform minor version upgrades or patches during this window."`
	// Maintenance window end time in UTC format (e.g., "06:00Z").
	MaintainEndTime string `json:"maintain_end_time,omitempty" jsonschema:"Maintenance window end time in UTC format (e.g.; '06:00Z')."`
	// Backup time window in UTC. Format: "HH:00Z-HH:00Z" (1-hour window).
	//  Example: "02:00Z-03:00Z".
	BackupTime string `json:"backup_time,omitempty" jsonschema:"Backup time window in UTC. Format: 'HH:00Z-HH:00Z' (1-hour window). Example: '02:00Z-03:00Z'."`
	// Backup days of the week. Each entry is a day name.
	//  Examples: ["Monday", "Wednesday", "Friday"].
	BackupPeriod []string `json:"backup_period,omitempty" jsonschema:"Backup days of the week. Each entry is a day name. Examples: ['Monday'; 'Wednesday'; 'Friday']."`
	// MongoDB engine parameters as key-value pairs. Allows tuning engine
	//  settings such as operationProfiling.slowOpThresholdMs.
	//  Refer to Alibaba Cloud documentation for valid parameter names.
	Parameters map[string]string `json:"parameters,omitempty" jsonschema:"MongoDB engine parameters as key-value pairs. Allows tuning engine settings such as operationProfiling.slowOpThresholdMs. Refer to Alibaba Cloud documentation for valid parameter names."`
	// Enable release protection to prevent accidental deletion via the
	//  console or API.
	DbInstanceReleaseProtection bool `json:"db_instance_release_protection,omitempty" jsonschema:"Enable release protection to prevent accidental deletion via the console or API."`
	// Subscription period in months. Only applicable when instance_charge_type
	//  is "PrePaid". Valid values: 1-9, 12, 24, 36.
	Period int32 `json:"period,omitempty" jsonschema:"Subscription period in months. Only applicable when instance_charge_type is 'PrePaid'. Valid values: 1-9; 12; 24; 36."`
	// Auto-renewal for PrePaid instances. Ignored for PostPaid instances.
	AutoRenew bool `json:"auto_renew,omitempty" jsonschema:"Auto-renewal for PrePaid instances. Ignored for PostPaid instances."`
	// Auto-renewal period in months (1-12). Only applicable when auto_renew
	//  is true and instance_charge_type is "PrePaid".
	AutoRenewDuration int32 `json:"auto_renew_duration,omitempty" jsonschema:"Auto-renewal period in months (1-12). Only applicable when auto_renew is true and instance_charge_type is 'PrePaid'."`
}

func (s *AliCloudMongodbInstanceSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.VswitchId == "" {
		return fmt.Errorf("vswitch_id is required")
	}
	if s.EngineVersion == "" {
		return fmt.Errorf("engine_version is required")
	}
	if s.DbInstanceClass == "" {
		return fmt.Errorf("db_instance_class is required")
	}
	if s.AccountPassword == "" {
		return fmt.Errorf("account_password is required")
	}
	return nil
}

func (s *AliCloudMongodbInstanceSpecInput) applyDefaults() {
	if s.ReplicationFactor == 0 {
		s.ReplicationFactor = 3
	}
	if s.StorageEngine == "" {
		s.StorageEngine = "WiredTiger"
	}
	if s.InstanceChargeType == "" {
		s.InstanceChargeType = "PostPaid"
	}
}

func (s *AliCloudMongodbInstanceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["vswitch_id"] = s.VswitchId
	m["engine_version"] = s.EngineVersion
	m["db_instance_class"] = s.DbInstanceClass
	m["db_instance_storage"] = s.DbInstanceStorage
	m["account_password"] = s.AccountPassword
	if s.DbInstanceName != "" {
		m["db_instance_name"] = s.DbInstanceName
	}
	if s.ZoneId != "" {
		m["zone_id"] = s.ZoneId
	}
	if s.SecondaryZoneId != "" {
		m["secondary_zone_id"] = s.SecondaryZoneId
	}
	if s.HiddenZoneId != "" {
		m["hidden_zone_id"] = s.HiddenZoneId
	}
	if s.ReplicationFactor != 0 {
		m["replication_factor"] = s.ReplicationFactor
	}
	if s.ReadonlyReplicas != 0 {
		m["readonly_replicas"] = s.ReadonlyReplicas
	}
	if s.StorageEngine != "" {
		m["storage_engine"] = s.StorageEngine
	}
	if s.StorageType != "" {
		m["storage_type"] = s.StorageType
	}
	if s.ProvisionedIops != 0 {
		m["provisioned_iops"] = s.ProvisionedIops
	}
	if s.InstanceChargeType != "" {
		m["instance_charge_type"] = s.InstanceChargeType
	}
	if len(s.SecurityIpList) > 0 {
		m["security_ip_list"] = s.SecurityIpList
	}
	if s.SecurityGroupId != "" {
		m["security_group_id"] = s.SecurityGroupId
	}
	if s.ResourceGroupId != "" {
		m["resource_group_id"] = s.ResourceGroupId
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	if s.SslAction != "" {
		m["ssl_action"] = s.SslAction
	}
	if s.TdeStatus != "" {
		m["tde_status"] = s.TdeStatus
	}
	if s.EncryptionKey != "" {
		m["encryption_key"] = s.EncryptionKey
	}
	if s.Encrypted {
		m["encrypted"] = s.Encrypted
	}
	if s.CloudDiskEncryptionKey != "" {
		m["cloud_disk_encryption_key"] = s.CloudDiskEncryptionKey
	}
	if s.MaintainStartTime != "" {
		m["maintain_start_time"] = s.MaintainStartTime
	}
	if s.MaintainEndTime != "" {
		m["maintain_end_time"] = s.MaintainEndTime
	}
	if s.BackupTime != "" {
		m["backup_time"] = s.BackupTime
	}
	if len(s.BackupPeriod) > 0 {
		m["backup_period"] = s.BackupPeriod
	}
	if len(s.Parameters) > 0 {
		m["parameters"] = s.Parameters
	}
	if s.DbInstanceReleaseProtection {
		m["db_instance_release_protection"] = s.DbInstanceReleaseProtection
	}
	if s.Period != 0 {
		m["period"] = s.Period
	}
	if s.AutoRenew {
		m["auto_renew"] = s.AutoRenew
	}
	if s.AutoRenewDuration != 0 {
		m["auto_renew_duration"] = s.AutoRenewDuration
	}
	return m
}

// ParseAliCloudMongodbInstance validates and normalizes a AliCloudMongodbInstance cloud_object.
func ParseAliCloudMongodbInstance(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "ali-cloud.openmcf.org/v1", "AliCloudMongodbInstance"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AliCloudMongodbInstanceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
