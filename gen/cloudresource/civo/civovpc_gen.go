// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:01:03+05:30

package civo

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// civo-vpc
type CivoVpcSpecInput struct {
	// The name of the network (DNS-friendly label).
	NetworkName string `json:"network_name" jsonschema:"required,The name of the network (DNS-friendly label)."`
	// The Civo region where this network will be created.
	Region string `json:"region" jsonschema:"required,enum=lon1|lon2|fra1|nyc1|phx1|mum1,The Civo region where this network will be created."`
	// The IPv4 CIDR range for the network (max /24). If omitted, an available range will be auto-allocated.
	IpRangeCidr string `json:"ip_range_cidr,omitempty" jsonschema:"The IPv4 CIDR range for the network (max /24). If omitted; an available range will be auto-allocated."`
	// Whether this network should be the default for the region (only one default network per region).
	IsDefaultForRegion bool `json:"is_default_for_region,omitempty" jsonschema:"Whether this network should be the default for the region (only one default network per region)."`
	// An optional description for the network (up to 100 characters).
	Description string `json:"description,omitempty" jsonschema:"An optional description for the network (up to 100 characters)."`
}

func (s *CivoVpcSpecInput) validate() error {
	if s.NetworkName == "" {
		return fmt.Errorf("network_name is required")
	}
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	switch s.Region {
	case "lon1", "lon2", "fra1", "nyc1", "phx1", "mum1":
	default:
		return fmt.Errorf("invalid region: %q", s.Region)
	}
	return nil
}

func (s *CivoVpcSpecInput) applyDefaults() {
}

func (s *CivoVpcSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["network_name"] = s.NetworkName
	m["region"] = s.Region
	if s.IpRangeCidr != "" {
		m["ip_range_cidr"] = s.IpRangeCidr
	}
	if s.IsDefaultForRegion {
		m["is_default_for_region"] = s.IsDefaultForRegion
	}
	if s.Description != "" {
		m["description"] = s.Description
	}
	return m
}

// ParseCivoVpc validates and normalizes a CivoVpc cloud_object.
func ParseCivoVpc(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "civo.openmcf.org/v1", "CivoVpc"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec CivoVpcSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
