// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package civo

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// civo-kubernetes-node-pool
type CivoKubernetesNodePoolSpecInput struct {
	// A name for the node pool. Must be unique within the Civo Kubernetes cluster.
	NodePoolName string `json:"node_pool_name" jsonschema:"required,A name for the node pool. Must be unique within the Civo Kubernetes cluster."`
	// Reference to the Civo Kubernetes cluster in which to create this node pool.
	//  Accepts the cluster's name or a reference to the CivoKubernetesCluster resource.
	Cluster string `json:"cluster" jsonschema:"required,Reference to the Civo Kubernetes cluster in which to create this node pool. Accepts the cluster's name or a reference to the CivoKubernetesCluster resource."`
	// The slug identifier for the size of each node in the pool (e.g., "g4s.kube.medium").
	//  Defines the CPU and memory of the nodes.
	Size string `json:"size" jsonschema:"required,The slug identifier for the size of each node in the pool (e.g.; 'g4s.kube.medium'). Defines the CPU and memory of the nodes."`
	// The number of nodes to provision in the pool. Must be at least 1.
	NodeCount uint32 `json:"node_count" jsonschema:"required,The number of nodes to provision in the pool. Must be at least 1."`
	// Enable auto-scaling for this node pool. If true, the platform manages node count between min_nodes and max_nodes.
	AutoScale bool `json:"auto_scale,omitempty" jsonschema:"Enable auto-scaling for this node pool. If true; the platform manages node count between min_nodes and max_nodes."`
	// Minimum number of nodes when auto-scaling is enabled. Required if auto_scale is true.
	MinNodes uint32 `json:"min_nodes,omitempty" jsonschema:"Minimum number of nodes when auto-scaling is enabled. Required if auto_scale is true."`
	// Maximum number of nodes when auto-scaling is enabled. Required if auto_scale is true.
	MaxNodes uint32 `json:"max_nodes,omitempty" jsonschema:"Maximum number of nodes when auto-scaling is enabled. Required if auto_scale is true."`
	// A list of tags to apply to the node pool for organizational purposes.
	Tags []string `json:"tags,omitempty" jsonschema:"A list of tags to apply to the node pool for organizational purposes."`
}

func (s *CivoKubernetesNodePoolSpecInput) validate() error {
	if s.NodePoolName == "" {
		return fmt.Errorf("node_pool_name is required")
	}
	if s.Cluster == "" {
		return fmt.Errorf("cluster is required")
	}
	if s.Size == "" {
		return fmt.Errorf("size is required")
	}
	return nil
}

func (s *CivoKubernetesNodePoolSpecInput) applyDefaults() {
}

func (s *CivoKubernetesNodePoolSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["node_pool_name"] = s.NodePoolName
	m["cluster"] = s.Cluster
	m["size"] = s.Size
	m["node_count"] = s.NodeCount
	if s.AutoScale {
		m["auto_scale"] = s.AutoScale
	}
	if s.MinNodes != 0 {
		m["min_nodes"] = s.MinNodes
	}
	if s.MaxNodes != 0 {
		m["max_nodes"] = s.MaxNodes
	}
	if len(s.Tags) > 0 {
		m["tags"] = s.Tags
	}
	return m
}

// ParseCivoKubernetesNodePool validates and normalizes a CivoKubernetesNodePool cloud_object.
func ParseCivoKubernetesNodePool(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "civo.openmcf.org/v1", "CivoKubernetesNodePool"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec CivoKubernetesNodePoolSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
