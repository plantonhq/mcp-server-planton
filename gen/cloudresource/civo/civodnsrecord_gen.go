// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:50:56+05:30

package civo

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// CivoDnsRecord is a Kubernetes Resource Model (KRM) style resource for managing
//
//	individual DNS records within a Civo DNS zone.
type CivoDnsRecordSpecInput struct {
	// The ID of the Civo DNS Zone where this record will be created.
	//  Can be provided as a literal value or referenced from a CivoDnsZone resource.
	//
	//  When using value_from, the default kind is CivoDnsZone and the default field path
	//  is "status.outputs.zone_id", allowing you to wire this directly to a zone...
	ZoneId string `json:"zone_id" jsonschema:"required,The ID of the Civo DNS Zone where this record will be created. Can be provided as a literal value or referenced from a CivoDnsZone resource. When using value_from; the default kind is CivoDnsZone and ..."`
	// The name of the DNS record (e.g., "www", "api", "@" for root).
	//  Use "@" to create a record at the zone apex (root domain).
	Name string `json:"name" jsonschema:"required,The name of the DNS record (e.g.; 'www'; 'api'; '@' for root). Use '@' to create a record at the zone apex (root domain)."`
	// The type of DNS record to create.
	Type string `json:"type" jsonschema:"required,enum=A|AAAA|CNAME|MX|TXT|SRV|NS,The type of DNS record to create."`
	// The value/target of the DNS record.
	//  For A records: IPv4 address (e.g., "192.0.2.1")
	//  For AAAA records: IPv6 address (e.g., "2001:db8::1")
	//  For CNAME records: target hostname (e.g., "example.com")
	//  For MX records: mail server hostname (e.g., "mail.example.com")
	//  For TXT records: text value (e.g., "v...
	Value string `json:"value" jsonschema:"required,The value/target of the DNS record. For A records: IPv4 address (e.g.; '192.0.2.1') For AAAA records: IPv6 address (e.g.; '2001:db8::1') For CNAME records: target hostname (e.g.; 'example.com') For MX..."`
	// Time to live (TTL) for the DNS record in seconds.
	//  Determines how long resolvers cache the record.
	//  Valid range: 60-86400 seconds (1 minute to 24 hours).
	//  Defaults to 3600 (1 hour) if not specified.
	Ttl int32 `json:"ttl,omitempty" jsonschema:"Time to live (TTL) for the DNS record in seconds. Determines how long resolvers cache the record. Valid range: 60-86400 seconds (1 minute to 24 hours). Defaults to 3600 (1 hour) if not specified."`
	// Priority for MX and SRV records.
	//  Lower values indicate higher priority.
	//  Required for MX records, optional for SRV records.
	//  Range: 0-65535.
	Priority int32 `json:"priority,omitempty" jsonschema:"Priority for MX and SRV records. Lower values indicate higher priority. Required for MX records; optional for SRV records. Range: 0-65535."`
}

func (s *CivoDnsRecordSpecInput) validate() error {
	if s.ZoneId == "" {
		return fmt.Errorf("zone_id is required")
	}
	if s.Name == "" {
		return fmt.Errorf("name is required")
	}
	if s.Type == "" {
		return fmt.Errorf("type is required")
	}
	switch s.Type {
	case "A", "AAAA", "CNAME", "MX", "TXT", "SRV", "NS":
	default:
		return fmt.Errorf("invalid type: %q", s.Type)
	}
	if s.Value == "" {
		return fmt.Errorf("value is required")
	}
	return nil
}

func (s *CivoDnsRecordSpecInput) applyDefaults() {
}

func (s *CivoDnsRecordSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["zone_id"] = s.ZoneId
	m["name"] = s.Name
	m["type"] = s.Type
	m["value"] = s.Value
	if s.Ttl != 0 {
		m["ttl"] = s.Ttl
	}
	if s.Priority != 0 {
		m["priority"] = s.Priority
	}
	return m
}

// ParseCivoDnsRecord validates and normalizes a CivoDnsRecord cloud_object.
func ParseCivoDnsRecord(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "civo.openmcf.org/v1", "CivoDnsRecord"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec CivoDnsRecordSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
