// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:01:03+05:30

package cloudflare

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// cloudflare-kv-namespace
type CloudflareKvNamespaceSpecInput struct {
	// A human-readable name for the KV namespace.
	//  This name must be unique within the Cloudflare account.
	NamespaceName string `json:"namespace_name" jsonschema:"required,A human-readable name for the KV namespace. This name must be unique within the Cloudflare account."`
	// (Optional) Default time-to-live for key-value entries, in seconds.
	//  If set to 0 or left unset, keys will never expire by default (infinite TTL).
	//  If set to a positive value, it should be at least 60 seconds (minimum enforced by Cloudflare for expiring keys).
	TtlSeconds int32 `json:"ttl_seconds,omitempty" jsonschema:"(Optional) Default time-to-live for key-value entries; in seconds. If set to 0 or left unset; keys will never expire by default (infinite TTL). If set to a positive value; it should be at least 60 sec..."`
	// (Optional) A short description of the namespace.
	//  Useful for documentation or identifying the purpose of this KV store.
	Description string `json:"description,omitempty" jsonschema:"(Optional) A short description of the namespace. Useful for documentation or identifying the purpose of this KV store."`
}

func (s *CloudflareKvNamespaceSpecInput) validate() error {
	if s.NamespaceName == "" {
		return fmt.Errorf("namespace_name is required")
	}
	return nil
}

func (s *CloudflareKvNamespaceSpecInput) applyDefaults() {
}

func (s *CloudflareKvNamespaceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["namespace_name"] = s.NamespaceName
	if s.TtlSeconds != 0 {
		m["ttl_seconds"] = s.TtlSeconds
	}
	if s.Description != "" {
		m["description"] = s.Description
	}
	return m
}

// ParseCloudflareKvNamespace validates and normalizes a CloudflareKvNamespace cloud_object.
func ParseCloudflareKvNamespace(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "cloudflare.openmcf.org/v1", "CloudflareKvNamespace"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec CloudflareKvNamespaceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
