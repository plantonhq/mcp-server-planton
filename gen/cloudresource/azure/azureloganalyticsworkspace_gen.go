// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:01:03+05:30

package azure

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// AzureLogAnalyticsWorkspace is the top-level API resource for an Azure Log Analytics Workspace.
//
//	Log Analytics Workspaces are the central data platform for Azure Monitor, collecting
//	and analyzing log data from Azure resources, on-premises servers, and applications.
type AzureLogAnalyticsWorkspaceSpecInput struct {
	// The Azure region where the Log Analytics Workspace will be deployed.
	//  Examples: "eastus", "westus2", "westeurope", "southeastasia".
	//  Choose a region close to the resources that will send logs to this workspace
	//  to minimize data egress costs and latency.
	Region string `json:"region" jsonschema:"required,The Azure region where the Log Analytics Workspace will be deployed. Examples: 'eastus'; 'westus2'; 'westeurope'; 'southeastasia'. Choose a region close to the resources that will send logs to this wo..."`
	// The Azure Resource Group where the workspace will be created.
	//  Can be a literal string or a reference to an AzureResourceGroup output.
	ResourceGroup string `json:"resource_group" jsonschema:"required,The Azure Resource Group where the workspace will be created. Can be a literal string or a reference to an AzureResourceGroup output."`
	// The name of the Log Analytics Workspace.
	//  Must be unique within the resource group.
	//  Allowed characters: alphanumeric and hyphens. Must start with a letter.
	//  Length: 4 to 63 characters.
	Name string `json:"name" jsonschema:"required,The name of the Log Analytics Workspace. Must be unique within the resource group. Allowed characters: alphanumeric and hyphens. Must start with a letter. Length: 4 to 63 characters."`
	// The pricing tier (SKU) of the workspace.
	//  - "PerGB2018": Pay-as-you-go pricing per GB ingested (recommended for most workloads)
	//  - "CapacityReservation": Commitment tier with discount (requires reservation_capacity_in_gb_per_day)
	//  - "Standalone": Legacy per-node pricing
	//  - "PerNode": Legacy OMS per-...
	Sku string `json:"sku,omitempty" jsonschema:"The pricing tier (SKU) of the workspace. - 'PerGB2018': Pay-as-you-go pricing per GB ingested (recommended for most workloads) - 'CapacityReservation': Commitment tier with discount (requires reservat..."`
	// The number of days to retain data in the workspace.
	//  Range: 30 to 730 days.
	//  Free tier allows 7 days. PerGB2018 includes 31 days free; beyond that, retention
	//  is billed per GB per month. For compliance workloads, 90-365 days is typical.
	//  Default: 30
	RetentionInDays int32 `json:"retention_in_days,omitempty" jsonschema:"The number of days to retain data in the workspace. Range: 30 to 730 days. Free tier allows 7 days. PerGB2018 includes 31 days free; beyond that; retention is billed per GB per month. For compliance w..."`
	// The daily ingestion quota in GB.
	//  Set to -1 for unlimited ingestion (no cap).
	//  Set to a positive value to cap daily ingestion and prevent cost overruns.
	//  When the cap is reached, ingestion stops until the next UTC day.
	//  Default: -1 (unlimited)
	DailyQuotaGb float64 `json:"daily_quota_gb,omitempty" jsonschema:"The daily ingestion quota in GB. Set to -1 for unlimited ingestion (no cap). Set to a positive value to cap daily ingestion and prevent cost overruns. When the cap is reached; ingestion stops until th..."`
}

func (s *AzureLogAnalyticsWorkspaceSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.ResourceGroup == "" {
		return fmt.Errorf("resource_group is required")
	}
	if s.Name == "" {
		return fmt.Errorf("name is required")
	}
	return nil
}

func (s *AzureLogAnalyticsWorkspaceSpecInput) applyDefaults() {
	if s.Sku == "" {
		s.Sku = "PerGB2018"
	}
	if s.RetentionInDays == 0 {
		s.RetentionInDays = 30
	}
}

func (s *AzureLogAnalyticsWorkspaceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["resource_group"] = s.ResourceGroup
	m["name"] = s.Name
	if s.Sku != "" {
		m["sku"] = s.Sku
	}
	if s.RetentionInDays != 0 {
		m["retention_in_days"] = s.RetentionInDays
	}
	if s.DailyQuotaGb != 0 {
		m["daily_quota_gb"] = s.DailyQuotaGb
	}
	return m
}

// ParseAzureLogAnalyticsWorkspace validates and normalizes a AzureLogAnalyticsWorkspace cloud_object.
func ParseAzureLogAnalyticsWorkspace(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "azure.openmcf.org/v1", "AzureLogAnalyticsWorkspace"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AzureLogAnalyticsWorkspaceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
