// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package azure

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// AzureDnsRecord represents a DNS record in an Azure DNS Zone.
//
//	This resource creates individual DNS records (A, AAAA, CNAME, MX, TXT, etc.)
//	within an existing Azure DNS Zone.
type AzureDnsRecordSpecInput struct {
	// The Azure Resource Group where the DNS Record will be created.
	//  Can be a literal string or a reference to an AzureResourceGroup output.
	ResourceGroup string `json:"resource_group" jsonschema:"required,The Azure Resource Group where the DNS Record will be created. Can be a literal string or a reference to an AzureResourceGroup output."`
	// The name of the DNS Zone where this record will be created.
	//  Can be provided as a literal value or referenced from an AzureDnsZone resource.
	//
	//  When using value_from, the default kind is AzureDnsZone and the default field path
	//  is "status.outputs.zone_name", allowing you to wire this directly to a zo...
	ZoneName string `json:"zone_name" jsonschema:"required,The name of the DNS Zone where this record will be created. Can be provided as a literal value or referenced from an AzureDnsZone resource. When using value_from; the default kind is AzureDnsZone and ..."`
	// The DNS record type to create.
	//  Supported types: A, AAAA, CNAME, MX, TXT, SRV, NS, PTR, CAA.
	Type string `json:"type" jsonschema:"required,enum=A|AAAA|CNAME|MX|TXT|SRV|NS|PTR|CAA,The DNS record type to create. Supported types: A; AAAA; CNAME; MX; TXT; SRV; NS; PTR; CAA."`
	// The name of the DNS record (relative to the zone).
	//  Use "@" for zone apex (root domain) or specify a subdomain name.
	//  Examples:
	//    - "@" for zone apex (example.com)
	//    - "www" for subdomain (www.example.com)
	//    - "api.v1" for nested subdomain (api.v1.example.com)
	//    - "*" for wildcard (*.example.com...
	Name string `json:"name" jsonschema:"required,The name of the DNS record (relative to the zone). Use '@' for zone apex (root domain) or specify a subdomain name. Examples: - '@' for zone apex (example.com) - 'www' for subdomain (www.example.com) ..."`
	// The values/targets for the DNS record.
	//  Format depends on record type:
	//    - A record: IPv4 addresses (e.g., ["192.0.2.1", "192.0.2.2"])
	//    - AAAA record: IPv6 addresses (e.g., ["2001:db8::1"])
	//    - CNAME record: Target hostname (e.g., ["target.example.com"])
	//    - MX record: Mail server hostname (e.g...
	Values []string `json:"values,omitempty" jsonschema:"The values/targets for the DNS record. Format depends on record type: - A record: IPv4 addresses (e.g.; ['192.0.2.1'; '192.0.2.2']) - AAAA record: IPv6 addresses (e.g.; ['2001:db8::1']) - CNAME record..."`
	// Time to live (TTL) for the DNS record in seconds.
	//  Determines how long resolvers should cache this record.
	//  Common values: 60 (1 min), 300 (5 min), 3600 (1 hour), 86400 (1 day).
	//  Default: 300 seconds (5 minutes).
	TtlSeconds int32 `json:"ttl_seconds,omitempty" jsonschema:"Time to live (TTL) for the DNS record in seconds. Determines how long resolvers should cache this record. Common values: 60 (1 min); 300 (5 min); 3600 (1 hour); 86400 (1 day). Default: 300 seconds (5 ..."`
	// MX record specific: Priority value for mail exchange records.
	//  Lower values indicate higher priority. Required for MX records.
	//  Common values: 10 (primary), 20 (secondary), 30 (tertiary).
	//  Only applicable when type is MX.
	MxPriority int32 `json:"mx_priority,omitempty" jsonschema:"MX record specific: Priority value for mail exchange records. Lower values indicate higher priority. Required for MX records. Common values: 10 (primary); 20 (secondary); 30 (tertiary). Only applicabl..."`
}

func (s *AzureDnsRecordSpecInput) validate() error {
	if s.ResourceGroup == "" {
		return fmt.Errorf("resource_group is required")
	}
	if s.ZoneName == "" {
		return fmt.Errorf("zone_name is required")
	}
	if s.Type == "" {
		return fmt.Errorf("type is required")
	}
	switch s.Type {
	case "A", "AAAA", "CNAME", "MX", "TXT", "SRV", "NS", "PTR", "CAA":
	default:
		return fmt.Errorf("invalid type: %q", s.Type)
	}
	if s.Name == "" {
		return fmt.Errorf("name is required")
	}
	if len(s.Values) < 1 {
		return fmt.Errorf("values requires at least 1 items, got %d", len(s.Values))
	}
	return nil
}

func (s *AzureDnsRecordSpecInput) applyDefaults() {
	if s.TtlSeconds == 0 {
		s.TtlSeconds = 300
	}
}

func (s *AzureDnsRecordSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["resource_group"] = s.ResourceGroup
	m["zone_name"] = s.ZoneName
	m["type"] = s.Type
	m["name"] = s.Name
	if len(s.Values) > 0 {
		m["values"] = s.Values
	}
	if s.TtlSeconds != 0 {
		m["ttl_seconds"] = s.TtlSeconds
	}
	if s.MxPriority != 0 {
		m["mx_priority"] = s.MxPriority
	}
	return m
}

// ParseAzureDnsRecord validates and normalizes a AzureDnsRecord cloud_object.
func ParseAzureDnsRecord(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "azure.openmcf.org/v1", "AzureDnsRecord"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AzureDnsRecordSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
