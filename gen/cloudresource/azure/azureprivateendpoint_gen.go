// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package azure

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// AzurePrivateEndpoint is the top-level API resource for an Azure Private Endpoint.
//
//	Private endpoints provide secure, private connectivity to Azure PaaS services
//	over the Microsoft backbone network, using a private IP from your VNet.
type AzurePrivateEndpointSpecInput struct {
	// The Azure region where the Private Endpoint will be created.
	//  Must be in the same region as the subnet it connects to.
	//  Examples: "eastus", "westus2", "westeurope", "southeastasia".
	Region string `json:"region" jsonschema:"required,The Azure region where the Private Endpoint will be created. Must be in the same region as the subnet it connects to. Examples: 'eastus'; 'westus2'; 'westeurope'; 'southeastasia'."`
	// The Azure Resource Group where the Private Endpoint will be created.
	//  Can be a literal string or a reference to an AzureResourceGroup output.
	ResourceGroup string `json:"resource_group" jsonschema:"required,The Azure Resource Group where the Private Endpoint will be created. Can be a literal string or a reference to an AzureResourceGroup output."`
	// The name of the Private Endpoint.
	//  Must be unique within the resource group.
	//  Azure allows 1-80 characters: must start/end with alphanumeric, allows
	//  letters, numbers, underscores, periods, and hyphens.
	Name string `json:"name" jsonschema:"required,The name of the Private Endpoint. Must be unique within the resource group. Azure allows 1-80 characters: must start/end with alphanumeric; allows letters; numbers; underscores; periods; and hyphens."`
	// The Azure Resource Manager ID of the Subnet from which a private IP address
	//  will be allocated for this Private Endpoint.
	//  The subnet must have private endpoint network policies configured appropriately.
	//  Format: /subscriptions/{sub}/resourceGroups/{rg}/providers/Microsoft.Network/virtualNetworks/{v...
	SubnetId string `json:"subnet_id" jsonschema:"required,The Azure Resource Manager ID of the Subnet from which a private IP address will be allocated for this Private Endpoint. The subnet must have private endpoint network policies configured appropriately..."`
	// The Azure Resource Manager ID of the Private Link-enabled resource to connect
	//  to privately. This is the target service that the private endpoint will create
	//  a secure tunnel to.
	//
	//  Can be a literal Azure resource ID or a reference to another OpenMCF resource's
	//  output. In infra charts, this enables ...
	PrivateConnectionResourceId string `json:"private_connection_resource_id" jsonschema:"required,The Azure Resource Manager ID of the Private Link-enabled resource to connect to privately. This is the target service that the private endpoint will create a secure tunnel to. Can be a literal Azure ..."`
	// The list of sub-resource names (group IDs) that the Private Endpoint can
	//  connect to. Each Azure service defines its own sub-resource names.
	//
	//  In practice, most private endpoints connect to exactly one sub-resource.
	//  Azure validates that the sub-resource name is valid for the target service.
	//
	//  Commo...
	SubresourceNames []string `json:"subresource_names,omitempty" jsonschema:"The list of sub-resource names (group IDs) that the Private Endpoint can connect to. Each Azure service defines its own sub-resource names. In practice; most private endpoints connect to exactly one s..."`
	// The Azure Resource Manager ID of an AzurePrivateDnsZone to associate with
	//  this Private Endpoint via a DNS Zone Group.
	//
	//  When provided, the IaC module creates a `private_dns_zone_group` that
	//  automatically registers the private endpoint's IP address as an A-record in
	//  the specified zone. This is cri...
	PrivateDnsZoneId string `json:"private_dns_zone_id,omitempty" jsonschema:"The Azure Resource Manager ID of an AzurePrivateDnsZone to associate with this Private Endpoint via a DNS Zone Group. When provided; the IaC module creates a 'private_dns_zone_group' that automaticall..."`
}

func (s *AzurePrivateEndpointSpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.ResourceGroup == "" {
		return fmt.Errorf("resource_group is required")
	}
	if s.Name == "" {
		return fmt.Errorf("name is required")
	}
	if s.SubnetId == "" {
		return fmt.Errorf("subnet_id is required")
	}
	if s.PrivateConnectionResourceId == "" {
		return fmt.Errorf("private_connection_resource_id is required")
	}
	return nil
}

func (s *AzurePrivateEndpointSpecInput) applyDefaults() {
}

func (s *AzurePrivateEndpointSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["resource_group"] = s.ResourceGroup
	m["name"] = s.Name
	m["subnet_id"] = s.SubnetId
	m["private_connection_resource_id"] = s.PrivateConnectionResourceId
	if len(s.SubresourceNames) > 0 {
		m["subresource_names"] = s.SubresourceNames
	}
	if s.PrivateDnsZoneId != "" {
		m["private_dns_zone_id"] = s.PrivateDnsZoneId
	}
	return m
}

// ParseAzurePrivateEndpoint validates and normalizes a AzurePrivateEndpoint cloud_object.
func ParseAzurePrivateEndpoint(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "azure.openmcf.org/v1", "AzurePrivateEndpoint"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AzurePrivateEndpointSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
