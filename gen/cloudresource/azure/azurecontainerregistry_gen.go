// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package azure

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// azure-container-registry
type AzureContainerRegistrySpecInput struct {
	// Azure region in which to create the container registry (e.g., "eastus", "westeurope").
	//  This is the primary location where the registry is deployed.
	Region string `json:"region" jsonschema:"required,Azure region in which to create the container registry (e.g.; 'eastus'; 'westeurope'). This is the primary location where the registry is deployed."`
	// The Azure Resource Group where the Container Registry will be created.
	//  Can be a literal string or a reference to an AzureResourceGroup output.
	ResourceGroup string `json:"resource_group" jsonschema:"required,The Azure Resource Group where the Container Registry will be created. Can be a literal string or a reference to an AzureResourceGroup output."`
	// The globally unique name of the container registry.
	//  Must be 5-50 characters of lowercase letters or numbers (per Azure naming rules).
	RegistryName string `json:"registry_name" jsonschema:"required,The globally unique name of the container registry. Must be 5-50 characters of lowercase letters or numbers (per Azure naming rules)."`
	// The pricing tier of the registry (Basic, Standard, or Premium).
	//  This influences features such as storage limits and geo-replication support.
	//  Defaults to STANDARD if not specified.
	Sku string `json:"sku,omitempty" jsonschema:"enum=STANDARD|PREMIUM,The pricing tier of the registry (Basic; Standard; or Premium). This influences features such as storage limits and geo-replication support. Defaults to STANDARD if not specified."`
	// Enables the admin user account for the registry.
	//  Default is false (admin user disabled). Enable only if needed for basic authentication scenarios.
	AdminUserEnabled bool `json:"admin_user_enabled,omitempty" jsonschema:"Enables the admin user account for the registry. Default is false (admin user disabled). Enable only if needed for basic authentication scenarios."`
	// A list of additional Azure regions to replicate the registry (geo-replication).
	//  Only applicable for Premium SKU. Leave empty for Basic/Standard SKUs.
	GeoReplicationRegions []string `json:"geo_replication_regions,omitempty" jsonschema:"A list of additional Azure regions to replicate the registry (geo-replication). Only applicable for Premium SKU. Leave empty for Basic/Standard SKUs."`
}

func (s *AzureContainerRegistrySpecInput) validate() error {
	if s.Region == "" {
		return fmt.Errorf("region is required")
	}
	if s.ResourceGroup == "" {
		return fmt.Errorf("resource_group is required")
	}
	if s.RegistryName == "" {
		return fmt.Errorf("registry_name is required")
	}
	switch s.Sku {
	case "", "STANDARD", "PREMIUM":
	default:
		return fmt.Errorf("invalid sku: %q", s.Sku)
	}
	return nil
}

func (s *AzureContainerRegistrySpecInput) applyDefaults() {
}

func (s *AzureContainerRegistrySpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["region"] = s.Region
	m["resource_group"] = s.ResourceGroup
	m["registry_name"] = s.RegistryName
	if s.Sku != "" {
		m["sku"] = s.Sku
	}
	if s.AdminUserEnabled {
		m["admin_user_enabled"] = s.AdminUserEnabled
	}
	if len(s.GeoReplicationRegions) > 0 {
		m["geo_replication_regions"] = s.GeoReplicationRegions
	}
	return m
}

// ParseAzureContainerRegistry validates and normalizes a AzureContainerRegistry cloud_object.
func ParseAzureContainerRegistry(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "azure.openmcf.org/v1", "AzureContainerRegistry"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AzureContainerRegistrySpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
