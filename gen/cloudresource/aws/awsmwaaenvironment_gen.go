// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:01:03+05:30

package aws

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// aws-mwaa-environment
type AwsMwaaEnvironmentSpecInput struct {
	// The AWS region where the resource will be created.
	//  Example: "us-west-2", "eu-west-1"
	Region string `json:"region,omitempty" jsonschema:"The AWS region where the resource will be created. Example: 'us-west-2'; 'eu-west-1'"`
	// airflow_version is the Apache Airflow version for the environment.
	//  Examples: "2.10.1", "2.9.2", "2.8.1". If omitted, AWS uses the latest supported version.
	//  Minor version upgrades are applied in-place; major version changes force environment replacement.
	AirflowVersion string `json:"airflow_version,omitempty" jsonschema:"airflow_version is the Apache Airflow version for the environment. Examples: '2.10.1'; '2.9.2'; '2.8.1'. If omitted; AWS uses the latest supported version. Minor version upgrades are applied in-place;..."`
	// airflow_configuration_options overrides specific Apache Airflow configuration properties.
	//  Keys use the Airflow "section.property" format, e.g., "core.default_timezone",
	//  "webserver.dag_default_view", "celery.worker_autoscale".
	//  Values may contain sensitive information (database URIs, API keys) -- t...
	AirflowConfigurationOptions map[string]string `json:"airflow_configuration_options,omitempty" jsonschema:"airflow_configuration_options overrides specific Apache Airflow configuration properties. Keys use the Airflow 'section.property' format; e.g.; 'core.default_timezone'; 'webserver.dag_default_view'; '..."`
	// source_bucket_arn is the ARN of the S3 bucket containing DAGs, plugins, and requirements.
	//  The bucket must have versioning enabled and a bucket policy granting MWAA access.
	//  The execution role must have permissions to read from this bucket.
	SourceBucketArn string `json:"source_bucket_arn" jsonschema:"required,source_bucket_arn is the ARN of the S3 bucket containing DAGs; plugins; and requirements. The bucket must have versioning enabled and a bucket policy granting MWAA access. The execution role must have..."`
	// dag_s3_path is the relative path within the S3 bucket to the folder containing DAG files.
	//  Example: "dags/" or "airflow/dags/". Must not start with "/".
	DagS3Path string `json:"dag_s3_path" jsonschema:"required,dag_s3_path is the relative path within the S3 bucket to the folder containing DAG files. Example: 'dags/' or 'airflow/dags/'. Must not start with '/'."`
	// plugins_s3_path is the relative path within the S3 bucket to a plugins.zip file.
	//  The zip contains custom Airflow plugins (operators, hooks, sensors, macros).
	//  Example: "plugins/plugins.zip".
	PluginsS3Path string `json:"plugins_s3_path,omitempty" jsonschema:"plugins_s3_path is the relative path within the S3 bucket to a plugins.zip file. The zip contains custom Airflow plugins (operators; hooks; sensors; macros). Example: 'plugins/plugins.zip'."`
	// plugins_s3_object_version pins the plugins.zip to a specific S3 object version.
	//  Ensures deterministic deployments. If omitted, the latest version is used.
	PluginsS3ObjectVersion string `json:"plugins_s3_object_version,omitempty" jsonschema:"plugins_s3_object_version pins the plugins.zip to a specific S3 object version. Ensures deterministic deployments. If omitted; the latest version is used."`
	// requirements_s3_path is the relative path within the S3 bucket to a requirements.txt file.
	//  Lists additional Python packages to install in the Airflow environment.
	//  Example: "requirements/requirements.txt".
	RequirementsS3Path string `json:"requirements_s3_path,omitempty" jsonschema:"requirements_s3_path is the relative path within the S3 bucket to a requirements.txt file. Lists additional Python packages to install in the Airflow environment. Example: 'requirements/requirements.t..."`
	// requirements_s3_object_version pins the requirements.txt to a specific S3 object version.
	//  Ensures deterministic deployments. If omitted, the latest version is used.
	RequirementsS3ObjectVersion string `json:"requirements_s3_object_version,omitempty" jsonschema:"requirements_s3_object_version pins the requirements.txt to a specific S3 object version. Ensures deterministic deployments. If omitted; the latest version is used."`
	// startup_script_s3_path is the relative path within the S3 bucket to a startup shell script.
	//  Runs at environment startup for OS-level setup (install system packages, set environment
	//  variables, configure authentication) that requirements.txt cannot handle.
	//  Available for Airflow 2.x+. Example: "scri...
	StartupScriptS3Path string `json:"startup_script_s3_path,omitempty" jsonschema:"startup_script_s3_path is the relative path within the S3 bucket to a startup shell script. Runs at environment startup for OS-level setup (install system packages; set environment variables; configur..."`
	// startup_script_s3_object_version pins the startup script to a specific S3 object version.
	//  Ensures deterministic deployments. If omitted, the latest version is used.
	StartupScriptS3ObjectVersion string `json:"startup_script_s3_object_version,omitempty" jsonschema:"startup_script_s3_object_version pins the startup script to a specific S3 object version. Ensures deterministic deployments. If omitted; the latest version is used."`
	// execution_role_arn is the ARN of the IAM role that MWAA assumes to access AWS resources.
	//  This role needs permissions for S3 (DAGs bucket), CloudWatch Logs, SQS (Celery backend),
	//  and any AWS services your DAGs interact with (e.g., Glue, EMR, Redshift, Lambda).
	ExecutionRoleArn string `json:"execution_role_arn" jsonschema:"required,execution_role_arn is the ARN of the IAM role that MWAA assumes to access AWS resources. This role needs permissions for S3 (DAGs bucket); CloudWatch Logs; SQS (Celery backend); and any AWS services y..."`
	// subnet_ids are the private VPC subnets where MWAA creates network interfaces.
	//  Requires exactly 2 subnets in different Availability Zones. Must be private subnets
	//  (no direct route to an internet gateway). ForceNew: changing subnets forces replacement.
	SubnetIds []string `json:"subnet_ids,omitempty" jsonschema:"subnet_ids are the private VPC subnets where MWAA creates network interfaces. Requires exactly 2 subnets in different Availability Zones. Must be private subnets (no direct route to an internet gatewa..."`
	// security_group_ids are source security groups allowed to reach the MWAA VPC endpoints.
	//  When provided (along with vpc_id), a managed security group is created with:
	//    - Self-referencing inbound rule (all traffic) for MWAA component intercommunication
	//    - Ingress on port 443 (HTTPS) from these sour...
	SecurityGroupIds []string `json:"security_group_ids,omitempty" jsonschema:"security_group_ids are source security groups allowed to reach the MWAA VPC endpoints. When provided (along with vpc_id); a managed security group is created with: - Self-referencing inbound rule (all..."`
	// allowed_cidr_blocks are IPv4 CIDR ranges allowed to reach the MWAA VPC endpoints on port 443.
	//  When provided (along with vpc_id), a managed security group is created with ingress rules
	//  permitting HTTPS traffic from these CIDRs.
	AllowedCidrBlocks []string `json:"allowed_cidr_blocks,omitempty" jsonschema:"allowed_cidr_blocks are IPv4 CIDR ranges allowed to reach the MWAA VPC endpoints on port 443. When provided (along with vpc_id); a managed security group is created with ingress rules permitting HTTPS..."`
	// associate_security_group_ids are existing security groups attached directly to the
	//  MWAA environment alongside the managed security group (if created).
	//  Use this when you already have a security group configured for MWAA's self-referencing
	//  pattern and want to attach it directly without managed SG c...
	AssociateSecurityGroupIds []string `json:"associate_security_group_ids,omitempty" jsonschema:"associate_security_group_ids are existing security groups attached directly to the MWAA environment alongside the managed security group (if created). Use this when you already have a security group c..."`
	// vpc_id is the VPC in which to create the managed security group.
	//  Required when security_group_ids or allowed_cidr_blocks are provided.
	VpcId string `json:"vpc_id,omitempty" jsonschema:"vpc_id is the VPC in which to create the managed security group. Required when security_group_ids or allowed_cidr_blocks are provided."`
	// kms_key_arn is the KMS key ARN for encrypting environment data at rest
	//  (metadata database, DAG logs, SQS queue, web server logs).
	//  If omitted, AWS uses the default aws/airflow service key.
	//  ForceNew: changing the KMS key forces environment replacement.
	KmsKeyArn string `json:"kms_key_arn,omitempty" jsonschema:"kms_key_arn is the KMS key ARN for encrypting environment data at rest (metadata database; DAG logs; SQS queue; web server logs). If omitted; AWS uses the default aws/airflow service key. ForceNew: ch..."`
	// environment_class determines the compute and memory capacity of the Airflow components.
	//  "mw1.micro": 0.5 vCPU, 1 GB (dev/test, limited to 1 webserver).
	//  "mw1.small" (default): 1 vCPU, 2 GB (small-medium workloads).
	//  "mw1.medium": 2 vCPU, 4 GB (medium-large workloads).
	//  "mw1.large": 4 vCPU, 8 GB (la...
	EnvironmentClass string `json:"environment_class,omitempty" jsonschema:"environment_class determines the compute and memory capacity of the Airflow components. 'mw1.micro': 0.5 vCPU; 1 GB (dev/test; limited to 1 webserver). 'mw1.small' (default): 1 vCPU; 2 GB (small-mediu..."`
	// min_workers is the minimum number of Celery workers for auto-scaling.
	//  Range: >= 1. Workers process DAG tasks. MWAA scales between min_workers and max_workers
	//  based on task queue depth. Default: 1.
	MinWorkers int32 `json:"min_workers,omitempty" jsonschema:"min_workers is the minimum number of Celery workers for auto-scaling. Range: >= 1. Workers process DAG tasks. MWAA scales between min_workers and max_workers based on task queue depth. Default: 1."`
	// max_workers is the maximum number of Celery workers for auto-scaling.
	//  Range: >= 1. Must be >= min_workers. Default: 10.
	MaxWorkers int32 `json:"max_workers,omitempty" jsonschema:"max_workers is the maximum number of Celery workers for auto-scaling. Range: >= 1. Must be >= min_workers. Default: 10."`
	// min_webservers is the minimum number of Airflow webservers.
	//  Range: 2-5 (1 for mw1.micro). Default: 2.
	MinWebservers int32 `json:"min_webservers,omitempty" jsonschema:"min_webservers is the minimum number of Airflow webservers. Range: 2-5 (1 for mw1.micro). Default: 2."`
	// max_webservers is the maximum number of Airflow webservers.
	//  Range: 2-5 (1 for mw1.micro). Must be >= min_webservers. Default: 2.
	MaxWebservers int32 `json:"max_webservers,omitempty" jsonschema:"max_webservers is the maximum number of Airflow webservers. Range: 2-5 (1 for mw1.micro). Must be >= min_webservers. Default: 2."`
	// schedulers is the number of Airflow schedulers.
	//  Range: 2-5. Default: 2. More schedulers improve DAG parsing and scheduling throughput.
	Schedulers int32 `json:"schedulers,omitempty" jsonschema:"schedulers is the number of Airflow schedulers. Range: 2-5. Default: 2. More schedulers improve DAG parsing and scheduling throughput."`
	// webserver_access_mode controls how the Airflow web UI is accessed.
	//  "PRIVATE_ONLY" (default): accessible only within the VPC via VPC endpoint.
	//  "PUBLIC_ONLY": accessible over the internet with IAM-based login.
	WebserverAccessMode string `json:"webserver_access_mode,omitempty" jsonschema:"webserver_access_mode controls how the Airflow web UI is accessed. 'PRIVATE_ONLY' (default): accessible only within the VPC via VPC endpoint. 'PUBLIC_ONLY': accessible over the internet with IAM-based..."`
	// endpoint_management controls who manages the VPC endpoints for the environment.
	//  "SERVICE" (default): AWS creates and manages VPC endpoints automatically.
	//  "CUSTOMER": you create and manage VPC endpoints yourself (advanced, <5% adoption).
	//  ForceNew: changing this forces environment replacement.
	EndpointManagement string `json:"endpoint_management,omitempty" jsonschema:"endpoint_management controls who manages the VPC endpoints for the environment. 'SERVICE' (default): AWS creates and manages VPC endpoints automatically. 'CUSTOMER': you create and manage VPC endpoint..."`
	// logging_configuration controls per-module Airflow log delivery to CloudWatch Logs.
	//  MWAA supports 5 log modules: DAG processing, scheduler, task, webserver, and worker.
	//  Each module can be independently enabled with its own log level.
	//  CloudWatch Logs groups are auto-created by MWAA in the format:
	//  ...
	LoggingConfiguration *AwsMwaaEnvironmentLoggingConfigurationInput `json:"logging_configuration,omitempty" jsonschema:"logging_configuration controls per-module Airflow log delivery to CloudWatch Logs. MWAA supports 5 log modules: DAG processing; scheduler; task; webserver; and worker. Each module can be independently..."`
	// weekly_maintenance_window_start is the preferred start time for weekly maintenance.
	//  Format: "DAY:HH:MM" in UTC (e.g., "TUE:03:30", "SUN:00:00").
	//  During maintenance, MWAA may apply patches or updates. If omitted, AWS selects a window.
	WeeklyMaintenanceWindowStart string `json:"weekly_maintenance_window_start,omitempty" jsonschema:"weekly_maintenance_window_start is the preferred start time for weekly maintenance. Format: 'DAY:HH:MM' in UTC (e.g.; 'TUE:03:30'; 'SUN:00:00'). During maintenance; MWAA may apply patches or updates. ..."`
	// worker_replacement_strategy controls how workers are replaced during environment updates.
	//  "FORCED": replaces workers immediately (faster updates, may interrupt running tasks).
	//  "GRACEFUL": waits for running tasks to complete before replacing workers (slower, no data loss).
	WorkerReplacementStrategy string `json:"worker_replacement_strategy,omitempty" jsonschema:"worker_replacement_strategy controls how workers are replaced during environment updates. 'FORCED': replaces workers immediately (faster updates; may interrupt running tasks). 'GRACEFUL': waits for ru..."`
}

func (s *AwsMwaaEnvironmentSpecInput) validate() error {
	if s.SourceBucketArn == "" {
		return fmt.Errorf("source_bucket_arn is required")
	}
	if s.DagS3Path == "" {
		return fmt.Errorf("dag_s3_path is required")
	}
	if s.ExecutionRoleArn == "" {
		return fmt.Errorf("execution_role_arn is required")
	}
	if len(s.SubnetIds) < 2 {
		return fmt.Errorf("subnet_ids requires at least 2 items, got %d", len(s.SubnetIds))
	}
	if s.LoggingConfiguration != nil {
		if err := s.LoggingConfiguration.validate(); err != nil {
			return fmt.Errorf("logging_configuration: %w", err)
		}
	}
	return nil
}

func (s *AwsMwaaEnvironmentSpecInput) applyDefaults() {
	if s.WebserverAccessMode == "" {
		s.WebserverAccessMode = "PRIVATE_ONLY"
	}
	if s.LoggingConfiguration != nil {
		s.LoggingConfiguration.applyDefaults()
	}
}

func (s *AwsMwaaEnvironmentSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Region != "" {
		m["region"] = s.Region
	}
	if s.AirflowVersion != "" {
		m["airflow_version"] = s.AirflowVersion
	}
	if len(s.AirflowConfigurationOptions) > 0 {
		m["airflow_configuration_options"] = s.AirflowConfigurationOptions
	}
	m["source_bucket_arn"] = s.SourceBucketArn
	m["dag_s3_path"] = s.DagS3Path
	if s.PluginsS3Path != "" {
		m["plugins_s3_path"] = s.PluginsS3Path
	}
	if s.PluginsS3ObjectVersion != "" {
		m["plugins_s3_object_version"] = s.PluginsS3ObjectVersion
	}
	if s.RequirementsS3Path != "" {
		m["requirements_s3_path"] = s.RequirementsS3Path
	}
	if s.RequirementsS3ObjectVersion != "" {
		m["requirements_s3_object_version"] = s.RequirementsS3ObjectVersion
	}
	if s.StartupScriptS3Path != "" {
		m["startup_script_s3_path"] = s.StartupScriptS3Path
	}
	if s.StartupScriptS3ObjectVersion != "" {
		m["startup_script_s3_object_version"] = s.StartupScriptS3ObjectVersion
	}
	m["execution_role_arn"] = s.ExecutionRoleArn
	if len(s.SubnetIds) > 0 {
		m["subnet_ids"] = s.SubnetIds
	}
	if len(s.SecurityGroupIds) > 0 {
		m["security_group_ids"] = s.SecurityGroupIds
	}
	if len(s.AllowedCidrBlocks) > 0 {
		m["allowed_cidr_blocks"] = s.AllowedCidrBlocks
	}
	if len(s.AssociateSecurityGroupIds) > 0 {
		m["associate_security_group_ids"] = s.AssociateSecurityGroupIds
	}
	if s.VpcId != "" {
		m["vpc_id"] = s.VpcId
	}
	if s.KmsKeyArn != "" {
		m["kms_key_arn"] = s.KmsKeyArn
	}
	if s.EnvironmentClass != "" {
		m["environment_class"] = s.EnvironmentClass
	}
	if s.MinWorkers != 0 {
		m["min_workers"] = s.MinWorkers
	}
	if s.MaxWorkers != 0 {
		m["max_workers"] = s.MaxWorkers
	}
	if s.MinWebservers != 0 {
		m["min_webservers"] = s.MinWebservers
	}
	if s.MaxWebservers != 0 {
		m["max_webservers"] = s.MaxWebservers
	}
	if s.Schedulers != 0 {
		m["schedulers"] = s.Schedulers
	}
	if s.WebserverAccessMode != "" {
		m["webserver_access_mode"] = s.WebserverAccessMode
	}
	if s.EndpointManagement != "" {
		m["endpoint_management"] = s.EndpointManagement
	}
	if s.LoggingConfiguration != nil {
		m["logging_configuration"] = s.LoggingConfiguration.toMap()
	}
	if s.WeeklyMaintenanceWindowStart != "" {
		m["weekly_maintenance_window_start"] = s.WeeklyMaintenanceWindowStart
	}
	if s.WorkerReplacementStrategy != "" {
		m["worker_replacement_strategy"] = s.WorkerReplacementStrategy
	}
	return m
}

// AwsMwaaEnvironmentLoggingConfiguration configures per-module log delivery to CloudWatch Logs.
//
//	Each of the 5 Airflow components (DAG processor, scheduler, task runner, webserver, worker)
//	can be independently configured with its own enabled flag and log level.
type AwsMwaaEnvironmentLoggingConfigurationInput struct {
	// dag_processing_logs controls logging for the DAG processing component.
	//  The DAG processor parses DAG files to determine scheduling requirements.
	DagProcessingLogs *AwsMwaaEnvironmentLoggingModuleConfigInput `json:"dag_processing_logs,omitempty" jsonschema:"dag_processing_logs controls logging for the DAG processing component. The DAG processor parses DAG files to determine scheduling requirements."`
	// scheduler_logs controls logging for the Airflow scheduler.
	//  The scheduler triggers task instances based on DAG definitions and timing.
	SchedulerLogs *AwsMwaaEnvironmentLoggingModuleConfigInput `json:"scheduler_logs,omitempty" jsonschema:"scheduler_logs controls logging for the Airflow scheduler. The scheduler triggers task instances based on DAG definitions and timing."`
	// task_logs controls logging for task execution.
	//  Task logs capture stdout/stderr from individual DAG task runs.
	TaskLogs *AwsMwaaEnvironmentLoggingModuleConfigInput `json:"task_logs,omitempty" jsonschema:"task_logs controls logging for task execution. Task logs capture stdout/stderr from individual DAG task runs."`
	// webserver_logs controls logging for the Airflow webserver (UI).
	//  The webserver serves the Airflow web interface and REST API.
	WebserverLogs *AwsMwaaEnvironmentLoggingModuleConfigInput `json:"webserver_logs,omitempty" jsonschema:"webserver_logs controls logging for the Airflow webserver (UI). The webserver serves the Airflow web interface and REST API."`
	// worker_logs controls logging for Celery workers.
	//  Workers execute the actual task code defined in DAGs.
	WorkerLogs *AwsMwaaEnvironmentLoggingModuleConfigInput `json:"worker_logs,omitempty" jsonschema:"worker_logs controls logging for Celery workers. Workers execute the actual task code defined in DAGs."`
}

func (s *AwsMwaaEnvironmentLoggingConfigurationInput) validate() error {
	if s.DagProcessingLogs != nil {
		if err := s.DagProcessingLogs.validate(); err != nil {
			return fmt.Errorf("dag_processing_logs: %w", err)
		}
	}
	if s.SchedulerLogs != nil {
		if err := s.SchedulerLogs.validate(); err != nil {
			return fmt.Errorf("scheduler_logs: %w", err)
		}
	}
	if s.TaskLogs != nil {
		if err := s.TaskLogs.validate(); err != nil {
			return fmt.Errorf("task_logs: %w", err)
		}
	}
	if s.WebserverLogs != nil {
		if err := s.WebserverLogs.validate(); err != nil {
			return fmt.Errorf("webserver_logs: %w", err)
		}
	}
	if s.WorkerLogs != nil {
		if err := s.WorkerLogs.validate(); err != nil {
			return fmt.Errorf("worker_logs: %w", err)
		}
	}
	return nil
}

func (s *AwsMwaaEnvironmentLoggingConfigurationInput) applyDefaults() {
	if s.DagProcessingLogs != nil {
		s.DagProcessingLogs.applyDefaults()
	}
	if s.SchedulerLogs != nil {
		s.SchedulerLogs.applyDefaults()
	}
	if s.TaskLogs != nil {
		s.TaskLogs.applyDefaults()
	}
	if s.WebserverLogs != nil {
		s.WebserverLogs.applyDefaults()
	}
	if s.WorkerLogs != nil {
		s.WorkerLogs.applyDefaults()
	}
}

func (s *AwsMwaaEnvironmentLoggingConfigurationInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.DagProcessingLogs != nil {
		m["dag_processing_logs"] = s.DagProcessingLogs.toMap()
	}
	if s.SchedulerLogs != nil {
		m["scheduler_logs"] = s.SchedulerLogs.toMap()
	}
	if s.TaskLogs != nil {
		m["task_logs"] = s.TaskLogs.toMap()
	}
	if s.WebserverLogs != nil {
		m["webserver_logs"] = s.WebserverLogs.toMap()
	}
	if s.WorkerLogs != nil {
		m["worker_logs"] = s.WorkerLogs.toMap()
	}
	return m
}

// AwsMwaaEnvironmentLoggingModuleConfig configures logging for a single Airflow component.
type AwsMwaaEnvironmentLoggingModuleConfigInput struct {
	// enabled controls whether logs for this module are delivered to CloudWatch Logs.
	Enabled bool `json:"enabled,omitempty" jsonschema:"enabled controls whether logs for this module are delivered to CloudWatch Logs."`
	// log_level sets the minimum severity of log messages delivered.
	//  "CRITICAL": only critical errors. "ERROR": errors and above.
	//  "WARNING": warnings and above. "INFO" (default): informational and above.
	//  "DEBUG": all messages including debug output (verbose, higher CloudWatch costs).
	LogLevel string `json:"log_level,omitempty" jsonschema:"log_level sets the minimum severity of log messages delivered. 'CRITICAL': only critical errors. 'ERROR': errors and above. 'WARNING': warnings and above. 'INFO' (default): informational and above. 'D..."`
}

func (s *AwsMwaaEnvironmentLoggingModuleConfigInput) validate() error {
	return nil
}

func (s *AwsMwaaEnvironmentLoggingModuleConfigInput) applyDefaults() {
}

func (s *AwsMwaaEnvironmentLoggingModuleConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Enabled {
		m["enabled"] = s.Enabled
	}
	if s.LogLevel != "" {
		m["log_level"] = s.LogLevel
	}
	return m
}

// ParseAwsMwaaEnvironment validates and normalizes a AwsMwaaEnvironment cloud_object.
func ParseAwsMwaaEnvironment(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "aws.openmcf.org/v1", "AwsMwaaEnvironment"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AwsMwaaEnvironmentSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
