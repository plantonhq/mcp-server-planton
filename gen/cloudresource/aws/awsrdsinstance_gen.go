// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package aws

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// AwsRdsInstance represents a single AWS RDS DB instance.
type AwsRdsInstanceSpecInput struct {
	// The AWS region where the resource will be created.
	//  Example: "us-west-2", "eu-west-1"
	Region string `json:"region,omitempty" jsonschema:"The AWS region where the resource will be created. Example: 'us-west-2'; 'eu-west-1'"`
	// Subnets for the DB subnet group. Provide at least two private subnets for high availability.
	//  Alternatively, provide an existing DB subnet group name via db_subnet_group_name.
	SubnetIds []string `json:"subnet_ids,omitempty" jsonschema:"Subnets for the DB subnet group. Provide at least two private subnets for high availability. Alternatively; provide an existing DB subnet group name via db_subnet_group_name."`
	// Name of an existing DB subnet group to use instead of specifying subnet_ids.
	DbSubnetGroupName string `json:"db_subnet_group_name,omitempty" jsonschema:"Name of an existing DB subnet group to use instead of specifying subnet_ids."`
	// Security groups to associate with the instance's network interface.
	SecurityGroupIds []string `json:"security_group_ids,omitempty" jsonschema:"Security groups to associate with the instance's network interface."`
	// Database engine (e.g., "postgres", "mysql", "mariadb", "oracle-se2", "sqlserver-ex").
	Engine string `json:"engine,omitempty" jsonschema:"Database engine (e.g.; 'postgres'; 'mysql'; 'mariadb'; 'oracle-se2'; 'sqlserver-ex')."`
	// Desired engine version (e.g., "14.10" for Postgres, or a version string appropriate to the engine).
	EngineVersion string `json:"engine_version,omitempty" jsonschema:"Desired engine version (e.g.; '14.10' for Postgres; or a version string appropriate to the engine)."`
	// Instance class (size), e.g., "db.t3.micro", "db.m6g.large".
	InstanceClass string `json:"instance_class,omitempty" jsonschema:"Instance class (size); e.g.; 'db.t3.micro'; 'db.m6g.large'."`
	// Allocated storage size in GiB for the primary storage.
	AllocatedStorageGb int32 `json:"allocated_storage_gb,omitempty" jsonschema:"Allocated storage size in GiB for the primary storage."`
	// Enable storage encryption for the instance.
	StorageEncrypted bool `json:"storage_encrypted,omitempty" jsonschema:"Enable storage encryption for the instance."`
	// Customer-managed KMS key ARN/alias for storage encryption when enabled.
	KmsKeyId string `json:"kms_key_id,omitempty" jsonschema:"Customer-managed KMS key ARN/alias for storage encryption when enabled."`
	// Master user credentials. When using platform-managed secrets, a later rule will define validations.
	Username string `json:"username,omitempty" jsonschema:"Master user credentials. When using platform-managed secrets; a later rule will define validations."`
	Password string `json:"password,omitempty" jsonschema:""`
	// Database port.
	Port int32 `json:"port,omitempty" jsonschema:"Database port."`
	// Whether the instance has a public IP address.
	PubliclyAccessible bool `json:"publicly_accessible,omitempty" jsonschema:"Whether the instance has a public IP address."`
	// Whether to deploy the instance in Multi-AZ mode.
	MultiAz bool `json:"multi_az,omitempty" jsonschema:"Whether to deploy the instance in Multi-AZ mode."`
	// Optional parameter group name to associate with the instance.
	ParameterGroupName string `json:"parameter_group_name,omitempty" jsonschema:"Optional parameter group name to associate with the instance."`
	// Optional option group name to associate with the instance (for certain engines).
	OptionGroupName string `json:"option_group_name,omitempty" jsonschema:"Optional option group name to associate with the instance (for certain engines)."`
}

func (s *AwsRdsInstanceSpecInput) validate() error {
	return nil
}

func (s *AwsRdsInstanceSpecInput) applyDefaults() {
}

func (s *AwsRdsInstanceSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Region != "" {
		m["region"] = s.Region
	}
	if len(s.SubnetIds) > 0 {
		m["subnet_ids"] = s.SubnetIds
	}
	if s.DbSubnetGroupName != "" {
		m["db_subnet_group_name"] = s.DbSubnetGroupName
	}
	if len(s.SecurityGroupIds) > 0 {
		m["security_group_ids"] = s.SecurityGroupIds
	}
	if s.Engine != "" {
		m["engine"] = s.Engine
	}
	if s.EngineVersion != "" {
		m["engine_version"] = s.EngineVersion
	}
	if s.InstanceClass != "" {
		m["instance_class"] = s.InstanceClass
	}
	if s.AllocatedStorageGb != 0 {
		m["allocated_storage_gb"] = s.AllocatedStorageGb
	}
	if s.StorageEncrypted {
		m["storage_encrypted"] = s.StorageEncrypted
	}
	if s.KmsKeyId != "" {
		m["kms_key_id"] = s.KmsKeyId
	}
	if s.Username != "" {
		m["username"] = s.Username
	}
	if s.Password != "" {
		m["password"] = s.Password
	}
	if s.Port != 0 {
		m["port"] = s.Port
	}
	if s.PubliclyAccessible {
		m["publicly_accessible"] = s.PubliclyAccessible
	}
	if s.MultiAz {
		m["multi_az"] = s.MultiAz
	}
	if s.ParameterGroupName != "" {
		m["parameter_group_name"] = s.ParameterGroupName
	}
	if s.OptionGroupName != "" {
		m["option_group_name"] = s.OptionGroupName
	}
	return m
}

// ParseAwsRdsInstance validates and normalizes a AwsRdsInstance cloud_object.
func ParseAwsRdsInstance(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "aws.openmcf.org/v1", "AwsRdsInstance"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AwsRdsInstanceSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
