// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T22:01:03+05:30

package aws

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// aws-cognito-user-pool
type AwsCognitoUserPoolSpecInput struct {
	// The AWS region where the resource will be created.
	//  Example: "us-west-2", "eu-west-1"
	Region string `json:"region,omitempty" jsonschema:"The AWS region where the resource will be created. Example: 'us-west-2'; 'eu-west-1'"`
	// Attributes that users can use as their username when signing in. When set,
	//  the chosen attribute(s) become the sign-in identifier. Common choice: ["email"]
	//  to let users sign in with their email address.
	//
	//  Valid values: "email", "phone_number".
	//  Mutually exclusive with `alias_attributes`. ForceNew.
	UsernameAttributes []string `json:"username_attributes,omitempty" jsonschema:"Attributes that users can use as their username when signing in. When set; the chosen attribute(s) become the sign-in identifier. Common choice: ['email'] to let users sign in with their email address..."`
	// Attributes that can be used as aliases for the username. Unlike `username_attributes`,
	//  users always have a separate username and the alias attributes are alternative sign-in
	//  identifiers. Common choice: ["email", "preferred_username"].
	//
	//  Valid values: "email", "phone_number", "preferred_username".
	// ...
	AliasAttributes []string `json:"alias_attributes,omitempty" jsonschema:"Attributes that can be used as aliases for the username. Unlike 'username_attributes'; users always have a separate username and the alias attributes are alternative sign-in identifiers. Common choice..."`
	// Whether usernames are case-sensitive. When false (default in AWS), "User" and "user"
	//  are treated as the same username. ForceNew — cannot be changed after pool creation.
	UsernameCaseSensitive bool `json:"username_case_sensitive,omitempty" jsonschema:"Whether usernames are case-sensitive. When false (default in AWS); 'User' and 'user' are treated as the same username. ForceNew — cannot be changed after pool creation."`
	// Password policy configuration. Controls password strength requirements for
	//  user self-registration and admin-created passwords.
	PasswordPolicy *AwsCognitoUserPoolPasswordPolicyInput `json:"password_policy,omitempty" jsonschema:"Password policy configuration. Controls password strength requirements for user self-registration and admin-created passwords."`
	// Multi-factor authentication enforcement level.
	//  - "OFF": MFA is not used (default).
	//  - "OPTIONAL": Users can opt in to MFA.
	//  - "ON": MFA is required for all users.
	MfaConfiguration string `json:"mfa_configuration,omitempty" jsonschema:"Multi-factor authentication enforcement level. - 'OFF': MFA is not used (default). - 'OPTIONAL': Users can opt in to MFA. - 'ON': MFA is required for all users."`
	// Enable TOTP-based (time-based one-time password) software token MFA. When
	//  true, users can configure authenticator apps like Google Authenticator or
	//  Authy. Requires `mfa_configuration` to be "OPTIONAL" or "ON".
	SoftwareTokenMfaEnabled bool `json:"software_token_mfa_enabled,omitempty" jsonschema:"Enable TOTP-based (time-based one-time password) software token MFA. When true; users can configure authenticator apps like Google Authenticator or Authy. Requires 'mfa_configuration' to be 'OPTIONAL'..."`
	// Attributes to auto-verify when users sign up. Cognito sends a verification
	//  code to these attributes. Common values: ["email"].
	//  Valid values: "email", "phone_number".
	AutoVerifiedAttributes []string `json:"auto_verified_attributes,omitempty" jsonschema:"Attributes to auto-verify when users sign up. Cognito sends a verification code to these attributes. Common values: ['email']. Valid values: 'email'; 'phone_number'."`
	// Account recovery mechanisms in priority order. Each mechanism defines a
	//  fallback method for users who forget their password.
	AccountRecoveryMechanisms []*AwsCognitoUserPoolRecoveryMechanismInput `json:"account_recovery_mechanisms,omitempty" jsonschema:"Account recovery mechanisms in priority order. Each mechanism defines a fallback method for users who forget their password."`
	// Email sending configuration. Controls whether Cognito sends emails using
	//  its built-in service (limited to 50/day in sandbox) or your verified SES
	//  identity (production sending).
	EmailConfiguration *AwsCognitoUserPoolEmailConfigInput `json:"email_configuration,omitempty" jsonschema:"Email sending configuration. Controls whether Cognito sends emails using its built-in service (limited to 50/day in sandbox) or your verified SES identity (production sending)."`
	// When true, only administrators can create users — self-registration is
	//  disabled. Users must be created via the admin API or AWS console.
	AllowAdminCreateUserOnly bool `json:"allow_admin_create_user_only,omitempty" jsonschema:"When true; only administrators can create users — self-registration is disabled. Users must be created via the admin API or AWS console."`
	// Enable deletion protection. When "ACTIVE", the user pool cannot be deleted
	//  without first disabling this setting. Recommended for production pools.
	DeletionProtection bool `json:"deletion_protection,omitempty" jsonschema:"Enable deletion protection. When 'ACTIVE'; the user pool cannot be deleted without first disabling this setting. Recommended for production pools."`
	// Custom user attributes beyond the standard set (email, phone, name, etc.).
	//  Each attribute is added to the pool's schema. Note: the `mutable` and
	//  `required` flags are ForceNew — they cannot be changed after creation.
	//  Maximum 50 custom attributes per pool.
	CustomAttributes []*AwsCognitoUserPoolSchemaAttributeInput `json:"custom_attributes,omitempty" jsonschema:"Custom user attributes beyond the standard set (email; phone; name; etc.). Each attribute is added to the pool's schema. Note: the 'mutable' and 'required' flags are ForceNew — they cannot be change..."`
	// Lambda trigger configuration for custom authentication and user lifecycle
	//  hooks. Each trigger is an optional Lambda function ARN that Cognito invokes
	//  at the corresponding lifecycle point.
	LambdaConfig *AwsCognitoUserPoolLambdaConfigInput `json:"lambda_config,omitempty" jsonschema:"Lambda trigger configuration for custom authentication and user lifecycle hooks. Each trigger is an optional Lambda function ARN that Cognito invokes at the corresponding lifecycle point."`
	// Application clients that authenticate against this user pool. Each client
	//  defines an OAuth/OIDC configuration for a specific application (e.g., a
	//  web frontend, a mobile app, a server-side backend).
	//
	//  At least one client is required — a pool without clients cannot authenticate
	//  any application. T...
	Clients []*AwsCognitoUserPoolClientInput `json:"clients,omitempty" jsonschema:"Application clients that authenticate against this user pool. Each client defines an OAuth/OIDC configuration for a specific application (e.g.; a web frontend; a mobile app; a server-side backend). At..."`
	// Domain configuration for the hosted sign-in UI and OAuth2 endpoints. When
	//  set, Cognito provides a hosted login page at:
	//    https://{domain}.auth.{region}.amazoncognito.com
	//  (for Cognito prefix domains) or at the custom domain you specify.
	//
	//  Required for OAuth flows that use the Authorization Code g...
	Domain *AwsCognitoUserPoolDomainConfigInput `json:"domain,omitempty" jsonschema:"Domain configuration for the hosted sign-in UI and OAuth2 endpoints. When set; Cognito provides a hosted login page at: https://{domain}.auth.{region}.amazoncognito.com (for Cognito prefix domains) or..."`
}

func (s *AwsCognitoUserPoolSpecInput) validate() error {
	if s.PasswordPolicy != nil {
		if err := s.PasswordPolicy.validate(); err != nil {
			return fmt.Errorf("password_policy: %w", err)
		}
	}
	for i, v := range s.AccountRecoveryMechanisms {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("account_recovery_mechanisms[%d]: %w", i, err)
			}
		}
	}
	if s.EmailConfiguration != nil {
		if err := s.EmailConfiguration.validate(); err != nil {
			return fmt.Errorf("email_configuration: %w", err)
		}
	}
	for i, v := range s.CustomAttributes {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("custom_attributes[%d]: %w", i, err)
			}
		}
	}
	if s.LambdaConfig != nil {
		if err := s.LambdaConfig.validate(); err != nil {
			return fmt.Errorf("lambda_config: %w", err)
		}
	}
	if len(s.Clients) < 1 {
		return fmt.Errorf("clients requires at least 1 items, got %d", len(s.Clients))
	}
	for i, v := range s.Clients {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("clients[%d]: %w", i, err)
			}
		}
	}
	if s.Domain != nil {
		if err := s.Domain.validate(); err != nil {
			return fmt.Errorf("domain: %w", err)
		}
	}
	return nil
}

func (s *AwsCognitoUserPoolSpecInput) applyDefaults() {
	if s.PasswordPolicy != nil {
		s.PasswordPolicy.applyDefaults()
	}
	if s.EmailConfiguration != nil {
		s.EmailConfiguration.applyDefaults()
	}
	if s.LambdaConfig != nil {
		s.LambdaConfig.applyDefaults()
	}
	if s.Domain != nil {
		s.Domain.applyDefaults()
	}
}

func (s *AwsCognitoUserPoolSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Region != "" {
		m["region"] = s.Region
	}
	if len(s.UsernameAttributes) > 0 {
		m["username_attributes"] = s.UsernameAttributes
	}
	if len(s.AliasAttributes) > 0 {
		m["alias_attributes"] = s.AliasAttributes
	}
	if s.UsernameCaseSensitive {
		m["username_case_sensitive"] = s.UsernameCaseSensitive
	}
	if s.PasswordPolicy != nil {
		m["password_policy"] = s.PasswordPolicy.toMap()
	}
	if s.MfaConfiguration != "" {
		m["mfa_configuration"] = s.MfaConfiguration
	}
	if s.SoftwareTokenMfaEnabled {
		m["software_token_mfa_enabled"] = s.SoftwareTokenMfaEnabled
	}
	if len(s.AutoVerifiedAttributes) > 0 {
		m["auto_verified_attributes"] = s.AutoVerifiedAttributes
	}
	if len(s.AccountRecoveryMechanisms) > 0 {
		items := make([]any, len(s.AccountRecoveryMechanisms))
		for i, v := range s.AccountRecoveryMechanisms {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["account_recovery_mechanisms"] = items
	}
	if s.EmailConfiguration != nil {
		m["email_configuration"] = s.EmailConfiguration.toMap()
	}
	if s.AllowAdminCreateUserOnly {
		m["allow_admin_create_user_only"] = s.AllowAdminCreateUserOnly
	}
	if s.DeletionProtection {
		m["deletion_protection"] = s.DeletionProtection
	}
	if len(s.CustomAttributes) > 0 {
		items := make([]any, len(s.CustomAttributes))
		for i, v := range s.CustomAttributes {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["custom_attributes"] = items
	}
	if s.LambdaConfig != nil {
		m["lambda_config"] = s.LambdaConfig.toMap()
	}
	if len(s.Clients) > 0 {
		items := make([]any, len(s.Clients))
		for i, v := range s.Clients {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["clients"] = items
	}
	if s.Domain != nil {
		m["domain"] = s.Domain.toMap()
	}
	return m
}

// AwsCognitoUserPoolClient defines an application client that authenticates
//
//	against the user pool. Each client controls how a specific application
//	(web, mobile, server) interacts with the pool via OAuth 2.0 / OIDC.
//
//	The client `name` field is used as a key in the `client_ids` and
//	`client_secrets` output maps.
type AwsCognitoUserPoolClientInput struct {
	// Unique name for this client. Used as the key in output maps and as the
	//  Cognito app client name. Must be unique across all clients in this spec.
	Name string `json:"name,omitempty" jsonschema:"Unique name for this client. Used as the key in output maps and as the Cognito app client name. Must be unique across all clients in this spec."`
	// Whether to generate a client secret. ForceNew — cannot be changed after
	//  creation. Set to true for server-side applications that can securely store
	//  the secret. Set to false for SPAs and mobile apps.
	GenerateSecret bool `json:"generate_secret,omitempty" jsonschema:"Whether to generate a client secret. ForceNew — cannot be changed after creation. Set to true for server-side applications that can securely store the secret. Set to false for SPAs and mobile apps."`
	// Enable OAuth 2.0 flows for this client. Must be true for `allowed_oauth_flows`
	//  and `allowed_oauth_scopes` to take effect.
	AllowedOauthFlowsUserPoolClient bool `json:"allowed_oauth_flows_user_pool_client,omitempty" jsonschema:"Enable OAuth 2.0 flows for this client. Must be true for 'allowed_oauth_flows' and 'allowed_oauth_scopes' to take effect."`
	// OAuth 2.0 grant types this client can use. Valid values:
	//  - "code": Authorization Code grant (recommended for most apps)
	//  - "implicit": Implicit grant (legacy, not recommended)
	//  - "client_credentials": Client Credentials grant (machine-to-machine)
	AllowedOauthFlows []string `json:"allowed_oauth_flows,omitempty" jsonschema:"OAuth 2.0 grant types this client can use. Valid values: - 'code': Authorization Code grant (recommended for most apps) - 'implicit': Implicit grant (legacy; not recommended) - 'client_credentials': C..."`
	// OAuth 2.0 scopes this client can request. Common values:
	//  "openid", "email", "profile", "phone", "aws.cognito.signin.user.admin".
	//  Custom scopes from resource servers use format: "{identifier}/{scope_name}".
	AllowedOauthScopes []string `json:"allowed_oauth_scopes,omitempty" jsonschema:"OAuth 2.0 scopes this client can request. Common values: 'openid'; 'email'; 'profile'; 'phone'; 'aws.cognito.signin.user.admin'. Custom scopes from resource servers use format: '{identifier}/{scope_na..."`
	// Callback URLs for OAuth redirects after authentication. Required for
	//  Authorization Code and Implicit grants. At least one URL must be provided
	//  when OAuth flows are enabled.
	CallbackUrls []string `json:"callback_urls,omitempty" jsonschema:"Callback URLs for OAuth redirects after authentication. Required for Authorization Code and Implicit grants. At least one URL must be provided when OAuth flows are enabled."`
	// URLs where Cognito redirects after sign-out.
	LogoutUrls []string `json:"logout_urls,omitempty" jsonschema:"URLs where Cognito redirects after sign-out."`
	// Default redirect URI. Must be one of the `callback_urls`. Used when no
	//  redirect_uri is specified in the authorization request.
	DefaultRedirectUri string `json:"default_redirect_uri,omitempty" jsonschema:"Default redirect URI. Must be one of the 'callback_urls'. Used when no redirect_uri is specified in the authorization request."`
	// Identity providers supported by this client. Defaults to ["COGNITO"] for
	//  user pool authentication. Add social/OIDC/SAML provider names to enable
	//  federated sign-in (e.g., "Google", "Facebook", "SignInWithApple").
	SupportedIdentityProviders []string `json:"supported_identity_providers,omitempty" jsonschema:"Identity providers supported by this client. Defaults to ['COGNITO'] for user pool authentication. Add social/OIDC/SAML provider names to enable federated sign-in (e.g.; 'Google'; 'Facebook'; 'SignInW..."`
	// Explicit authentication flows enabled for this client. Controls which
	//  authentication APIs the client can use. Common values:
	//  - "ALLOW_USER_SRP_AUTH": Secure Remote Password (recommended)
	//  - "ALLOW_REFRESH_TOKEN_AUTH": Enable token refresh (always recommended)
	//  - "ALLOW_USER_PASSWORD_AUTH": Direct ...
	ExplicitAuthFlows []string `json:"explicit_auth_flows,omitempty" jsonschema:"Explicit authentication flows enabled for this client. Controls which authentication APIs the client can use. Common values: - 'ALLOW_USER_SRP_AUTH': Secure Remote Password (recommended) - 'ALLOW_REFR..."`
	// Access token validity in minutes. Range: 5-1440 (5 min to 24 hours).
	//  AWS default: 60 minutes.
	AccessTokenValidityMinutes int32 `json:"access_token_validity_minutes,omitempty" jsonschema:"Access token validity in minutes. Range: 5-1440 (5 min to 24 hours). AWS default: 60 minutes."`
	// ID token validity in minutes. Range: 5-1440 (5 min to 24 hours).
	//  AWS default: 60 minutes.
	IdTokenValidityMinutes int32 `json:"id_token_validity_minutes,omitempty" jsonschema:"ID token validity in minutes. Range: 5-1440 (5 min to 24 hours). AWS default: 60 minutes."`
	// Refresh token validity in days. Range: 1-3650 (1 day to 10 years).
	//  AWS default: 30 days.
	RefreshTokenValidityDays int32 `json:"refresh_token_validity_days,omitempty" jsonschema:"Refresh token validity in days. Range: 1-3650 (1 day to 10 years). AWS default: 30 days."`
	// Enable token revocation. When true, Cognito revokes all of a user's tokens
	//  when they sign out. Recommended for security.
	EnableTokenRevocation bool `json:"enable_token_revocation,omitempty" jsonschema:"Enable token revocation. When true; Cognito revokes all of a user's tokens when they sign out. Recommended for security."`
	// How to handle requests for non-existent users. Valid values:
	//  - "ENABLED": Return the same error for non-existent and incorrect-password
	//    users to prevent user enumeration attacks.
	//  - "LEGACY": Return different errors (reveals whether user exists).
	PreventUserExistenceErrors string `json:"prevent_user_existence_errors,omitempty" jsonschema:"How to handle requests for non-existent users. Valid values: - 'ENABLED': Return the same error for non-existent and incorrect-password users to prevent user enumeration attacks. - 'LEGACY': Return di..."`
}

func (s *AwsCognitoUserPoolClientInput) validate() error {
	return nil
}

func (s *AwsCognitoUserPoolClientInput) applyDefaults() {
}

func (s *AwsCognitoUserPoolClientInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Name != "" {
		m["name"] = s.Name
	}
	if s.GenerateSecret {
		m["generate_secret"] = s.GenerateSecret
	}
	if s.AllowedOauthFlowsUserPoolClient {
		m["allowed_oauth_flows_user_pool_client"] = s.AllowedOauthFlowsUserPoolClient
	}
	if len(s.AllowedOauthFlows) > 0 {
		m["allowed_oauth_flows"] = s.AllowedOauthFlows
	}
	if len(s.AllowedOauthScopes) > 0 {
		m["allowed_oauth_scopes"] = s.AllowedOauthScopes
	}
	if len(s.CallbackUrls) > 0 {
		m["callback_urls"] = s.CallbackUrls
	}
	if len(s.LogoutUrls) > 0 {
		m["logout_urls"] = s.LogoutUrls
	}
	if s.DefaultRedirectUri != "" {
		m["default_redirect_uri"] = s.DefaultRedirectUri
	}
	if len(s.SupportedIdentityProviders) > 0 {
		m["supported_identity_providers"] = s.SupportedIdentityProviders
	}
	if len(s.ExplicitAuthFlows) > 0 {
		m["explicit_auth_flows"] = s.ExplicitAuthFlows
	}
	if s.AccessTokenValidityMinutes != 0 {
		m["access_token_validity_minutes"] = s.AccessTokenValidityMinutes
	}
	if s.IdTokenValidityMinutes != 0 {
		m["id_token_validity_minutes"] = s.IdTokenValidityMinutes
	}
	if s.RefreshTokenValidityDays != 0 {
		m["refresh_token_validity_days"] = s.RefreshTokenValidityDays
	}
	if s.EnableTokenRevocation {
		m["enable_token_revocation"] = s.EnableTokenRevocation
	}
	if s.PreventUserExistenceErrors != "" {
		m["prevent_user_existence_errors"] = s.PreventUserExistenceErrors
	}
	return m
}

// AwsCognitoUserPoolDomainConfig configures the hosted UI domain for the user pool.
//
//	This enables the Cognito-hosted sign-in/sign-up pages and OAuth2 endpoints.
type AwsCognitoUserPoolDomainConfigInput struct {
	// Domain prefix (for Cognito-hosted domains) or fully-qualified domain name
	//  (for custom domains). For Cognito-hosted: provide a unique prefix like
	//  "myapp-auth" which creates "myapp-auth.auth.{region}.amazoncognito.com".
	//  For custom domains: provide the FQDN like "auth.example.com".
	//  ForceNew — the...
	Domain string `json:"domain,omitempty" jsonschema:"Domain prefix (for Cognito-hosted domains) or fully-qualified domain name (for custom domains). For Cognito-hosted: provide a unique prefix like 'myapp-auth' which creates 'myapp-auth.auth.{region}.am..."`
	// ACM certificate ARN for custom domains. Required when `domain` contains
	//  a dot (custom domain). The certificate must be in us-east-1 regardless
	//  of the user pool's region (Cognito uses CloudFront for custom domains).
	//  Not applicable for Cognito-hosted prefix domains.
	CertificateArn string `json:"certificate_arn,omitempty" jsonschema:"ACM certificate ARN for custom domains. Required when 'domain' contains a dot (custom domain). The certificate must be in us-east-1 regardless of the user pool's region (Cognito uses CloudFront for cu..."`
}

func (s *AwsCognitoUserPoolDomainConfigInput) validate() error {
	return nil
}

func (s *AwsCognitoUserPoolDomainConfigInput) applyDefaults() {
}

func (s *AwsCognitoUserPoolDomainConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Domain != "" {
		m["domain"] = s.Domain
	}
	if s.CertificateArn != "" {
		m["certificate_arn"] = s.CertificateArn
	}
	return m
}

// AwsCognitoUserPoolEmailConfig controls how Cognito sends verification and
//
//	invitation emails.
type AwsCognitoUserPoolEmailConfigInput struct {
	// Email sending mode. Valid values:
	//  - "COGNITO_DEFAULT": Cognito sends emails using its built-in service.
	//    Limited to 50 emails/day in sandbox mode. No SES setup required.
	//  - "DEVELOPER": Cognito sends emails through your verified SES identity.
	//    Requires `source_arn`. Supports production-level se...
	EmailSendingAccount string `json:"email_sending_account,omitempty" jsonschema:"Email sending mode. Valid values: - 'COGNITO_DEFAULT': Cognito sends emails using its built-in service. Limited to 50 emails/day in sandbox mode. No SES setup required. - 'DEVELOPER': Cognito sends em..."`
	// SES verified identity ARN for sending emails. Required when
	//  `email_sending_account` is "DEVELOPER". Example:
	//  "arn:aws:ses:us-east-1:123456789012:identity/noreply@example.com"
	SourceArn string `json:"source_arn,omitempty" jsonschema:"SES verified identity ARN for sending emails. Required when 'email_sending_account' is 'DEVELOPER'. Example: 'arn:aws:ses:us-east-1:123456789012:identity/noreply@example.com'"`
	// "From" email address shown to recipients. Only applicable when using
	//  DEVELOPER mode with SES. Example: "No Reply <noreply@example.com>"
	FromEmailAddress string `json:"from_email_address,omitempty" jsonschema:"'From' email address shown to recipients. Only applicable when using DEVELOPER mode with SES. Example: 'No Reply <noreply@example.com>'"`
	// Reply-to email address. When set, user replies go to this address
	//  instead of the "from" address.
	ReplyToEmailAddress string `json:"reply_to_email_address,omitempty" jsonschema:"Reply-to email address. When set; user replies go to this address instead of the 'from' address."`
	// SES configuration set name for tracking email delivery metrics.
	ConfigurationSet string `json:"configuration_set,omitempty" jsonschema:"SES configuration set name for tracking email delivery metrics."`
}

func (s *AwsCognitoUserPoolEmailConfigInput) validate() error {
	return nil
}

func (s *AwsCognitoUserPoolEmailConfigInput) applyDefaults() {
}

func (s *AwsCognitoUserPoolEmailConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.EmailSendingAccount != "" {
		m["email_sending_account"] = s.EmailSendingAccount
	}
	if s.SourceArn != "" {
		m["source_arn"] = s.SourceArn
	}
	if s.FromEmailAddress != "" {
		m["from_email_address"] = s.FromEmailAddress
	}
	if s.ReplyToEmailAddress != "" {
		m["reply_to_email_address"] = s.ReplyToEmailAddress
	}
	if s.ConfigurationSet != "" {
		m["configuration_set"] = s.ConfigurationSet
	}
	return m
}

// AwsCognitoUserPoolLambdaConfig defines Lambda function triggers for custom
//
//	authentication and user lifecycle hooks. Each field is an optional Lambda
//	function ARN that Cognito invokes at the corresponding lifecycle point.
//
//	All fields accept a direct ARN or a reference to an AwsLambda resource.
//	Note: Lambda functions must grant Cognito permission to invoke them
//	(aws_lambda_permission with principal "cognito-idp.amazonaws.com").
type AwsCognitoUserPoolLambdaConfigInput struct {
	// Invoked before user sign-up to perform custom validation or auto-confirm.
	PreSignUp string `json:"pre_sign_up,omitempty" jsonschema:"Invoked before user sign-up to perform custom validation or auto-confirm."`
	// Invoked before authentication to perform custom validation.
	PreAuthentication string `json:"pre_authentication,omitempty" jsonschema:"Invoked before authentication to perform custom validation."`
	// Invoked after successful authentication for logging or custom logic.
	PostAuthentication string `json:"post_authentication,omitempty" jsonschema:"Invoked after successful authentication for logging or custom logic."`
	// Invoked after user confirmation to trigger welcome emails or provisioning.
	PostConfirmation string `json:"post_confirmation,omitempty" jsonschema:"Invoked after user confirmation to trigger welcome emails or provisioning."`
	// Invoked before token generation to add, remove, or modify claims.
	PreTokenGeneration string `json:"pre_token_generation,omitempty" jsonschema:"Invoked before token generation to add; remove; or modify claims."`
	// Invoked to customize verification and invitation messages.
	CustomMessage string `json:"custom_message,omitempty" jsonschema:"Invoked to customize verification and invitation messages."`
	// Invoked during user migration from an external identity provider.
	UserMigration string `json:"user_migration,omitempty" jsonschema:"Invoked during user migration from an external identity provider."`
	// Invoked to define a custom authentication challenge (custom auth flow).
	DefineAuthChallenge string `json:"define_auth_challenge,omitempty" jsonschema:"Invoked to define a custom authentication challenge (custom auth flow)."`
	// Invoked to create a custom authentication challenge (custom auth flow).
	CreateAuthChallenge string `json:"create_auth_challenge,omitempty" jsonschema:"Invoked to create a custom authentication challenge (custom auth flow)."`
	// Invoked to verify the response to a custom authentication challenge.
	VerifyAuthChallengeResponse string `json:"verify_auth_challenge_response,omitempty" jsonschema:"Invoked to verify the response to a custom authentication challenge."`
}

func (s *AwsCognitoUserPoolLambdaConfigInput) validate() error {
	return nil
}

func (s *AwsCognitoUserPoolLambdaConfigInput) applyDefaults() {
}

func (s *AwsCognitoUserPoolLambdaConfigInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.PreSignUp != "" {
		m["pre_sign_up"] = s.PreSignUp
	}
	if s.PreAuthentication != "" {
		m["pre_authentication"] = s.PreAuthentication
	}
	if s.PostAuthentication != "" {
		m["post_authentication"] = s.PostAuthentication
	}
	if s.PostConfirmation != "" {
		m["post_confirmation"] = s.PostConfirmation
	}
	if s.PreTokenGeneration != "" {
		m["pre_token_generation"] = s.PreTokenGeneration
	}
	if s.CustomMessage != "" {
		m["custom_message"] = s.CustomMessage
	}
	if s.UserMigration != "" {
		m["user_migration"] = s.UserMigration
	}
	if s.DefineAuthChallenge != "" {
		m["define_auth_challenge"] = s.DefineAuthChallenge
	}
	if s.CreateAuthChallenge != "" {
		m["create_auth_challenge"] = s.CreateAuthChallenge
	}
	if s.VerifyAuthChallengeResponse != "" {
		m["verify_auth_challenge_response"] = s.VerifyAuthChallengeResponse
	}
	return m
}

// AwsCognitoUserPoolPasswordPolicy controls password strength requirements.
type AwsCognitoUserPoolPasswordPolicyInput struct {
	// Minimum password length. Range: 6-99. AWS default: 8.
	MinimumLength int32 `json:"minimum_length,omitempty" jsonschema:"Minimum password length. Range: 6-99. AWS default: 8."`
	// Require at least one lowercase letter.
	RequireLowercase bool `json:"require_lowercase,omitempty" jsonschema:"Require at least one lowercase letter."`
	// Require at least one uppercase letter.
	RequireUppercase bool `json:"require_uppercase,omitempty" jsonschema:"Require at least one uppercase letter."`
	// Require at least one digit.
	RequireNumbers bool `json:"require_numbers,omitempty" jsonschema:"Require at least one digit."`
	// Require at least one special character.
	RequireSymbols bool `json:"require_symbols,omitempty" jsonschema:"Require at least one special character."`
	// Number of days temporary passwords (admin-created) are valid.
	//  Range: 0-365 (0 means no expiration). AWS default: 7.
	TemporaryPasswordValidityDays int32 `json:"temporary_password_validity_days,omitempty" jsonschema:"Number of days temporary passwords (admin-created) are valid. Range: 0-365 (0 means no expiration). AWS default: 7."`
}

func (s *AwsCognitoUserPoolPasswordPolicyInput) validate() error {
	return nil
}

func (s *AwsCognitoUserPoolPasswordPolicyInput) applyDefaults() {
}

func (s *AwsCognitoUserPoolPasswordPolicyInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.MinimumLength != 0 {
		m["minimum_length"] = s.MinimumLength
	}
	if s.RequireLowercase {
		m["require_lowercase"] = s.RequireLowercase
	}
	if s.RequireUppercase {
		m["require_uppercase"] = s.RequireUppercase
	}
	if s.RequireNumbers {
		m["require_numbers"] = s.RequireNumbers
	}
	if s.RequireSymbols {
		m["require_symbols"] = s.RequireSymbols
	}
	if s.TemporaryPasswordValidityDays != 0 {
		m["temporary_password_validity_days"] = s.TemporaryPasswordValidityDays
	}
	return m
}

// AwsCognitoUserPoolRecoveryMechanism defines a single account recovery option.
//
//	Up to 2 mechanisms can be configured in priority order.
type AwsCognitoUserPoolRecoveryMechanismInput struct {
	// Recovery method name. Valid values:
	//  - "verified_email": send a recovery code to the verified email
	//  - "verified_phone_number": send a recovery code via SMS
	//  - "admin_only": only administrators can reset passwords
	Name string `json:"name" jsonschema:"required,Recovery method name. Valid values: - 'verified_email': send a recovery code to the verified email - 'verified_phone_number': send a recovery code via SMS - 'admin_only': only administrators can reset..."`
	// Priority of this recovery method. 1 = primary, 2 = fallback.
	Priority int32 `json:"priority" jsonschema:"required,Priority of this recovery method. 1 = primary; 2 = fallback."`
}

func (s *AwsCognitoUserPoolRecoveryMechanismInput) validate() error {
	if s.Name == "" {
		return fmt.Errorf("name is required")
	}
	return nil
}

func (s *AwsCognitoUserPoolRecoveryMechanismInput) applyDefaults() {
}

func (s *AwsCognitoUserPoolRecoveryMechanismInput) toMap() map[string]any {
	m := make(map[string]any)
	m["name"] = s.Name
	m["priority"] = s.Priority
	return m
}

// AwsCognitoUserPoolSchemaAttribute defines a custom user attribute added to the
//
//	pool's schema. Custom attributes are prefixed with "custom:" in Cognito (e.g.,
//	a name of "tenant_id" becomes "custom:tenant_id").
type AwsCognitoUserPoolSchemaAttributeInput struct {
	// Attribute name (1-20 characters). Cognito auto-prefixes with "custom:".
	Name string `json:"name,omitempty" jsonschema:"Attribute name (1-20 characters). Cognito auto-prefixes with 'custom:'."`
	// Data type. Valid values: "String", "Number", "DateTime", "Boolean".
	AttributeDataType string `json:"attribute_data_type" jsonschema:"required,Data type. Valid values: 'String'; 'Number'; 'DateTime'; 'Boolean'."`
	// Whether the attribute value can be changed after creation. ForceNew — this
	//  flag itself cannot be changed after the attribute is added to the pool.
	Mutable bool `json:"mutable,omitempty" jsonschema:"Whether the attribute value can be changed after creation. ForceNew — this flag itself cannot be changed after the attribute is added to the pool."`
	// Whether the attribute is required during user registration. ForceNew.
	Required bool `json:"required,omitempty" jsonschema:"Whether the attribute is required during user registration. ForceNew."`
	// Minimum string length (for String attributes). Leave at 0 for no minimum.
	StringMinLength string `json:"string_min_length,omitempty" jsonschema:"Minimum string length (for String attributes). Leave at 0 for no minimum."`
	// Maximum string length (for String attributes). Leave empty for no maximum.
	StringMaxLength string `json:"string_max_length,omitempty" jsonschema:"Maximum string length (for String attributes). Leave empty for no maximum."`
	// Minimum numeric value (for Number attributes). Leave empty for no minimum.
	NumberMinValue string `json:"number_min_value,omitempty" jsonschema:"Minimum numeric value (for Number attributes). Leave empty for no minimum."`
	// Maximum numeric value (for Number attributes). Leave empty for no maximum.
	NumberMaxValue string `json:"number_max_value,omitempty" jsonschema:"Maximum numeric value (for Number attributes). Leave empty for no maximum."`
}

func (s *AwsCognitoUserPoolSchemaAttributeInput) validate() error {
	if s.AttributeDataType == "" {
		return fmt.Errorf("attribute_data_type is required")
	}
	return nil
}

func (s *AwsCognitoUserPoolSchemaAttributeInput) applyDefaults() {
}

func (s *AwsCognitoUserPoolSchemaAttributeInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Name != "" {
		m["name"] = s.Name
	}
	m["attribute_data_type"] = s.AttributeDataType
	if s.Mutable {
		m["mutable"] = s.Mutable
	}
	if s.Required {
		m["required"] = s.Required
	}
	if s.StringMinLength != "" {
		m["string_min_length"] = s.StringMinLength
	}
	if s.StringMaxLength != "" {
		m["string_max_length"] = s.StringMaxLength
	}
	if s.NumberMinValue != "" {
		m["number_min_value"] = s.NumberMinValue
	}
	if s.NumberMaxValue != "" {
		m["number_max_value"] = s.NumberMaxValue
	}
	return m
}

// ParseAwsCognitoUserPool validates and normalizes a AwsCognitoUserPool cloud_object.
func ParseAwsCognitoUserPool(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "aws.openmcf.org/v1", "AwsCognitoUserPool"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AwsCognitoUserPoolSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
