// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package aws

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// aws-serverless-elasticache
type AwsServerlessElasticacheSpecInput struct {
	// The AWS region where the resource will be created.
	//  Example: "us-west-2", "eu-west-1"
	Region string `json:"region,omitempty" jsonschema:"The AWS region where the resource will be created. Example: 'us-west-2'; 'eu-west-1'"`
	// Cache engine to use. Values: "redis", "valkey", "memcached".
	//  Switching between redis and valkey is an in-place update. Switching
	//  to/from memcached forces recreation.
	Engine string `json:"engine" jsonschema:"required,Cache engine to use. Values: 'redis'; 'valkey'; 'memcached'. Switching between redis and valkey is an in-place update. Switching to/from memcached forces recreation."`
	// Major engine version. Examples: "7", "8" for Redis/Valkey; "1.6" for
	//  Memcached. Leave empty to use the provider default for the chosen engine.
	MajorEngineVersion string `json:"major_engine_version,omitempty" jsonschema:"Major engine version. Examples: '7'; '8' for Redis/Valkey; '1.6' for Memcached. Leave empty to use the provider default for the chosen engine."`
	// Human-readable description of the serverless cache.
	Description string `json:"description,omitempty" jsonschema:"Human-readable description of the serverless cache."`
	// Maximum data storage in GB. AWS auto-scales storage up to this limit.
	//  Range: 1–5000. Leave as 0 to use the AWS default for the engine.
	DataStorageMaxGb int32 `json:"data_storage_max_gb,omitempty" jsonschema:"Maximum data storage in GB. AWS auto-scales storage up to this limit. Range: 1–5000. Leave as 0 to use the AWS default for the engine."`
	// Minimum data storage in GB. AWS guarantees at least this capacity is
	//  always provisioned. Range: 1–5000. Leave as 0 to use the AWS default.
	DataStorageMinGb int32 `json:"data_storage_min_gb,omitempty" jsonschema:"Minimum data storage in GB. AWS guarantees at least this capacity is always provisioned. Range: 1–5000. Leave as 0 to use the AWS default."`
	// Maximum ElastiCache Processing Units per second. AWS auto-scales compute
	//  up to this limit. Range: 1000–15000000. Leave as 0 for AWS default.
	EcpuMax int32 `json:"ecpu_max,omitempty" jsonschema:"Maximum ElastiCache Processing Units per second. AWS auto-scales compute up to this limit. Range: 1000–15000000. Leave as 0 for AWS default."`
	// Minimum ElastiCache Processing Units per second. AWS guarantees at least
	//  this compute capacity. Range: 1000–15000000. Leave as 0 for AWS default.
	EcpuMin int32 `json:"ecpu_min,omitempty" jsonschema:"Minimum ElastiCache Processing Units per second. AWS guarantees at least this compute capacity. Range: 1000–15000000. Leave as 0 for AWS default."`
	// Subnet IDs for the serverless cache's VPC endpoint. The cache creates
	//  VPC endpoints in these subnets. ForceNew — changing this destroys and
	//  recreates the cache.
	SubnetIds []string `json:"subnet_ids,omitempty" jsonschema:"Subnet IDs for the serverless cache's VPC endpoint. The cache creates VPC endpoints in these subnets. ForceNew — changing this destroys and recreates the cache."`
	// VPC security groups to attach to the serverless cache endpoint.
	//  Controls network-level access.
	SecurityGroupIds []string `json:"security_group_ids,omitempty" jsonschema:"VPC security groups to attach to the serverless cache endpoint. Controls network-level access."`
	// Customer-managed KMS key ARN for at-rest encryption. When set, ElastiCache
	//  Serverless uses this key instead of the AWS-managed key. ForceNew —
	//  changing this destroys and recreates the cache.
	KmsKeyId string `json:"kms_key_id,omitempty" jsonschema:"Customer-managed KMS key ARN for at-rest encryption. When set; ElastiCache Serverless uses this key instead of the AWS-managed key. ForceNew — changing this destroys and recreates the cache."`
	// Daily automatic snapshot time in UTC. Format: "HH:mm" (e.g., "05:00").
	//  Only valid for Redis/Valkey engines. Memcached has no persistence.
	DailySnapshotTime string `json:"daily_snapshot_time,omitempty" jsonschema:"Daily automatic snapshot time in UTC. Format: 'HH:mm' (e.g.; '05:00'). Only valid for Redis/Valkey engines. Memcached has no persistence."`
	// Number of days to retain automatic snapshots. Range: 0–35. 0 disables
	//  snapshots. Only valid for Redis/Valkey engines.
	SnapshotRetentionLimit int32 `json:"snapshot_retention_limit,omitempty" jsonschema:"Number of days to retain automatic snapshots. Range: 0–35. 0 disables snapshots. Only valid for Redis/Valkey engines."`
	// Redis ACL user group ID for fine-grained access control. Only valid for
	//  Redis/Valkey engines. Memcached has no authentication mechanism.
	UserGroupId string `json:"user_group_id,omitempty" jsonschema:"Redis ACL user group ID for fine-grained access control. Only valid for Redis/Valkey engines. Memcached has no authentication mechanism."`
}

func (s *AwsServerlessElasticacheSpecInput) validate() error {
	if s.Engine == "" {
		return fmt.Errorf("engine is required")
	}
	return nil
}

func (s *AwsServerlessElasticacheSpecInput) applyDefaults() {
}

func (s *AwsServerlessElasticacheSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Region != "" {
		m["region"] = s.Region
	}
	m["engine"] = s.Engine
	if s.MajorEngineVersion != "" {
		m["major_engine_version"] = s.MajorEngineVersion
	}
	if s.Description != "" {
		m["description"] = s.Description
	}
	if s.DataStorageMaxGb != 0 {
		m["data_storage_max_gb"] = s.DataStorageMaxGb
	}
	if s.DataStorageMinGb != 0 {
		m["data_storage_min_gb"] = s.DataStorageMinGb
	}
	if s.EcpuMax != 0 {
		m["ecpu_max"] = s.EcpuMax
	}
	if s.EcpuMin != 0 {
		m["ecpu_min"] = s.EcpuMin
	}
	if len(s.SubnetIds) > 0 {
		m["subnet_ids"] = s.SubnetIds
	}
	if len(s.SecurityGroupIds) > 0 {
		m["security_group_ids"] = s.SecurityGroupIds
	}
	if s.KmsKeyId != "" {
		m["kms_key_id"] = s.KmsKeyId
	}
	if s.DailySnapshotTime != "" {
		m["daily_snapshot_time"] = s.DailySnapshotTime
	}
	if s.SnapshotRetentionLimit != 0 {
		m["snapshot_retention_limit"] = s.SnapshotRetentionLimit
	}
	if s.UserGroupId != "" {
		m["user_group_id"] = s.UserGroupId
	}
	return m
}

// ParseAwsServerlessElasticache validates and normalizes a AwsServerlessElasticache cloud_object.
func ParseAwsServerlessElasticache(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "aws.openmcf.org/v1", "AwsServerlessElasticache"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec AwsServerlessElasticacheSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
