// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package oci

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// OciAutonomousDatabase is the top-level resource representing an Oracle Cloud
//
//	Infrastructure Autonomous Database -- a fully managed, self-driving database
//	service supporting OLTP, data warehouse, JSON, APEX, and lakehouse workloads.
type OciAutonomousDatabaseSpecInput struct {
	// OCID of the compartment where the autonomous database will be created.
	CompartmentId string `json:"compartment_id" jsonschema:"required,OCID of the compartment where the autonomous database will be created."`
	// The database name. Must be alphanumeric, begin with a letter, and be
	//  unique within the tenancy. Maximum 30 characters. Cannot be changed
	//  after creation.
	DbName string `json:"db_name,omitempty" jsonschema:"The database name. Must be alphanumeric; begin with a letter; and be unique within the tenancy. Maximum 30 characters. Cannot be changed after creation."`
	// Human-readable display name shown in the OCI Console.
	//  Falls back to metadata.name if not provided.
	DisplayName string `json:"display_name,omitempty" jsonschema:"Human-readable display name shown in the OCI Console. Falls back to metadata.name if not provided."`
	// The workload type of the autonomous database. Determines internal
	//  storage layout, query optimizer behavior, and available features.
	DbWorkload string `json:"db_workload,omitempty" jsonschema:"enum=oltp|dw|ajd|apex|lh,The workload type of the autonomous database. Determines internal storage layout; query optimizer behavior; and available features."`
	// Oracle Database version (e.g. "19c", "23ai", "26ai").
	//  When omitted, the latest available version is used.
	DbVersion string `json:"db_version,omitempty" jsonschema:"Oracle Database version (e.g. '19c'; '23ai'; '26ai'). When omitted; the latest available version is used."`
	// The Oracle Database edition.
	DatabaseEdition string `json:"database_edition,omitempty" jsonschema:"enum=standard_edition|enterprise_edition,The Oracle Database edition."`
	// The license model. AJD and APEX workloads always use LICENSE_INCLUDED
	//  regardless of this setting.
	LicenseModel string `json:"license_model,omitempty" jsonschema:"enum=bring_your_own_license|license_included,The license model. AJD and APEX workloads always use LICENSE_INCLUDED regardless of this setting."`
	// Character set for the database. Defaults to AL32UTF8 when omitted.
	//  Cannot be changed after creation.
	CharacterSet string `json:"character_set,omitempty" jsonschema:"Character set for the database. Defaults to AL32UTF8 when omitted. Cannot be changed after creation."`
	// National character set. Defaults to AL16UTF16 when omitted.
	//  Valid values: AL16UTF16, UTF8. Cannot be changed after creation.
	NcharacterSet string `json:"ncharacter_set,omitempty" jsonschema:"National character set. Defaults to AL16UTF16 when omitted. Valid values: AL16UTF16; UTF8. Cannot be changed after creation."`
	// The compute model. ECPU is Oracle's current recommended model.
	//  OCPU is the legacy model still supported for backward compatibility.
	ComputeModel string `json:"compute_model,omitempty" jsonschema:"enum=ecpu|ocpu,The compute model. ECPU is Oracle's current recommended model. OCPU is the legacy model still supported for backward compatibility."`
	// Number of compute units (ECPUs or OCPUs depending on compute_model).
	//  Minimum 2 ECPUs for ECPU model. Minimum varies by workload for OCPU.
	ComputeCount float32 `json:"compute_count,omitempty" jsonschema:"Number of compute units (ECPUs or OCPUs depending on compute_model). Minimum 2 ECPUs for ECPU model. Minimum varies by workload for OCPU."`
	// Maximum storage in terabytes. Used for serverless deployments.
	//  Mutually exclusive with data_storage_size_in_gb.
	DataStorageSizeInTbs int32 `json:"data_storage_size_in_tbs,omitempty" jsonschema:"Maximum storage in terabytes. Used for serverless deployments. Mutually exclusive with data_storage_size_in_gb."`
	// Maximum storage in gigabytes. Used for dedicated Exadata deployments
	//  that need finer granularity than whole terabytes.
	//  Mutually exclusive with data_storage_size_in_tbs.
	DataStorageSizeInGb int32 `json:"data_storage_size_in_gb,omitempty" jsonschema:"Maximum storage in gigabytes. Used for dedicated Exadata deployments that need finer granularity than whole terabytes. Mutually exclusive with data_storage_size_in_tbs."`
	// When true, CPU auto-scaling is enabled, allowing the database to use
	//  up to three times the provisioned compute count during demand spikes.
	IsAutoScalingEnabled bool `json:"is_auto_scaling_enabled,omitempty" jsonschema:"When true; CPU auto-scaling is enabled; allowing the database to use up to three times the provisioned compute count during demand spikes."`
	// When true, storage auto-scaling is enabled, automatically expanding
	//  storage when usage reaches the configured threshold.
	IsAutoScalingForStorageEnabled bool `json:"is_auto_scaling_for_storage_enabled,omitempty" jsonschema:"When true; storage auto-scaling is enabled; automatically expanding storage when usage reaches the configured threshold."`
	// The administrator password for the database. Must be 12 to 30 characters,
	//  contain at least one uppercase, one lowercase, and one numeric character.
	//  Cannot contain the word "admin" or the double-quote character.
	//  Mutually exclusive with secret_id.
	AdminPassword string `json:"admin_password,omitempty" jsonschema:"The administrator password for the database. Must be 12 to 30 characters; contain at least one uppercase; one lowercase; and one numeric character. Cannot contain the word 'admin' or the double-quote ..."`
	// OCID of a Vault secret containing the administrator password.
	//  Use this instead of admin_password for production environments where
	//  passwords should not appear in manifests.
	//  Mutually exclusive with admin_password.
	SecretId string `json:"secret_id,omitempty" jsonschema:"OCID of a Vault secret containing the administrator password. Use this instead of admin_password for production environments where passwords should not appear in manifests. Mutually exclusive with adm..."`
	// Version number of the Vault secret. When omitted, the latest version
	//  is used. Only applicable when secret_id is set.
	SecretVersionNumber int32 `json:"secret_version_number,omitempty" jsonschema:"Version number of the Vault secret. When omitted; the latest version is used. Only applicable when secret_id is set."`
	// OCID of the subnet for private endpoint access. When set, the database
	//  is only accessible from the specified subnet (and peered networks),
	//  disabling public secure access endpoints.
	SubnetId string `json:"subnet_id,omitempty" jsonschema:"OCID of the subnet for private endpoint access. When set; the database is only accessible from the specified subnet (and peered networks); disabling public secure access endpoints."`
	// OCIDs of network security groups to associate with the private endpoint.
	//  Maximum 5 NSGs. Only applicable when subnet_id is set.
	NsgIds []string `json:"nsg_ids,omitempty" jsonschema:"OCIDs of network security groups to associate with the private endpoint. Maximum 5 NSGs. Only applicable when subnet_id is set."`
	// DNS label prefix for the private endpoint. Combined with the subnet's
	//  DNS domain to form the FQDN for private access.
	PrivateEndpointLabel string `json:"private_endpoint_label,omitempty" jsonschema:"DNS label prefix for the private endpoint. Combined with the subnet's DNS domain to form the FQDN for private access."`
	// Specific private IP address for the private endpoint within the subnet.
	//  When omitted, OCI auto-assigns an available IP.
	PrivateEndpointIp string `json:"private_endpoint_ip,omitempty" jsonschema:"Specific private IP address for the private endpoint within the subnet. When omitted; OCI auto-assigns an available IP."`
	// Client IP access control list. Each entry can be an IP address, a CIDR
	//  block, or a VCN OCID (allowing all IPs in that VCN). When subnet_id is
	//  set, this list further restricts access within the private network.
	WhitelistedIps []string `json:"whitelisted_ips,omitempty" jsonschema:"Client IP access control list. Each entry can be an IP address; a CIDR block; or a VCN OCID (allowing all IPs in that VCN). When subnet_id is set; this list further restricts access within the private..."`
	// When true, only mutual TLS (mTLS) connections are allowed. When false,
	//  both TLS and mTLS connections are accepted.
	IsMtlsConnectionRequired bool `json:"is_mtls_connection_required,omitempty" jsonschema:"When true; only mutual TLS (mTLS) connections are allowed. When false; both TLS and mTLS connections are accepted."`
	// When true, enables database-level access control.
	//  Applicable for Exadata Cloud@Customer deployments.
	IsAccessControlEnabled bool `json:"is_access_control_enabled,omitempty" jsonschema:"When true; enables database-level access control. Applicable for Exadata Cloud@Customer deployments."`
	// OCID of the KMS key for Transparent Data Encryption (TDE). When omitted,
	//  Oracle-managed encryption is used.
	KmsKeyId string `json:"kms_key_id,omitempty" jsonschema:"OCID of the KMS key for Transparent Data Encryption (TDE). When omitted; Oracle-managed encryption is used."`
	// OCID of the OCI Vault containing the KMS key. Required when kms_key_id
	//  is set.
	VaultId string `json:"vault_id,omitempty" jsonschema:"OCID of the OCI Vault containing the KMS key. Required when kms_key_id is set."`
	// When true, provisions the database on dedicated Exadata infrastructure
	//  (requires autonomous_container_database_id). When false or omitted,
	//  uses shared (serverless) infrastructure. Cannot be changed after creation.
	IsDedicated bool `json:"is_dedicated,omitempty" jsonschema:"When true; provisions the database on dedicated Exadata infrastructure (requires autonomous_container_database_id). When false or omitted; uses shared (serverless) infrastructure. Cannot be changed af..."`
	// When true, provisions an Always Free autonomous database with limited
	//  compute and storage. Cannot scale and is automatically reclaimed after
	//  extended inactivity.
	IsFreeTier bool `json:"is_free_tier,omitempty" jsonschema:"When true; provisions an Always Free autonomous database with limited compute and storage. Cannot scale and is automatically reclaimed after extended inactivity."`
	// When true, provisions a Developer tier database with reduced cost
	//  suitable for development and testing workloads.
	IsDevTier bool `json:"is_dev_tier,omitempty" jsonschema:"When true; provisions a Developer tier database with reduced cost suitable for development and testing workloads."`
	// OCID of the autonomous container database for dedicated infrastructure
	//  deployments. Required when is_dedicated is true.
	AutonomousContainerDatabaseId string `json:"autonomous_container_database_id,omitempty" jsonschema:"OCID of the autonomous container database for dedicated infrastructure deployments. Required when is_dedicated is true."`
	// Number of days to retain automatic backups.
	//  When omitted (zero), the service default applies.
	BackupRetentionPeriodInDays int32 `json:"backup_retention_period_in_days,omitempty" jsonschema:"Number of days to retain automatic backups. When omitted (zero); the service default applies."`
	// When true, enables local Autonomous Data Guard for high availability.
	//  A standby database is automatically provisioned in a different
	//  availability domain within the same region.
	IsLocalDataGuardEnabled bool `json:"is_local_data_guard_enabled,omitempty" jsonschema:"When true; enables local Autonomous Data Guard for high availability. A standby database is automatically provisioned in a different availability domain within the same region."`
	// Maintenance schedule type controlling when patching occurs.
	AutonomousMaintenanceScheduleType string `json:"autonomous_maintenance_schedule_type,omitempty" jsonschema:"enum=early|regular,Maintenance schedule type controlling when patching occurs."`
	// Customer contact email addresses for operational notifications
	//  such as maintenance windows and critical alerts.
	CustomerContacts []*CustomerContactInput `json:"customer_contacts,omitempty" jsonschema:"Customer contact email addresses for operational notifications such as maintenance windows and critical alerts."`
}

func (s *OciAutonomousDatabaseSpecInput) validate() error {
	if s.CompartmentId == "" {
		return fmt.Errorf("compartment_id is required")
	}
	switch s.DbWorkload {
	case "", "oltp", "dw", "ajd", "apex", "lh":
	default:
		return fmt.Errorf("invalid db_workload: %q", s.DbWorkload)
	}
	switch s.DatabaseEdition {
	case "", "standard_edition", "enterprise_edition":
	default:
		return fmt.Errorf("invalid database_edition: %q", s.DatabaseEdition)
	}
	switch s.LicenseModel {
	case "", "bring_your_own_license", "license_included":
	default:
		return fmt.Errorf("invalid license_model: %q", s.LicenseModel)
	}
	switch s.ComputeModel {
	case "", "ecpu", "ocpu":
	default:
		return fmt.Errorf("invalid compute_model: %q", s.ComputeModel)
	}
	switch s.AutonomousMaintenanceScheduleType {
	case "", "early", "regular":
	default:
		return fmt.Errorf("invalid autonomous_maintenance_schedule_type: %q", s.AutonomousMaintenanceScheduleType)
	}
	for i, v := range s.CustomerContacts {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("customer_contacts[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *OciAutonomousDatabaseSpecInput) applyDefaults() {
}

func (s *OciAutonomousDatabaseSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["compartment_id"] = s.CompartmentId
	if s.DbName != "" {
		m["db_name"] = s.DbName
	}
	if s.DisplayName != "" {
		m["display_name"] = s.DisplayName
	}
	if s.DbWorkload != "" {
		m["db_workload"] = s.DbWorkload
	}
	if s.DbVersion != "" {
		m["db_version"] = s.DbVersion
	}
	if s.DatabaseEdition != "" {
		m["database_edition"] = s.DatabaseEdition
	}
	if s.LicenseModel != "" {
		m["license_model"] = s.LicenseModel
	}
	if s.CharacterSet != "" {
		m["character_set"] = s.CharacterSet
	}
	if s.NcharacterSet != "" {
		m["ncharacter_set"] = s.NcharacterSet
	}
	if s.ComputeModel != "" {
		m["compute_model"] = s.ComputeModel
	}
	if s.ComputeCount != 0 {
		m["compute_count"] = s.ComputeCount
	}
	if s.DataStorageSizeInTbs != 0 {
		m["data_storage_size_in_tbs"] = s.DataStorageSizeInTbs
	}
	if s.DataStorageSizeInGb != 0 {
		m["data_storage_size_in_gb"] = s.DataStorageSizeInGb
	}
	if s.IsAutoScalingEnabled {
		m["is_auto_scaling_enabled"] = s.IsAutoScalingEnabled
	}
	if s.IsAutoScalingForStorageEnabled {
		m["is_auto_scaling_for_storage_enabled"] = s.IsAutoScalingForStorageEnabled
	}
	if s.AdminPassword != "" {
		m["admin_password"] = s.AdminPassword
	}
	if s.SecretId != "" {
		m["secret_id"] = s.SecretId
	}
	if s.SecretVersionNumber != 0 {
		m["secret_version_number"] = s.SecretVersionNumber
	}
	if s.SubnetId != "" {
		m["subnet_id"] = s.SubnetId
	}
	if len(s.NsgIds) > 0 {
		m["nsg_ids"] = s.NsgIds
	}
	if s.PrivateEndpointLabel != "" {
		m["private_endpoint_label"] = s.PrivateEndpointLabel
	}
	if s.PrivateEndpointIp != "" {
		m["private_endpoint_ip"] = s.PrivateEndpointIp
	}
	if len(s.WhitelistedIps) > 0 {
		m["whitelisted_ips"] = s.WhitelistedIps
	}
	if s.IsMtlsConnectionRequired {
		m["is_mtls_connection_required"] = s.IsMtlsConnectionRequired
	}
	if s.IsAccessControlEnabled {
		m["is_access_control_enabled"] = s.IsAccessControlEnabled
	}
	if s.KmsKeyId != "" {
		m["kms_key_id"] = s.KmsKeyId
	}
	if s.VaultId != "" {
		m["vault_id"] = s.VaultId
	}
	if s.IsDedicated {
		m["is_dedicated"] = s.IsDedicated
	}
	if s.IsFreeTier {
		m["is_free_tier"] = s.IsFreeTier
	}
	if s.IsDevTier {
		m["is_dev_tier"] = s.IsDevTier
	}
	if s.AutonomousContainerDatabaseId != "" {
		m["autonomous_container_database_id"] = s.AutonomousContainerDatabaseId
	}
	if s.BackupRetentionPeriodInDays != 0 {
		m["backup_retention_period_in_days"] = s.BackupRetentionPeriodInDays
	}
	if s.IsLocalDataGuardEnabled {
		m["is_local_data_guard_enabled"] = s.IsLocalDataGuardEnabled
	}
	if s.AutonomousMaintenanceScheduleType != "" {
		m["autonomous_maintenance_schedule_type"] = s.AutonomousMaintenanceScheduleType
	}
	if len(s.CustomerContacts) > 0 {
		items := make([]any, len(s.CustomerContacts))
		for i, v := range s.CustomerContacts {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["customer_contacts"] = items
	}
	return m
}

// ParseOciAutonomousDatabase validates and normalizes a OciAutonomousDatabase cloud_object.
func ParseOciAutonomousDatabase(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "oci.openmcf.org/v1", "OciAutonomousDatabase"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec OciAutonomousDatabaseSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
