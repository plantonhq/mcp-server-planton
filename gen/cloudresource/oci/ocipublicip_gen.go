// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package oci

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// OciPublicIp is the top-level resource representing an Oracle Cloud
//
//	Infrastructure public IPv4 address for internet connectivity.
type OciPublicIpSpecInput struct {
	// OCID of the compartment where this public IP will reside.
	//  For ephemeral IPs, must match the compartment of the private IP.
	CompartmentId string `json:"compartment_id" jsonschema:"required,OCID of the compartment where this public IP will reside. For ephemeral IPs; must match the compartment of the private IP."`
	// Lifetime controls when the public IP is deleted and released back to the
	//  OCI public IP pool. Cannot be changed after creation.
	//  Valid values: "RESERVED", "EPHEMERAL".
	Lifetime string `json:"lifetime,omitempty" jsonschema:"Lifetime controls when the public IP is deleted and released back to the OCI public IP pool. Cannot be changed after creation. Valid values: 'RESERVED'; 'EPHEMERAL'."`
	// User-friendly display name for the public IP.
	//  Falls back to metadata.name if not provided.
	DisplayName string `json:"display_name,omitempty" jsonschema:"User-friendly display name for the public IP. Falls back to metadata.name if not provided."`
	// OCID of the private IP to assign this public IP to.
	//
	//  Required for ephemeral IPs (must be a primary private IP on a VNIC).
	//  Optional for reserved IPs -- when omitted the IP is created unassigned
	//  and can be attached later via the OCI Console or API.
	PrivateIpId string `json:"private_ip_id,omitempty" jsonschema:"OCID of the private IP to assign this public IP to. Required for ephemeral IPs (must be a primary private IP on a VNIC). Optional for reserved IPs -- when omitted the IP is created unassigned and can ..."`
	// OCID of a public IP pool for BYOIP (Bring Your Own IP) scenarios.
	//  When set, the public IP is allocated from the specified pool instead
	//  of Oracle's pool. Cannot be changed after creation.
	PublicIpPoolId string `json:"public_ip_pool_id,omitempty" jsonschema:"OCID of a public IP pool for BYOIP (Bring Your Own IP) scenarios. When set; the public IP is allocated from the specified pool instead of Oracle's pool. Cannot be changed after creation."`
}

func (s *OciPublicIpSpecInput) validate() error {
	if s.CompartmentId == "" {
		return fmt.Errorf("compartment_id is required")
	}
	return nil
}

func (s *OciPublicIpSpecInput) applyDefaults() {
}

func (s *OciPublicIpSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["compartment_id"] = s.CompartmentId
	if s.Lifetime != "" {
		m["lifetime"] = s.Lifetime
	}
	if s.DisplayName != "" {
		m["display_name"] = s.DisplayName
	}
	if s.PrivateIpId != "" {
		m["private_ip_id"] = s.PrivateIpId
	}
	if s.PublicIpPoolId != "" {
		m["public_ip_pool_id"] = s.PublicIpPoolId
	}
	return m
}

// ParseOciPublicIp validates and normalizes a OciPublicIp cloud_object.
func ParseOciPublicIp(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "oci.openmcf.org/v1", "OciPublicIp"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec OciPublicIpSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
