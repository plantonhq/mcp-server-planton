// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-27T00:55:48+05:30

package oci

import (
	"encoding/json"
	"fmt"

	"github.com/plantonhq/mcp-server-planton/internal/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// OciDnsRecord is the top-level resource representing an OCI DNS
//
//	Record Set (RRSet) -- a set of DNS resource records sharing the
//	same domain and record type within an OCI DNS zone.
type OciDnsRecordSpecInput struct {
	// OCID or name of the target DNS zone. ForceNew.
	ZoneNameOrId string `json:"zone_name_or_id" jsonschema:"required,OCID or name of the target DNS zone. ForceNew."`
	// Fully qualified domain name for the record set (e.g.,
	//  "app.example.com"). ForceNew.
	Domain string `json:"domain,omitempty" jsonschema:"Fully qualified domain name for the record set (e.g.; 'app.example.com'). ForceNew."`
	// DNS record type (e.g., A, AAAA, CNAME, MX, TXT, SRV, CAA, NS,
	//  PTR). Plain string because DNS types are IETF-standardized,
	//  numerous, and extensible. ForceNew.
	Rtype string `json:"rtype,omitempty" jsonschema:"DNS record type (e.g.; A; AAAA; CNAME; MX; TXT; SRV; CAA; NS; PTR). Plain string because DNS types are IETF-standardized; numerous; and extensible. ForceNew."`
	// OCID of the private DNS view. Required when accessing a private
	//  zone by name. Not needed when zone_name_or_id is an OCID.
	//  ForceNew.
	ViewId string `json:"view_id,omitempty" jsonschema:"OCID of the private DNS view. Required when accessing a private zone by name. Not needed when zone_name_or_id is an OCID. ForceNew."`
	// DNS records in this record set. At least one record is required.
	Items []*RecordItemInput `json:"items,omitempty" jsonschema:"DNS records in this record set. At least one record is required."`
}

func (s *OciDnsRecordSpecInput) validate() error {
	if s.ZoneNameOrId == "" {
		return fmt.Errorf("zone_name_or_id is required")
	}
	if len(s.Items) < 1 {
		return fmt.Errorf("items requires at least 1 items, got %d", len(s.Items))
	}
	for i, v := range s.Items {
		if v != nil {
			if err := v.validate(); err != nil {
				return fmt.Errorf("items[%d]: %w", i, err)
			}
		}
	}
	return nil
}

func (s *OciDnsRecordSpecInput) applyDefaults() {
}

func (s *OciDnsRecordSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["zone_name_or_id"] = s.ZoneNameOrId
	if s.Domain != "" {
		m["domain"] = s.Domain
	}
	if s.Rtype != "" {
		m["rtype"] = s.Rtype
	}
	if s.ViewId != "" {
		m["view_id"] = s.ViewId
	}
	if len(s.Items) > 0 {
		items := make([]any, len(s.Items))
		for i, v := range s.Items {
			if v != nil {
				items[i] = v.toMap()
			}
		}
		m["items"] = items
	}
	return m
}

// A single DNS record within the record set.
type RecordItemInput struct {
	// Record data in type-specific presentation format.
	//  Examples: "192.0.2.1" (A), "2001:db8::1" (AAAA),
	//  "mail.example.com." (MX with priority as part of rdata: "10 mail.example.com."),
	//  "\"v=spf1 include:example.com ~all\"" (TXT).
	Rdata string `json:"rdata,omitempty" jsonschema:"Record data in type-specific presentation format. Examples: '192.0.2.1' (A); '2001:db8::1' (AAAA); 'mail.example.com.' (MX with priority as part of rdata: '10 mail.example.com.'); '\\'v=spf1 include:ex..."`
	// Time to live in seconds. Controls how long resolvers cache
	//  this record. Values below 30 are not recommended by OCI.
	Ttl int32 `json:"ttl,omitempty" jsonschema:"Time to live in seconds. Controls how long resolvers cache this record. Values below 30 are not recommended by OCI."`
}

func (s *RecordItemInput) validate() error {
	return nil
}

func (s *RecordItemInput) applyDefaults() {
}

func (s *RecordItemInput) toMap() map[string]any {
	m := make(map[string]any)
	if s.Rdata != "" {
		m["rdata"] = s.Rdata
	}
	if s.Ttl != 0 {
		m["ttl"] = s.Ttl
	}
	return m
}

// ParseOciDnsRecord validates and normalizes a OciDnsRecord cloud_object.
func ParseOciDnsRecord(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "oci.openmcf.org/v1", "OciDnsRecord"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec OciDnsRecordSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
