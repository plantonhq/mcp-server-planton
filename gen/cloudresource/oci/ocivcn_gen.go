// Code generated by schema2go. DO NOT EDIT.
// Generated: 2026-02-26T21:50:49+05:30

package oci

import (
	"encoding/json"
	"fmt"

	"github.com/plantoncloud/mcp-server-planton/gen/parse"
	"google.golang.org/protobuf/types/known/structpb"
)

var (
	_ = json.Marshal
	_ = fmt.Errorf
	_ = parse.ValidateHeader
	_ = (*structpb.Struct)(nil)
)

// OciVcn is the top-level resource representing an Oracle Cloud Infrastructure
//
//	Virtual Cloud Network with optional gateway sub-resources.
type OciVcnSpecInput struct {
	// OCID of the compartment where the VCN and its gateways will be created.
	CompartmentId string `json:"compartment_id" jsonschema:"required,OCID of the compartment where the VCN and its gateways will be created."`
	// IPv4 CIDR blocks for the VCN. At least one is required.
	//  OCI supports multiple non-overlapping CIDRs per VCN (e.g. ["10.0.0.0/16", "172.16.0.0/16"]).
	//  Each block must be between /16 and /30.
	CidrBlocks []string `json:"cidr_blocks,omitempty" jsonschema:"IPv4 CIDR blocks for the VCN. At least one is required. OCI supports multiple non-overlapping CIDRs per VCN (e.g. ['10.0.0.0/16'; '172.16.0.0/16']). Each block must be between /16 and /30."`
	// Human-readable name for the VCN shown in the OCI Console.
	//  Falls back to metadata.name if not provided.
	DisplayName string `json:"display_name,omitempty" jsonschema:"Human-readable name for the VCN shown in the OCI Console. Falls back to metadata.name if not provided."`
	// DNS label for the VCN. Enables DNS hostnames within the VCN.
	//  Must be alphanumeric, start with a letter, and be at most 15 characters.
	//  When set, the VCN domain becomes: <dns_label>.oraclevcn.com
	DnsLabel string `json:"dns_label,omitempty" jsonschema:"DNS label for the VCN. Enables DNS hostnames within the VCN. Must be alphanumeric; start with a letter; and be at most 15 characters. When set; the VCN domain becomes: <dns_label>.oraclevcn.com"`
	// When true, allocate an Oracle-assigned /56 IPv6 GUA prefix for the VCN.
	IsIpv6Enabled bool `json:"is_ipv6_enabled,omitempty" jsonschema:"When true; allocate an Oracle-assigned /56 IPv6 GUA prefix for the VCN."`
	// When true, create an Internet Gateway attached to this VCN.
	//  Required for resources that need direct inbound/outbound internet access.
	IsInternetGatewayEnabled bool `json:"is_internet_gateway_enabled,omitempty" jsonschema:"When true; create an Internet Gateway attached to this VCN. Required for resources that need direct inbound/outbound internet access."`
	// When true, create a NAT Gateway attached to this VCN.
	//  Allows private resources to initiate outbound internet connections
	//  without exposing them to inbound traffic.
	IsNatGatewayEnabled bool `json:"is_nat_gateway_enabled,omitempty" jsonschema:"When true; create a NAT Gateway attached to this VCN. Allows private resources to initiate outbound internet connections without exposing them to inbound traffic."`
	// When true, create a Service Gateway attached to this VCN.
	//  Provides private access to OCI services (Object Storage, etc.) without
	//  traffic leaving the Oracle network. The gateway is automatically
	//  configured for "All Services in Oracle Services Network".
	IsServiceGatewayEnabled bool `json:"is_service_gateway_enabled,omitempty" jsonschema:"When true; create a Service Gateway attached to this VCN. Provides private access to OCI services (Object Storage; etc.) without traffic leaving the Oracle network. The gateway is automatically config..."`
}

func (s *OciVcnSpecInput) validate() error {
	if s.CompartmentId == "" {
		return fmt.Errorf("compartment_id is required")
	}
	if len(s.CidrBlocks) < 1 {
		return fmt.Errorf("cidr_blocks requires at least 1 items, got %d", len(s.CidrBlocks))
	}
	return nil
}

func (s *OciVcnSpecInput) applyDefaults() {
}

func (s *OciVcnSpecInput) toMap() map[string]any {
	m := make(map[string]any)
	m["compartment_id"] = s.CompartmentId
	if len(s.CidrBlocks) > 0 {
		m["cidr_blocks"] = s.CidrBlocks
	}
	if s.DisplayName != "" {
		m["display_name"] = s.DisplayName
	}
	if s.DnsLabel != "" {
		m["dns_label"] = s.DnsLabel
	}
	if s.IsIpv6Enabled {
		m["is_ipv6_enabled"] = s.IsIpv6Enabled
	}
	if s.IsInternetGatewayEnabled {
		m["is_internet_gateway_enabled"] = s.IsInternetGatewayEnabled
	}
	if s.IsNatGatewayEnabled {
		m["is_nat_gateway_enabled"] = s.IsNatGatewayEnabled
	}
	if s.IsServiceGatewayEnabled {
		m["is_service_gateway_enabled"] = s.IsServiceGatewayEnabled
	}
	return m
}

// ParseOciVcn validates and normalizes a OciVcn cloud_object.
func ParseOciVcn(cloudObject map[string]any) (*structpb.Struct, error) {
	if err := parse.ValidateHeader(cloudObject, "oci.openmcf.org/v1", "OciVcn"); err != nil {
		return nil, err
	}

	specMap, err := parse.ExtractSpecMap(cloudObject)
	if err != nil {
		return nil, err
	}

	specBytes, err := json.Marshal(specMap)
	if err != nil {
		return nil, fmt.Errorf("marshal spec: %w", err)
	}

	var spec OciVcnSpecInput
	if err := json.Unmarshal(specBytes, &spec); err != nil {
		return nil, fmt.Errorf("invalid spec: %w", err)
	}

	if err := spec.validate(); err != nil {
		return nil, err
	}

	spec.applyDefaults()

	return parse.RebuildCloudObject(cloudObject, spec.toMap())
}
